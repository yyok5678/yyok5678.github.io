 			
window.fairygui=window.fgui={},window.FGUI={};var __awaiter=this&&this.__awaiter||function(h,r,n,o){return new(n=n||Promise)(function(t,e){function i(t){try{a(o.next(t))}catch(t){e(t)}}function s(t){try{a(o.throw(t))}catch(t){e(t)}}function a(e){e.done?t(e.value):new n(function(t){t(e.value)}).then(i,s)}a((o=o.apply(h,r||[])).next())})};function lerp(t,e,i){if(t<(e=isNaN(e)?t:e)){if(e<=(t+=i))return e}else if(e<t&&(t-=i)<=e)return e;return t}!function(t){class e{constructor(){this._asset=Laya.loader}static get inst(){return e._inst||(e._inst=new e),e._inst}getRes(t){return this._asset.getRes(t)}getItemRes(t){return this.getRes(t.file)}load(t,e,i,s,a,h){this._asset.load(t,e,i,s,a,h)}setAsset(t){this._asset=t}}t.AssetProxy=e}(fgui),function(_){_.AsyncOperation=class{constructor(){this._itemList=new Array,this._objectPool=[]}createObject(t,e){var i=_.UIPackage.getByName(t);if(!i)throw new Error("package not found: "+t);t=i.getItemByName(e);if(!t)throw new Error("resource not found: "+e);this.internalCreateObject(t)}createObjectFromURL(t){var e=_.UIPackage.getItemByURL(t);if(!e)throw new Error("resource not found: "+t);this.internalCreateObject(e)}cancel(){if(Laya.timer.clear(this,this.run),(this._itemList.length=0)<this._objectPool.length){for(var t=this._objectPool.length,e=0;e<t;e++)this._objectPool[e].dispose();this._objectPool.length=0}}internalCreateObject(t){this._itemList.length=0,this._objectPool.length=0;var e={pi:t,type:t.objectType};e.childCount=this.collectComponentChildren(t),this._itemList.push(e),this._index=0,Laya.timer.frameLoop(1,this,this.run)}collectComponentChildren(t){for(var e,i,s,a=t.rawData,h=(a.seek(0,2),a.getInt16()),r=0;r<h;r++){i=a.getInt16(),s=a.pos,a.seek(s,0);var n=a.readByte(),o=a.readS(),l=a.readS();a.pos=s,null!=o?(e={pi:l=(l=null!=l?_.UIPackage.getById(l):t.owner)?l.getItemById(o):null,type:n},l&&l.type==_.PackageItemType.Component&&(e.childCount=this.collectComponentChildren(l))):(e={type:n},n==_.ObjectType.List&&(e.listItemCount=this.collectListChildren(a))),this._itemList.push(e),a.pos=s+i}return h}collectListChildren(t){t.seek(t.pos,8);for(var e,i,s,a=0,h=t.readS(),r=t.getInt16(),n=0;n<r;n++)e=t.getInt16(),e+=t.pos,(i=null==(i=t.readS())?h:i)&&(i=_.UIPackage.getItemByURL(i))&&(s={pi:i,type:i.objectType},i.type==_.PackageItemType.Component&&(s.childCount=this.collectComponentChildren(i)),this._itemList.push(s),a++),t.pos=e;return a}run(){for(var t,e,i,s,a=Laya.Browser.now(),h=_.UIConfig.frameTimeForAsyncUIConstruction,r=this._itemList.length;this._index<r;){if((e=this._itemList[this._index]).pi)t=_.UIObjectFactory.newObject(e.pi),this._objectPool.push(t),_.UIPackage._constructing++,e.pi.type==_.PackageItemType.Component?(i=this._objectPool.length-e.childCount-1,t.constructFromResource2(this._objectPool,i),this._objectPool.splice(i,e.childCount)):t.constructFromResource(),_.UIPackage._constructing--;else if(t=_.UIObjectFactory.newObject(e.type),this._objectPool.push(t),e.type==_.ObjectType.List&&0<e.listItemCount){for(i=this._objectPool.length-e.listItemCount-1,s=0;s<e.listItemCount;s++)t.itemPool.returnObject(this._objectPool[s+i]);this._objectPool.splice(i,e.listItemCount)}if(this._index++,this._index%5==0&&Laya.Browser.now()-a>=h)return}Laya.timer.clear(this,this.run);var n=this._objectPool[0];this._itemList.length=0,this._objectPool.length=0,null!=this.callback&&this.callback.runWith(n)}}}(fgui),function(n){var s=0;class t extends Laya.EventDispatcher{constructor(){super(),this._pageIds=[],this._pageNames=[],this._selectedIndex=-1,this._previousIndex=-1}dispose(){this.offAll()}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){if(this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this.changing=!0,this._previousIndex=this._selectedIndex,this._selectedIndex=t,this.parent.applyController(this),this.event(n.Events.STATE_CHANGED,this),this.changing=!1}}setSelectedIndex(t){if(this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this.changing=!0,this._previousIndex=this._selectedIndex,this._selectedIndex=t,this.parent.applyController(this),this.changing=!1}}get previsousIndex(){return this._previousIndex}get selectedPage(){return-1==this._selectedIndex?null:this._pageNames[this._selectedIndex]}set selectedPage(t){t=this._pageNames.indexOf(t);this.selectedIndex=t=-1==t?0:t}setSelectedPage(t){t=this._pageNames.indexOf(t);this.setSelectedIndex(t=-1==t?0:t)}get previousPage(){return-1==this._previousIndex?null:this._pageNames[this._previousIndex]}get pageCount(){return this._pageIds.length}getPageName(t){return this._pageNames[t]}addPage(t){this.addPageAt(t,this._pageIds.length)}addPageAt(t,e){var i=""+s++;e==this._pageIds.length?(this._pageIds.push(i),this._pageNames.push(t)):(this._pageIds.splice(e,0,i),this._pageNames.splice(e,0,t))}removePage(t){t=this._pageNames.indexOf(t);-1!=t&&(this._pageIds.splice(t,1),this._pageNames.splice(t,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this.parent.applyController(this))}removePageAt(t){this._pageIds.splice(t,1),this._pageNames.splice(t,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this.parent.applyController(this)}clearPages(){this._pageIds.length=0,this._pageNames.length=0,-1!=this._selectedIndex?this.selectedIndex=-1:this.parent.applyController(this)}hasPage(t){return-1!=this._pageNames.indexOf(t)}getPageIndexById(t){return this._pageIds.indexOf(t)}getPageIdByName(t){t=this._pageNames.indexOf(t);return-1!=t?this._pageIds[t]:null}getPageNameById(t){t=this._pageIds.indexOf(t);return-1!=t?this._pageNames[t]:null}getPageId(t){return this._pageIds[t]}get selectedPageId(){return-1==this._selectedIndex?null:this._pageIds[this._selectedIndex]}set selectedPageId(t){t=this._pageIds.indexOf(t);this.selectedIndex=t}set oppositePageId(t){0<this._pageIds.indexOf(t)?this.selectedIndex=0:1<this._pageIds.length&&(this.selectedIndex=1)}get previousPageId(){return-1==this._previousIndex?null:this._pageIds[this._previousIndex]}runActions(){if(this._actions)for(var t=this._actions.length,e=0;e<t;e++)this._actions[e].run(this,this.previousPageId,this.selectedPageId)}setup(t){for(var e,i=t.pos,s=(t.seek(i,0),this.name=t.readS(),t.readBool()&&(this.autoRadioGroupDepth=!0),t.seek(i,1),t.getInt16()),a=0;a<s;a++)this._pageIds.push(t.readS()),this._pageNames.push(t.readS());var h=0;if(2<=t.version)switch(t.getByte()){case 1:h=t.getInt16();break;case 2:-1==(h=this._pageNames.indexOf(n.UIPackage.branch))&&(h=0);break;case 3:-1==(h=this._pageNames.indexOf(n.UIPackage.getVar(t.readS())))&&(h=0)}if(t.seek(i,2),0<(s=t.getInt16()))for(this._actions||(this._actions=[]),a=0;a<s;a++){e=t.getInt16(),e+=t.pos;var r=n.ControllerAction.createAction(t.readByte());r.setup(t),this._actions.push(r),t.pos=e}this.parent&&0<this._pageIds.length?this._selectedIndex=h:this._selectedIndex=-1}}n.Controller=t}(fgui),function(a){class t{constructor(){this._agent=new a.GLoader,this._agent.draggable=!0,this._agent.touchable=!1,this._agent.setSize(100,100),this._agent.setPivot(.5,.5,!0),this._agent.align="center",this._agent.verticalAlign="middle",this._agent.sortingOrder=1e6,this._agent.on(a.Events.DRAG_END,this,this.__dragEnd)}static get inst(){return t._inst||(t._inst=new t),t._inst}get dragAgent(){return this._agent}get dragging(){return null!=this._agent.parent}startDrag(t,e,i,s){this._agent.parent||(this._sourceData=i,this._agent.url=e,a.GRoot.inst.addChild(this._agent),i=a.GRoot.inst.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY),this._agent.setXY(i.x,i.y),this._agent.startDrag(s))}cancel(){this._agent.parent&&(this._agent.stopDrag(),a.GRoot.inst.removeChild(this._agent),this._sourceData=null)}__dragEnd(t){if(this._agent.parent){a.GRoot.inst.removeChild(this._agent);for(var e=this._sourceData,i=(this._sourceData=null,a.GObject.cast(t.target));i;){if(i.displayObject.hasListener(a.Events.DROP))return i.requestFocus(),void i.displayObject.event(a.Events.DROP,[e,a.Events.createEvent(a.Events.DROP,i.displayObject,t)]);i=i.parent}}}}a.DragDropManager=t}(fgui),function(t){class e{static createEvent(t,e,i){return this.$event.setTo(t,e,i&&i.target||e),this.$event.touchId=i&&i.touchId||0,this.$event.nativeEvent=i,this.$event._stoped=!1,this.$event}static dispatch(t,e,i){e.event(t,this.createEvent(t,e,i))}}e.STATE_CHANGED="fui_state_changed",e.XY_CHANGED="fui_xy_changed",e.SIZE_CHANGED="fui_size_changed",e.SIZE_DELAY_CHANGE="fui_size_delay_change",e.CLICK_ITEM="fui_click_item",e.SCROLL="fui_scroll",e.SCROLL_END="fui_scroll_end",e.DROP="fui_drop",e.DRAG_START="fui_drag_start",e.DRAG_MOVE="fui_drag_move",e.DRAG_END="fui_drag_end",e.PULL_DOWN_RELEASE="fui_pull_down_release",e.PULL_UP_RELEASE="fui_pull_up_release",e.GEAR_STOP="fui_gear_stop",e.$event=new Laya.Event,t.Events=e}(fgui),function(t){var e;(e=t.ButtonMode||(t.ButtonMode={}))[e.Common=0]="Common",e[e.Check=1]="Check",e[e.Radio=2]="Radio",(e=t.AutoSizeType||(t.AutoSizeType={}))[e.None=0]="None",e[e.Both=1]="Both",e[e.Height=2]="Height",(e=t.AlignType||(t.AlignType={}))[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",(e=t.VertAlignType||(t.VertAlignType={}))[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom",(e=t.LoaderFillType||(t.LoaderFillType={}))[e.None=0]="None",e[e.Scale=1]="Scale",e[e.ScaleMatchHeight=2]="ScaleMatchHeight",e[e.ScaleMatchWidth=3]="ScaleMatchWidth",e[e.ScaleFree=4]="ScaleFree",e[e.ScaleNoBorder=5]="ScaleNoBorder",(e=t.ListLayoutType||(t.ListLayoutType={}))[e.SingleColumn=0]="SingleColumn",e[e.SingleRow=1]="SingleRow",e[e.FlowHorizontal=2]="FlowHorizontal",e[e.FlowVertical=3]="FlowVertical",e[e.Pagination=4]="Pagination",(e=t.ListSelectionMode||(t.ListSelectionMode={}))[e.Single=0]="Single",e[e.Multiple=1]="Multiple",e[e.Multiple_SingleClick=2]="Multiple_SingleClick",e[e.None=3]="None",(e=t.OverflowType||(t.OverflowType={}))[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.Scroll=2]="Scroll",(e=t.PackageItemType||(t.PackageItemType={}))[e.Image=0]="Image",e[e.MovieClip=1]="MovieClip",e[e.Sound=2]="Sound",e[e.Component=3]="Component",e[e.Atlas=4]="Atlas",e[e.Font=5]="Font",e[e.Swf=6]="Swf",e[e.Misc=7]="Misc",e[e.Unknown=8]="Unknown",e[e.Spine=9]="Spine",e[e.DragonBones=10]="DragonBones",(e=t.ObjectType||(t.ObjectType={}))[e.Image=0]="Image",e[e.MovieClip=1]="MovieClip",e[e.Swf=2]="Swf",e[e.Graph=3]="Graph",e[e.Loader=4]="Loader",e[e.Group=5]="Group",e[e.Text=6]="Text",e[e.RichText=7]="RichText",e[e.InputText=8]="InputText",e[e.Component=9]="Component",e[e.List=10]="List",e[e.Label=11]="Label",e[e.Button=12]="Button",e[e.ComboBox=13]="ComboBox",e[e.ProgressBar=14]="ProgressBar",e[e.Slider=15]="Slider",e[e.ScrollBar=16]="ScrollBar",e[e.Tree=17]="Tree",e[e.Loader3D=18]="Loader3D",(e=t.ProgressTitleType||(t.ProgressTitleType={}))[e.Percent=0]="Percent",e[e.ValueAndMax=1]="ValueAndMax",e[e.Value=2]="Value",e[e.Max=3]="Max",(e=t.ScrollBarDisplayType||(t.ScrollBarDisplayType={}))[e.Default=0]="Default",e[e.Visible=1]="Visible",e[e.Auto=2]="Auto",e[e.Hidden=3]="Hidden",(e=t.ScrollType||(t.ScrollType={}))[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.Both=2]="Both",(e=t.FlipType||(t.FlipType={}))[e.None=0]="None",e[e.Horizontal=1]="Horizontal",e[e.Vertical=2]="Vertical",e[e.Both=3]="Both",(e=t.ChildrenRenderOrder||(t.ChildrenRenderOrder={}))[e.Ascent=0]="Ascent",e[e.Descent=1]="Descent",e[e.Arch=2]="Arch",(e=t.GroupLayoutType||(t.GroupLayoutType={}))[e.None=0]="None",e[e.Horizontal=1]="Horizontal",e[e.Vertical=2]="Vertical",(e=t.PopupDirection||(t.PopupDirection={}))[e.Auto=0]="Auto",e[e.Up=1]="Up",e[e.Down=2]="Down",(e=t.RelationType||(t.RelationType={}))[e.Left_Left=0]="Left_Left",e[e.Left_Center=1]="Left_Center",e[e.Left_Right=2]="Left_Right",e[e.Center_Center=3]="Center_Center",e[e.Right_Left=4]="Right_Left",e[e.Right_Center=5]="Right_Center",e[e.Right_Right=6]="Right_Right",e[e.Top_Top=7]="Top_Top",e[e.Top_Middle=8]="Top_Middle",e[e.Top_Bottom=9]="Top_Bottom",e[e.Middle_Middle=10]="Middle_Middle",e[e.Bottom_Top=11]="Bottom_Top",e[e.Bottom_Middle=12]="Bottom_Middle",e[e.Bottom_Bottom=13]="Bottom_Bottom",e[e.Width=14]="Width",e[e.Height=15]="Height",e[e.LeftExt_Left=16]="LeftExt_Left",e[e.LeftExt_Right=17]="LeftExt_Right",e[e.RightExt_Left=18]="RightExt_Left",e[e.RightExt_Right=19]="RightExt_Right",e[e.TopExt_Top=20]="TopExt_Top",e[e.TopExt_Bottom=21]="TopExt_Bottom",e[e.BottomExt_Top=22]="BottomExt_Top",e[e.BottomExt_Bottom=23]="BottomExt_Bottom",e[e.Size=24]="Size",(e=t.FillMethod||(t.FillMethod={}))[e.None=0]="None",e[e.Horizontal=1]="Horizontal",e[e.Vertical=2]="Vertical",e[e.Radial90=3]="Radial90",e[e.Radial180=4]="Radial180",e[e.Radial360=5]="Radial360",(e=t.FillOrigin||(t.FillOrigin={}))[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.TopLeft=0]="TopLeft",e[e.TopRight=1]="TopRight",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight",(e=t.FillOrigin90||(t.FillOrigin90={}))[e.TopLeft=0]="TopLeft",e[e.TopRight=1]="TopRight",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight",(e=t.ObjectPropID||(t.ObjectPropID={}))[e.Text=0]="Text",e[e.Icon=1]="Icon",e[e.Color=2]="Color",e[e.OutlineColor=3]="OutlineColor",e[e.Playing=4]="Playing",e[e.Frame=5]="Frame",e[e.DeltaTime=6]="DeltaTime",e[e.TimeScale=7]="TimeScale",e[e.FontSize=8]="FontSize",e[e.Selected=9]="Selected",e[e.ShadowColor=10]="ShadowColor"}(fgui),function(h){class a{constructor(){this._x=0,this._y=0,this._alpha=1,this._rotation=0,this._visible=!0,this._touchable=!0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._pivotX=0,this._pivotY=0,this._pivotOffsetX=0,this._pivotOffsetY=0,this._sortingOrder=0,this._internalVisible=!0,this._yOffset=0,this.minWidth=0,this.minHeight=0,this.maxWidth=0,this.maxHeight=0,this.sourceWidth=0,this.sourceHeight=0,this.initWidth=0,this.initHeight=0,this._width=0,this._height=0,this._rawWidth=0,this._rawHeight=0,this._sizePercentInGroup=0,this._id=""+t++,this._name="",this.createDisplayObject(),this._relations=new h.Relations(this),this._gears=new Array(10)}get id(){return this._id}get name(){return this._name}set name(t){this._name=t}get x(){return this._x}set x(t){this.setXY(t,this._y)}get y(){return this._y}set y(t){this.setXY(this._x,t)}setXY(t,e){var i,s;this._x==t&&this._y==e||(i=t-this._x,s=e-this._y,this._x=t,this._y=e,this.handleXYChanged(),this instanceof h.GGroup&&this.moveChildren(i,s),this.updateGear(1),!this._parent||this._parent instanceof h.GList||(this._parent.setBoundsChangedFlag(),this._group&&this._group.setBoundsChangedFlag(!0),this.displayObject.event(h.Events.XY_CHANGED)),a.draggingObject!=this)||r||this.localToGlobalRect(0,0,this.width,this.height,l)}get xMin(){return this._pivotAsAnchor?this._x-this._width*this._pivotX:this._x}set xMin(t){this._pivotAsAnchor?this.setXY(t+this._width*this._pivotX,this._y):this.setXY(t,this._y)}get yMin(){return this._pivotAsAnchor?this._y-this._height*this._pivotY:this._y}set yMin(t){this._pivotAsAnchor?this.setXY(this._x,t+this._height*this._pivotY):this.setXY(this._x,t)}get pixelSnapping(){return this._pixelSnapping}set pixelSnapping(t){this._pixelSnapping!=t&&(this._pixelSnapping=t,this.handleXYChanged())}center(t){var e=this._parent?this.parent:this.root;this.setXY((e.width-this.width)/2,(e.height-this.height)/2),t&&(this.addRelation(e,h.RelationType.Center_Center),this.addRelation(e,h.RelationType.Middle_Middle))}get width(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._width}set width(t){this.setSize(t,this._rawHeight)}get height(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._height}set height(t){this.setSize(this._rawWidth,t)}setSize(t,e,i){var s,a;this._rawWidth==t&&this._rawHeight==e||(this._rawWidth=t,this._rawHeight=e,t<this.minWidth&&(t=this.minWidth),e<this.minHeight&&(e=this.minHeight),0<this.maxWidth&&t>this.maxWidth&&(t=this.maxWidth),0<this.maxHeight&&e>this.maxHeight&&(e=this.maxHeight),s=t-this._width,a=e-this._height,this._width=t,this._height=e,this.handleSizeChanged(),0==this._pivotX&&0==this._pivotY||(this._pivotAsAnchor?this.applyPivot():(i||this.setXY(this.x-this._pivotX*s,this.y-this._pivotY*a),this.updatePivotOffset())),this instanceof h.GGroup&&this.resizeChildren(s,a),this.updateGear(2),this._parent&&(this._relations.onOwnerSizeChanged(s,a,this._pivotAsAnchor||!i),this._parent.setBoundsChangedFlag(),this._group)&&this._group.setBoundsChangedFlag(),this.displayObject.event(h.Events.SIZE_CHANGED))}ensureSizeCorrect(){}makeFullScreen(){this.setSize(h.GRoot.inst.width,h.GRoot.inst.height)}get actualWidth(){return this.width*Math.abs(this._scaleX)}get actualHeight(){return this.height*Math.abs(this._scaleY)}get scaleX(){return this._scaleX}set scaleX(t){this.setScale(t,this._scaleY)}get scaleY(){return this._scaleY}set scaleY(t){this.setScale(this._scaleX,t)}setScale(t,e){this._scaleX==t&&this._scaleY==e||(this._scaleX=t,this._scaleY=e,this.handleScaleChanged(),this.applyPivot(),this.updateGear(2))}get skewX(){return this._skewX}set skewX(t){this.setSkew(t,this._skewY)}get skewY(){return this._skewY}set skewY(t){this.setSkew(this._skewX,t)}setSkew(t,e){this._skewX==t&&this._skewY==e||(this._skewX=t,this._skewY=e,this._displayObject&&(this._displayObject.skew(-t,e),this.applyPivot()))}get pivotX(){return this._pivotX}set pivotX(t){this.setPivot(t,this._pivotY)}get pivotY(){return this._pivotY}set pivotY(t){this.setPivot(this._pivotX,t)}setPivot(t,e=0,i){this._pivotX==t&&this._pivotY==e&&this._pivotAsAnchor==i||(this._pivotX=t,this._pivotY=e,this._pivotAsAnchor=i,this.updatePivotOffset(),this.handleXYChanged())}get pivotAsAnchor(){return this._pivotAsAnchor}internalSetPivot(t,e,i){this._pivotX=t,this._pivotY=e,this._pivotAsAnchor=i,this._pivotAsAnchor&&this.handleXYChanged()}updatePivotOffset(){var t;this._displayObject&&(!this._displayObject.transform||0==this._pivotX&&0==this._pivotY?(this._pivotOffsetX=0,this._pivotOffsetY=0):(_.x=this._pivotX*this._width,_.y=this._pivotY*this._height,t=this._displayObject.transform.transformPoint(_),this._pivotOffsetX=this._pivotX*this._width-t.x,this._pivotOffsetY=this._pivotY*this._height-t.y))}applyPivot(){0==this._pivotX&&0==this._pivotY||(this.updatePivotOffset(),this.handleXYChanged())}get touchable(){return this._touchable}set touchable(t){this._touchable!=t&&(this._touchable=t,this.updateGear(3),this instanceof h.GImage||this instanceof h.GMovieClip||this instanceof h.GTextField&&!(this instanceof h.GTextInput)&&!(this instanceof h.GRichTextField)||this._displayObject&&(this._displayObject.mouseEnabled=this._touchable))}get grayed(){return this._grayed}set grayed(t){this._grayed!=t&&(this._grayed=t,this.handleGrayedChanged(),this.updateGear(3))}get enabled(){return!this._grayed&&this._touchable}set enabled(t){this.grayed=!t,this.touchable=t}get rotation(){return this._rotation}set rotation(t){this._rotation!=t&&(this._rotation=t,this._displayObject&&(this._displayObject.rotation=this.normalizeRotation,this.applyPivot()),this.updateGear(3))}get normalizeRotation(){var t=this._rotation%360;return 180<t?t-=360:t<-180&&(t=360+t),t}get alpha(){return this._alpha}set alpha(t){this._alpha!=t&&(this._alpha=t,this.handleAlphaChanged(),this.updateGear(3))}get visible(){return this._visible}set visible(t){this._visible!=t&&(this._visible=t,this.handleVisibleChanged(),this._parent&&this._parent.setBoundsChangedFlag(),this._group)&&this._group.excludeInvisibles&&this._group.setBoundsChangedFlag()}get internalVisible(){return this._internalVisible&&(!this._group||this._group.internalVisible)&&!this._displayObject._cacheStyle.maskParent}get internalVisible2(){return this._visible&&(!this._group||this._group.internalVisible2)}get internalVisible3(){return this._internalVisible&&this._visible}get sortingOrder(){return this._sortingOrder}set sortingOrder(t){var e;this._sortingOrder!=(t=t<0?0:t)&&(e=this._sortingOrder,this._sortingOrder=t,this._parent)&&this._parent.childSortingOrderChanged(this,e,this._sortingOrder)}get focused(){return this.root.focus==this}requestFocus(){this.root.focus=this}get tooltips(){return this._tooltips}set tooltips(t){this._tooltips&&(this.off(Laya.Event.ROLL_OVER,this,this.__rollOver),this.off(Laya.Event.ROLL_OUT,this,this.__rollOut)),this._tooltips=t,this._tooltips&&(this.on(Laya.Event.ROLL_OVER,this,this.__rollOver),this.on(Laya.Event.ROLL_OUT,this,this.__rollOut))}__rollOver(t){Laya.timer.once(100,this,this.__doShowTooltips)}__doShowTooltips(){this.root&&this.root.showTooltips(this._tooltips)}__rollOut(t){Laya.timer.clear(this,this.__doShowTooltips),this.root.hideTooltips()}get blendMode(){return this._displayObject.blendMode}set blendMode(t){this._displayObject.blendMode=t}get filters(){return this._displayObject.filters}set filters(t){this._displayObject.filters=t}get inContainer(){return null!=this._displayObject&&null!=this._displayObject.parent}get onStage(){return null!=this._displayObject&&null!=this._displayObject.stage}get resourceURL(){return this.packageItem?"ui://"+this.packageItem.owner.id+this.packageItem.id:null}set group(t){this._group!=t&&(this._group&&this._group.setBoundsChangedFlag(),this._group=t,this._group)&&this._group.setBoundsChangedFlag()}get group(){return this._group}getGear(t){var e=this._gears[t];return e||(this._gears[t]=e=h.GearBase.create(this,t)),e}updateGear(t){this._underConstruct||this._gearLocked||(t=this._gears[t])&&t.controller&&t.updateState()}checkGearController(t,e){return this._gears[t]&&this._gears[t].controller==e}updateGearFromRelations(t,e,i){this._gears[t]&&this._gears[t].updateFromRelations(e,i)}addDisplayLock(){var t=this._gears[0];return t&&t.controller?(t=t.addLock(),this.checkGearDisplay(),t):0}releaseDisplayLock(t){var e=this._gears[0];e&&e.controller&&(e.releaseLock(t),this.checkGearDisplay())}checkGearDisplay(){var t;this._handlingController||(t=!this._gears[0]||this._gears[0].connected,(t=this._gears[8]?this._gears[8].evaluate(t):t)!=this._internalVisible&&(this._internalVisible=t,this._parent)&&(this._parent.childStateChanged(this),this._group)&&this._group.excludeInvisibles&&this._group.setBoundsChangedFlag())}get relations(){return this._relations}addRelation(t,e,i){this._relations.add(t,e,i)}removeRelation(t,e){this._relations.remove(t,e)}get displayObject(){return this._displayObject}get parent(){return this._parent}set parent(t){this._parent=t}removeFromParent(){this._parent&&this._parent.removeChild(this)}get root(){if(this instanceof h.GRoot)return this;for(var t=this._parent;t;){if(t instanceof h.GRoot)return t;t=t.parent}return h.GRoot.inst}get asCom(){return this}get asButton(){return this}get asLabel(){return this}get asProgress(){return this}get asTextField(){return this}get asRichTextField(){return this}get asTextInput(){return this}get asLoader(){return this}get asList(){return this}get asTree(){return this}get asGraph(){return this}get asGroup(){return this}get asSlider(){return this}get asComboBox(){return this}get asImage(){return this}get asMovieClip(){return this}get text(){return null}set text(t){}get icon(){return null}set icon(t){}get treeNode(){return this._treeNode}get isDisposed(){return null==this._displayObject}dispose(){this.removeFromParent(),this._relations.dispose(),this._displayObject.destroy(),this._displayObject=null;for(var t=0;t<10;t++){var e=this._gears[t];e&&e.dispose()}}onClick(t,e,i){this.on(Laya.Event.CLICK,t,e,i)}offClick(t,e){this.off(Laya.Event.CLICK,t,e)}hasClickListener(){return this._displayObject.hasListener(Laya.Event.CLICK)}on(t,e,i,s){this._displayObject.on(t,e,i,s)}off(t,e,i){e&&i?this._displayObject.off(t,e,i):this._displayObject.offAll(t)}get draggable(){return this._draggable}set draggable(t){this._draggable!=t&&(this._draggable=t,this.initDrag())}get dragBounds(){return this._dragBounds}set dragBounds(t){this._dragBounds=t}startDrag(t){null!=this._displayObject.stage&&this.dragBegin(t)}stopDrag(){this.dragEnd()}get dragging(){return a.draggingObject==this}localToGlobal(t,e,i){return t=t||0,e=e||0,this._pivotAsAnchor&&(t+=this._pivotX*this._width,e+=this._pivotY*this._height),(i=i||new Laya.Point).x=t,i.y=e,this._displayObject.localToGlobal(i,!1)}globalToLocal(t,e,i){return t=t||0,e=e||0,(i=i||new Laya.Point).x=t,i.y=e,i=this._displayObject.globalToLocal(i,!1),this._pivotAsAnchor&&(i.x-=this._pivotX*this._width,i.y-=this._pivotY*this._height),i}localToGlobalRect(t,e,i,s,a){t=t||0,e=e||0,i=i||0,s=s||0,a=a||new Laya.Rectangle;var h=this.localToGlobal(t,e);return a.x=h.x,a.y=h.y,h=this.localToGlobal(t+i,e+s),a.width=h.x-a.x,a.height=h.y-a.y,a}globalToLocalRect(t,e,i,s,a){t=t||0,e=e||0,i=i||0,s=s||0,a=a||new Laya.Rectangle;var h=this.globalToLocal(t,e);return a.x=h.x,a.y=h.y,h=this.globalToLocal(t+i,e+s),a.width=h.x-a.x,a.height=h.y-a.y,a}handleControllerChanged(t){this._handlingController=!0;for(var e=0;e<10;e++){var i=this._gears[e];i&&i.controller==t&&i.apply()}this._handlingController=!1,this.checkGearDisplay()}createDisplayObject(){this._displayObject=new Laya.Sprite,this._displayObject.$owner=this}handleXYChanged(){var t=this._x,e=this._y+this._yOffset;this._pivotAsAnchor&&(t-=this._pivotX*this._width,e-=this._pivotY*this._height),this._pixelSnapping&&(t=Math.round(t),e=Math.round(e)),this._displayObject.pos(t+this._pivotOffsetX,e+this._pivotOffsetY)}handleSizeChanged(){this._displayObject.size(this._width,this._height)}handleScaleChanged(){this._displayObject.scale(this._scaleX,this._scaleY,!0)}handleGrayedChanged(){h.ToolSet.setColorFilter(this._displayObject,this._grayed)}handleAlphaChanged(){this._displayObject.alpha=this._alpha}handleVisibleChanged(){this._displayObject.visible=this.internalVisible2}getProp(t){switch(t){case h.ObjectPropID.Text:return this.text;case h.ObjectPropID.Icon:return this.icon;case h.ObjectPropID.Color:case h.ObjectPropID.OutlineColor:return null;case h.ObjectPropID.Playing:return!1;case h.ObjectPropID.Frame:case h.ObjectPropID.DeltaTime:return 0;case h.ObjectPropID.TimeScale:return 1;case h.ObjectPropID.FontSize:return 0;case h.ObjectPropID.Selected:return!1;default:return}}setProp(t,e){switch(t){case h.ObjectPropID.Text:this.text=e;break;case h.ObjectPropID.Icon:this.icon=e}}constructFromResource(){}setup_beforeAdd(t,e){t.seek(e,0),t.skip(5),this._id=t.readS(),this._name=t.readS(),e=t.getInt32(),i=t.getInt32(),this.setXY(e,i),t.readBool()&&(this.initWidth=t.getInt32(),this.initHeight=t.getInt32(),this.setSize(this.initWidth,this.initHeight,!0)),t.readBool()&&(this.minWidth=t.getInt32(),this.maxWidth=t.getInt32(),this.minHeight=t.getInt32(),this.maxHeight=t.getInt32()),t.readBool()&&(e=t.getFloat32(),i=t.getFloat32(),this.setScale(e,i)),t.readBool()&&(e=t.getFloat32(),i=t.getFloat32(),this.setSkew(e,i)),t.readBool()&&(e=t.getFloat32(),i=t.getFloat32(),this.setPivot(e,i,t.readBool())),1!=(e=t.getFloat32())&&(this.alpha=e),0!=(e=t.getFloat32())&&(this.rotation=e),t.readBool()||(this.visible=!1),t.readBool()||(this.touchable=!1),t.readBool()&&(this.grayed=!0);var i=t.readByte();h.BlendMode[i]&&(this.blendMode=h.BlendMode[i]);1==t.readByte()&&h.ToolSet.setColorFilter(this._displayObject,[t.getFloat32(),t.getFloat32(),t.getFloat32(),t.getFloat32()]);e=t.readS();null!=e&&(this.data=e)}setup_afterAdd(t,e){t.seek(e,1);for(var i=t.readS(),i=(null!=i&&(this.tooltips=i),t.getInt16()),s=(0<=i&&(this.group=this.parent.getChildAt(i)),t.seek(e,2),t.getInt16()),a=0;a<s;a++){var h=t.getInt16();h+=t.pos,this.getGear(t.readByte()).setup(t),t.pos=h}}initDrag(){this._draggable?this.on(Laya.Event.MOUSE_DOWN,this,this.__begin):this.off(Laya.Event.MOUSE_DOWN,this,this.__begin)}dragBegin(t){var e;a.draggingObject&&((e=a.draggingObject).stopDrag(),a.draggingObject=null,h.Events.dispatch(h.Events.DRAG_END,e._displayObject,{touchId:t})),o.x=Laya.stage.mouseX,o.y=Laya.stage.mouseY,this.localToGlobalRect(0,0,this.width,this.height,l),this._dragTesting=!0,a.draggingObject=this,Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.__moving),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.__end)}dragEnd(){a.draggingObject==this&&(this.reset(),this._dragTesting=!1,a.draggingObject=null),n=!1}reset(){Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.__moving),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.__end)}__begin(){this._dragStartPos||(this._dragStartPos=new Laya.Point),this._dragStartPos.x=Laya.stage.mouseX,this._dragStartPos.y=Laya.stage.mouseY,this._dragTesting=!0,Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.__moving),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.__end)}__moving(t){if(a.draggingObject!=this&&this._draggable&&this._dragTesting){var e=h.UIConfig.touchDragSensitivity;if(this._dragStartPos&&Math.abs(this._dragStartPos.x-Laya.stage.mouseX)<e&&Math.abs(this._dragStartPos.y-Laya.stage.mouseY)<e)return;this._dragTesting=!1,n=!0,h.Events.dispatch(h.Events.DRAG_START,this._displayObject,t),n&&this.dragBegin()}var i,s;a.draggingObject==this&&(e=Laya.stage.mouseX-o.x+l.x,i=Laya.stage.mouseY-o.y+l.y,this._dragBounds&&((e<(s=h.GRoot.inst.localToGlobalRect(this._dragBounds.x,this._dragBounds.y,this._dragBounds.width,this._dragBounds.height,d)).x||e+l.width>s.right&&(e=s.right-l.width)<s.x)&&(e=s.x),i<s.y||i+l.height>s.bottom&&(i=s.bottom-l.height)<s.y)&&(i=s.y),r=!0,s=this.parent.globalToLocal(e,i,_),this.setXY(Math.round(s.x),Math.round(s.y)),r=!1,h.Events.dispatch(h.Events.DRAG_MOVE,this._displayObject,t))}__end(t){a.draggingObject==this?(a.draggingObject=null,this.reset(),h.Events.dispatch(h.Events.DRAG_END,this._displayObject,t)):this._dragTesting&&(this._dragTesting=!1,this.reset())}static cast(t){return t.$owner}}h.GObject=a,h.BlendMode={2:Laya.BlendMode.LIGHTER,3:Laya.BlendMode.MULTIPLY,4:Laya.BlendMode.SCREEN};var r,n,t=0,o=new Laya.Point,l=new Laya.Rectangle,_=new Laya.Point,d=new Laya.Rectangle}(fgui),function(s){class t extends s.GObject{constructor(){super()}get font(){return null}set font(t){}get fontSize(){return 0}set fontSize(t){}get color(){return null}set color(t){}get align(){return null}set align(t){}get valign(){return null}set valign(t){}get leading(){return 0}set leading(t){}get letterSpacing(){return 0}set letterSpacing(t){}get bold(){return!1}set bold(t){}get italic(){return!1}set italic(t){}get underline(){return!1}set underline(t){}get singleLine(){return!1}set singleLine(t){}get stroke(){return 0}set stroke(t){}get strokeColor(){return null}set strokeColor(t){}get shadowColor(){return null}set shadowColor(t){}set ubbEnabled(t){this._ubbEnabled=t}get ubbEnabled(){return this._ubbEnabled}get autoSize(){return this._autoSize}set autoSize(t){this._autoSize!=t&&(this._autoSize=t,this._widthAutoSize=this._autoSize==s.AutoSizeType.Both,this._heightAutoSize=this._autoSize==s.AutoSizeType.Both||this._autoSize==s.AutoSizeType.Height,this.updateAutoSize())}updateAutoSize(){}get textWidth(){return 0}parseTemplate(t){for(var e,i,s,a,h=0,r="";-1!=(e=t.indexOf("{",h));)if(0<e&&92==t.charCodeAt(e-1))r=r+t.substring(h,e-1)+"{",h=e+1;else{if(r+=t.substring(h,e),-1==(e=t.indexOf("}",h=e)))break;h=(e==h+1?r+=t.substr(h,2):-1!=(i=(s=t.substring(h+1,e)).indexOf("="))?r+=null==(a=this._templateVars[s.substring(0,i)])?s.substring(i+1):a:null!=(a=this._templateVars[s])&&(r+=a),e+1)}return h<t.length&&(r+=t.substr(h)),r}get templateVars(){return this._templateVars}set templateVars(t){(this._templateVars||t)&&(this._templateVars=t,this.flushVars())}setVar(t,e){return this._templateVars||(this._templateVars={}),this._templateVars[t]=e,this}flushVars(){this.text=this._text}getProp(t){switch(t){case s.ObjectPropID.Color:return this.color;case s.ObjectPropID.OutlineColor:return this.strokeColor;case s.ObjectPropID.FontSize:return this.fontSize;case s.ObjectPropID.ShadowColor:return this.shadowColor;default:return super.getProp(t)}}setProp(t,e){switch(t){case s.ObjectPropID.Color:this.color=e;break;case s.ObjectPropID.OutlineColor:this.strokeColor=e;break;case s.ObjectPropID.FontSize:this.fontSize=e;break;case s.ObjectPropID.ShadowColor:this.shadowColor=e;break;default:super.setProp(t,e)}}setup_beforeAdd(t,e){var i;super.setup_beforeAdd(t,e),t.seek(e,5),this.font=t.readS(),this.fontSize=t.getInt16(),this.color=t.readColorS(),e=t.readByte(),this.align=0==e?"left":1==e?"center":"right",e=t.readByte(),this.valign=0==e?"top":1==e?"middle":"bottom",this.leading=t.getInt16(),this.letterSpacing=t.getInt16(),this.ubbEnabled=t.readBool(),this.autoSize=t.readByte(),this.underline=t.readBool(),this.italic=t.readBool(),this.bold=t.readBool(),this.singleLine=t.readBool(),t.readBool()&&(this.strokeColor=t.readColorS(),this.stroke=t.getFloat32()+1),t.readBool()&&(s.UIConfig.useTextShadow?(this.shadowColor=t.readColorS(),e=t.getFloat32(),i=t.getFloat32(),this.shadowOffset=new Laya.Point(e,i),e=new Laya.GlowFilter(this.shadowColor,0,e,i),this._textField&&(this._textField.filters=[e])):t.skip(12)),t.readBool()&&(this._templateVars={})}setup_afterAdd(t,e){super.setup_afterAdd(t,e),t.seek(e,6);e=t.readS();null!=e&&(this.text=e)}}s.GTextField=t}(fgui),function(j){class t extends j.GTextField{constructor(){super(),this._letterSpacing=0,this._textWidth=0,this._textHeight=0,this._text="",this._color="#000000",this._textField.align="left",this._textField.font=j.UIConfig.defaultFont,this._autoSize=j.AutoSizeType.Both,this._widthAutoSize=this._heightAutoSize=!0,this._textField._sizeDirty=!1}createDisplayObject(){this._displayObject=this._textField=new e(this),(this._displayObject.$owner=this)._displayObject.mouseEnabled=!1}get nativeText(){return this._textField}set text(t){this._text=t,null==this._text&&(this._text=""),null==this._bitmapFont?(this._widthAutoSize&&(this._textField.width=1e4),t=this._text,this._templateVars&&(t=this.parseTemplate(t)),this._ubbEnabled?this._textField.text=j.UBBParser.inst.parse(t,!0):this._textField.text=t):(this._textField.text="",this._textField.setChanged()),this.parent&&this.parent._underConstruct&&this._textField.typeset()}get text(){return this._text}get font(){return this._textField.font}set font(t){this._font=t,j.ToolSet.startsWith(this._font,"ui://")?this._bitmapFont=j.UIPackage.getItemAssetByURL(this._font):delete this._bitmapFont,this._bitmapFont?this._textField.setChanged():this._font?this._textField.font=this._font:this._textField.font=j.UIConfig.defaultFont}get fontSize(){return this._textField.fontSize}set fontSize(t){this._textField.fontSize=t}get color(){return this._color}set color(t){this._color!=t&&(this._color=t,this.updateGear(4),this.grayed?this._textField.color="#AAAAAA":this._textField.color=this._color)}get align(){return this._textField.align}set align(t){this._textField.align=t}get valign(){return this._textField.valign}set valign(t){this._textField.valign=t}get leading(){return this._textField.leading}set leading(t){this._textField.leading=t}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t}get bold(){return this._textField.bold}set bold(t){this._textField.bold=t}get italic(){return this._textField.italic}set italic(t){this._textField.italic=t}get underline(){return this._textField.underline}set underline(t){this._textField.underline=t}get singleLine(){return this._singleLine}set singleLine(t){this._singleLine=t,this._textField.wordWrap=!this._widthAutoSize&&!this._singleLine}get stroke(){return this._textField.stroke}set stroke(t){this._textField.stroke=t}get strokeColor(){return this._textField.strokeColor}set strokeColor(t){this._textField.strokeColor!=t&&(this._textField.strokeColor=t,this.updateGear(4))}get shadowColor(){return this._textField.shadowColor}set shadowColor(t){this._textField.shadowColor!=t&&(this._textField.shadowColor=t,this.updateGear(10))}updateAutoSize(){this._textField.wordWrap=!this._widthAutoSize&&!this._singleLine,this._underConstruct||(this._heightAutoSize?this._widthAutoSize||(this._textField.width=this.width):this._textField.size(this.width,this.height))}get textWidth(){return this._textField._isChanged&&this._textField.typeset(),this._textWidth}ensureSizeCorrect(){!this._underConstruct&&this._textField._isChanged&&this._textField.typeset()}typeset(){this._bitmapFont?this.renderWithBitmapFont():(this._widthAutoSize||this._heightAutoSize)&&this.updateSize()}updateSize(){this._textWidth=Math.ceil(this._textField.textWidth),this._textHeight=Math.ceil(this._textField.textHeight);var t,e=0;this._widthAutoSize?(t=this._textWidth,this._textField.width!=t&&(this._textField.width=t,"left"!=this._textField.align)&&this._textField.baseTypeset()):t=this.width,this._heightAutoSize?(e=this._textHeight,this._widthAutoSize||this._textField.height!=this._textHeight&&(this._textField.height=this._textHeight)):(e=this.height,this._textHeight>e&&(this._textHeight=e),this._textField.height!=this._textHeight&&(this._textField.height=this._textHeight)),this._updatingSize=!0,this.setSize(t,e),this._updatingSize=!1}renderWithBitmapFont(){for(var t=this._displayObject.graphics,e=(t.clear(),this._lines?A(this._lines):this._lines=new Array,this.leading-1),i=this.width-2*F,s=0,a=0,h=0,r=0,n=0,o=0,l=0,_=0,d=0,c="",u=R,g=!this._widthAutoSize&&!this._singleLine,p=this.fontSize,y=this._bitmapFont.resizable?p/this._bitmapFont.size:1,f=(this._textWidth=0,this._textHeight=0,this._text),m=(f=this._templateVars?this.parseTemplate(f):f).length,w=0;w<m;++w){var v,C,b,S=f.charAt(w),x=S.charCodeAt(0);10==x?(c+=S,(b=E()).width=s,0==h&&(0==d&&(d=p),h=a=0==a?d:a),d=b.height=a,b.textHeight=h,b.text=c,b.y=u,u+=b.height+e,b.width>this._textWidth&&(this._textWidth=b.width),this._lines.push(b),c="",_=l=o=h=a=s=0):(65<=x&&x<=90||97<=x&&x<=122?(0==o&&(l=s),o++):(0<o&&(_=s),o=0),h<(n=32==x?(r=Math.ceil(p/2),p):(v=this._bitmapFont.glyphs[S])?(r=Math.ceil(v.advance*y),Math.ceil(v.lineHeight*y)):r=0)&&(h=n),a<n&&(a=n),0!=s&&(s+=this._letterSpacing),s+=r,!g||s<=i?c+=S:((b=E()).height=a,b.textHeight=h,0==c.length?b.text=S:0<o&&0<_?(C=(c+=S).length-o,b.text=j.ToolSet.trimRight(c.substr(0,C)),b.width=_,c=c.substr(C),s-=l):(b.text=c,b.width=s-(r+this._letterSpacing),c=S,s=r,h=a=n),b.y=u,u+=b.height+e,b.width>this._textWidth&&(this._textWidth=b.width),_=l=o=0,this._lines.push(b)))}0<c.length&&((b=E()).width=s,0==a&&(a=d),0==h&&(h=a),b.height=a,b.textHeight=h,b.text=c,b.y=u,b.width>this._textWidth&&(this._textWidth=b.width),this._lines.push(b)),0<this._textWidth&&(this._textWidth+=2*F),0==this._lines.length?this._textHeight=0:(b=this._lines[this._lines.length-1],this._textHeight=b.y+b.height+R);var I=0,T=this._widthAutoSize?0==this._textWidth?0:this._textWidth:this.width,I=this._heightAutoSize?0==this._textHeight?0:this._textHeight:this.height;if(this._updatingSize=!0,this.setSize(T,I),this._updatingSize=!1,this.doAlign(),0!=T&&0!=I)for(var L,P=F,O=0,i=this.width-2*F,k=this._lines.length,B=this._bitmapFont.tint?this._color:null,M=0;M<k;M++){b=this._lines[M];for(var P=F,O="center"==this.align?(i-b.width)/2:"right"==this.align?i-b.width:0,m=b.text.length,z=0;z<m;z++)10!=(x=(S=b.text.charAt(z)).charCodeAt(0))&&(32==x?P+=this._letterSpacing+Math.ceil(p/2):(v=this._bitmapFont.glyphs[S])?(L=(b.height+b.textHeight)/2-Math.ceil(v.lineHeight*y),v.texture&&t.drawTexture(v.texture,P+O+Math.ceil(v.x*y),b.y+L+Math.ceil(v.y*y),v.width*y,v.height*y,null,1,B),P+=this._letterSpacing+Math.ceil(v.advance*y)):P+=this._letterSpacing)}}handleSizeChanged(){this._updatingSize||(this._underConstruct?this._textField.size(this._width,this._height):this._bitmapFont?this._widthAutoSize?this.doAlign():this._textField.setChanged():this._widthAutoSize||(this._heightAutoSize?this._textField.width=this._width:this._textField.size(this._width,this._height)))}handleGrayedChanged(){super.handleGrayedChanged(),this.grayed?this._textField.color="#AAAAAA":this._textField.color=this._color}doAlign(){var t;"top"==this.valign||0==this._textHeight?this._yOffset=R:((t=this.height-this._textHeight)<0&&(t=0),"middle"==this.valign?this._yOffset=Math.floor(t/2):this._yOffset=Math.floor(t)),this.handleXYChanged()}flushVars(){this.text=this._text}}j.GBasicTextField=t;class e extends Laya.Text{constructor(t){super(),this._owner=t}baseTypeset(){this._lock=!0,this.typeset(),this._lock=!1}typeset(){this._sizeDirty=!0,super.typeset(),this._lock||this._owner.typeset(),this._isChanged&&(Laya.timer.clear(this,this.typeset),this._isChanged=!1),this._sizeDirty=!1}setChanged(){this.isChanged=!0}set isChanged(t){t&&!this._sizeDirty&&this._owner.autoSize!=j.AutoSizeType.None&&this._owner.parent&&(this._sizeDirty=!0,this.event(j.Events.SIZE_DELAY_CHANGE)),super.isChanged=t}}var a=[];function E(){var t;return a.length?((t=a.pop()).width=0,t.height=0,t.textHeight=0,t.text=null,t.y=0,t):{width:0,height:0,textHeight:0,text:null,y:0}}function A(t){for(var e=t.length,i=0;i<e;i++){var s=t[i];a.push(s)}t.length=0}const F=2,R=2}(fgui),function(t){t.Margin=class{constructor(){this.left=0,this.right=0,this.top=0,this.bottom=0}copy(t){this.top=t.top,this.bottom=t.bottom,this.left=t.left,this.right=t.right}}}(fgui),function(S){function x(t,e,i,s){e.indexOf(s)<0||(null==t[s]?t[s]=i:t[s]instanceof Array?t[s].push(i):FGUI.DEBUG&&console.warn(`名为${s}的子对象含有多个，请将成员变量${s}声明为数组 ${s}: fairygui.GComponent[] = []`))}class r extends S.GObject{constructor(){super(),this._sortingChildCount=0,this._children=[],this._controllers=[],this._transitions=[],this._margin=new S.Margin,this._alignOffset=new Laya.Point,this._opaque=!1,this._childrenRenderOrder=0,this._apexIndex=0}createDisplayObject(){super.createDisplayObject(),this._displayObject.mouseEnabled=!0,this._displayObject.mouseThrough=!0,this._container=this._displayObject}dispose(){for(var t=this._transitions.length,e=0;e<t;++e)this._transitions[e].dispose();for(t=this._controllers.length,e=0;e<t;++e)this._controllers[e].dispose();for(this.scrollPane&&this.scrollPane.dispose(),e=(t=this._children.length)-1;0<=e;--e){var i=this._children[e];i.parent=null,i.dispose()}this._boundsChanged=!1,super.dispose()}get displayListContainer(){return this._container}addChild(t){return this.addChildAt(t,this._children.length),t}addChildAt(t,e){if(!t)throw"child is null";var i;if(0<=e&&e<=this._children.length)return t.parent==this?this.setChildIndex(t,e):(t.removeFromParent(),i=(t.parent=this)._children.length,0!=t.sortingOrder?(this._sortingChildCount++,e=this.getInsertPosForSortingChild(t)):0<this._sortingChildCount&&e>i-this._sortingChildCount&&(e=i-this._sortingChildCount),e==i?this._children.push(t):this._children.splice(e,0,t),this.childStateChanged(t),this.setBoundsChangedFlag()),t;throw"Invalid child index"}getInsertPosForSortingChild(t){for(var e=this._children.length,i=0,i=0;i<e;i++){var s=this._children[i];if(s!=t&&t.sortingOrder<s.sortingOrder)break}return i}removeChild(t,e){var i=this._children.indexOf(t);return-1!=i&&this.removeChildAt(i,e),t}removeChildAt(t,e){var i;if(0<=t&&t<this._children.length)return(i=this._children[t]).parent=null,0!=i.sortingOrder&&this._sortingChildCount--,this._children.splice(t,1),i.group=null,i.inContainer&&(this._container.removeChild(i.displayObject),this._childrenRenderOrder==S.ChildrenRenderOrder.Arch)&&Laya.timer.callLater(this,this.buildNativeDisplayList),e&&i.dispose(),this.setBoundsChangedFlag(),i;throw"Invalid child index"}removeChildren(t,e,i){((e=null==e?-1:e)<0||e>=this._children.length)&&(e=this._children.length-1);for(var s=t=null==t?0:t;s<=e;++s)this.removeChildAt(t,i)}getChildAt(t){if(0<=t&&t<this._children.length)return this._children[t];throw"Invalid child index"}getChild(t){for(var e=this._children.length,i=0;i<e;++i)if(this._children[i].name==t)return this._children[i];return null}getChildByPath(t){for(var e,i=t.split("."),s=i.length,a=this,h=0;h<s&&(e=a.getChild(i[h]));++h)if(h!=s-1){if(!(e instanceof r)){e=null;break}a=e}return e}getVisibleChild(t){for(var e=this._children.length,i=0;i<e;++i){var s=this._children[i];if(s.internalVisible&&s.internalVisible2&&s.name==t)return s}return null}getChildInGroup(t,e){for(var i=this._children.length,s=0;s<i;++s){var a=this._children[s];if(a.group==e&&a.name==t)return a}return null}getChildById(t){for(var e=this._children.length,i=0;i<e;++i)if(this._children[i]._id==t)return this._children[i];return null}getChildIndex(t){return this._children.indexOf(t)}setChildIndex(t,e){var i,s=this._children.indexOf(t);if(-1==s)throw"Not a child of this container";0==t.sortingOrder&&(i=this._children.length,0<this._sortingChildCount&&e>i-this._sortingChildCount-1&&(e=i-this._sortingChildCount-1),this._setChildIndex(t,s,e))}setChildIndexBefore(t,e){var i,s=this._children.indexOf(t);if(-1==s)throw"Not a child of this container";return 0!=t.sortingOrder?s:(i=this._children.length,s<(e=0<this._sortingChildCount&&e>i-this._sortingChildCount-1?i-this._sortingChildCount-1:e)?this._setChildIndex(t,s,e-1):this._setChildIndex(t,s,e))}_setChildIndex(t,e,i){var s=this._children.length;if(e==(i=s<i?s:i))return e;if(this._children.splice(e,1),this._children.splice(i,0,t),t.inContainer){var a,h=0;if(this._childrenRenderOrder==S.ChildrenRenderOrder.Ascent){for(a=0;a<i;a++)this._children[a].inContainer&&h++;h==this._container.numChildren&&h--,this._container.setChildIndex(t.displayObject,h)}else if(this._childrenRenderOrder==S.ChildrenRenderOrder.Descent){for(a=s-1;i<a;a--)this._children[a].inContainer&&h++;h==this._container.numChildren&&h--,this._container.setChildIndex(t.displayObject,h)}else Laya.timer.callLater(this,this.buildNativeDisplayList);this.setBoundsChangedFlag()}return i}swapChildren(t,e){t=this._children.indexOf(t),e=this._children.indexOf(e);if(-1==t||-1==e)throw"Not a child of this container";this.swapChildrenAt(t,e)}swapChildrenAt(t,e){var i=this._children[t],s=this._children[e];this.setChildIndex(i,e),this.setChildIndex(s,t)}get numChildren(){return this._children.length}isAncestorOf(t){if(t)for(var e=t.parent;e;){if(e==this)return!0;e=e.parent}return!1}addController(t){this._controllers.push(t),(t.parent=this).applyController(t)}getControllerAt(t){return this._controllers[t]}getController(t){for(var e=this._controllers.length,i=0;i<e;++i){var s=this._controllers[i];if(s.name==t)return s}return null}removeController(t){var e=this._controllers.indexOf(t);if(-1==e)throw new Error("controller not exists");t.parent=null,this._controllers.splice(e,1);for(var i=this._children.length,s=0;s<i;s++)this._children[s].handleControllerChanged(t)}get controllers(){return this._controllers}childStateChanged(t){if(!this._buildingDisplayList){var e=this._children.length;if(t instanceof S.GGroup)for(var i=0;i<e;i++){var s=this._children[i];s.group==t&&this.childStateChanged(s)}else if(t.displayObject)if(t.internalVisible&&t.displayObject!=this._displayObject.mask){if(!t.displayObject.parent){var a=0;if(this._childrenRenderOrder==S.ChildrenRenderOrder.Ascent){for(i=0;i<e&&(s=this._children[i])!=t;i++)s.displayObject&&s.displayObject.parent&&a++;this._container.addChildAt(t.displayObject,a)}else if(this._childrenRenderOrder==S.ChildrenRenderOrder.Descent){for(i=e-1;0<=i&&(s=this._children[i])!=t;i--)s.displayObject&&s.displayObject.parent&&a++;this._container.addChildAt(t.displayObject,a)}else this._container.addChild(t.displayObject),Laya.timer.callLater(this,this.buildNativeDisplayList)}}else t.displayObject.parent&&(this._container.removeChild(t.displayObject),this._childrenRenderOrder==S.ChildrenRenderOrder.Arch)&&Laya.timer.callLater(this,this.buildNativeDisplayList)}}buildNativeDisplayList(){if(this._displayObject){var t,e=this._children.length;if(0!=e)switch(this._childrenRenderOrder){case S.ChildrenRenderOrder.Ascent:for(s=0;s<e;s++)(t=this._children[s]).displayObject&&t.internalVisible&&this._container.addChild(t.displayObject);break;case S.ChildrenRenderOrder.Descent:for(s=e-1;0<=s;s--)(t=this._children[s]).displayObject&&t.internalVisible&&this._container.addChild(t.displayObject);break;case S.ChildrenRenderOrder.Arch:for(var i=S.ToolSet.clamp(this._apexIndex,0,e),s=0;s<i;s++)(t=this._children[s]).displayObject&&t.internalVisible&&this._container.addChild(t.displayObject);for(s=e-1;i<=s;s--)(t=this._children[s]).displayObject&&t.internalVisible&&this._container.addChild(t.displayObject)}}}applyController(t){this._applyingController=t;for(var e=this._children.length,i=0;i<e;i++)this._children[i].handleControllerChanged(t);this._applyingController=null,t.runActions()}applyAllControllers(){for(var t=this._controllers.length,e=0;e<t;++e)this.applyController(this._controllers[e])}adjustRadioGroupDepth(t,e){for(var i,s=this._children.length,a=-1,h=-1,r=0;r<s;r++)(i=this._children[r])==t?a=r:i instanceof S.GButton&&i.relatedController==e&&h<r&&(h=r);a<h&&(this._applyingController&&this._children[h].handleControllerChanged(this._applyingController),this.swapChildrenAt(a,h))}getTransitionAt(t){return this._transitions[t]}getTransition(t){for(var e=this._transitions.length,i=0;i<e;++i){var s=this._transitions[i];if(s.name==t)return s}return null}isChildInView(t){return this._displayObject.scrollRect?0<=t.x+t.width&&t.x<=this.width&&0<=t.y+t.height&&t.y<=this.height:!this._scrollPane||this._scrollPane.isChildInView(t)}getFirstChildInView(){for(var t=this._children.length,e=0;e<t;++e){var i=this._children[e];if(this.isChildInView(i))return e}return-1}get scrollPane(){return this._scrollPane}get opaque(){return this._opaque}set opaque(t){this._opaque!=t&&(this._opaque=t,this._opaque?(this._displayObject.hitArea||(this._displayObject.hitArea=new Laya.Rectangle),this._displayObject.hitArea instanceof Laya.Rectangle&&this._displayObject.hitArea.setTo(0,0,this._width,this._height),this._displayObject.mouseThrough=!1):(this._displayObject.hitArea instanceof Laya.Rectangle&&(this._displayObject.hitArea=null),this._displayObject.mouseThrough=!0))}get margin(){return this._margin}set margin(t){this._margin.copy(t),this._displayObject.scrollRect&&this._container.pos(this._margin.left+this._alignOffset.x,this._margin.top+this._alignOffset.y),this.handleSizeChanged()}get childrenRenderOrder(){return this._childrenRenderOrder}set childrenRenderOrder(t){this._childrenRenderOrder!=t&&(this._childrenRenderOrder=t,this.buildNativeDisplayList())}get apexIndex(){return this._apexIndex}set apexIndex(t){this._apexIndex!=t&&(this._apexIndex=t,this._childrenRenderOrder==S.ChildrenRenderOrder.Arch)&&this.buildNativeDisplayList()}get mask(){return this._mask}set mask(t){this.setMask(t,!1)}setMask(t,e){this._mask&&this._mask!=t&&"destination-out"==this._mask.blendMode&&(this._mask.blendMode=null),this._mask=t,this._mask?(this._mask.hitArea&&(this._displayObject.hitArea=new S.ChildHitArea(this._mask,e),this._displayObject.mouseThrough=!1,this._displayObject.hitTestPrior=!0),e?(this._displayObject.mask=null,this._displayObject.cacheAs="bitmap",this._mask.blendMode="destination-out"):this._displayObject.mask=this._mask):(this._displayObject.mask=null,this._displayObject.hitArea instanceof S.ChildHitArea&&(this._displayObject.hitArea=null))}get baseUserData(){var t=this.packageItem.rawData;return t.seek(0,4),t.readS()}updateHitArea(){var t;this._displayObject.hitArea instanceof S.PixelHitTest?(t=this._displayObject.hitArea,0!=this.sourceWidth&&(t.scaleX=this._width/this.sourceWidth),0!=this.sourceHeight&&(t.scaleY=this._height/this.sourceHeight)):this._displayObject.hitArea instanceof Laya.Rectangle&&this._displayObject.hitArea.setTo(0,0,this._width,this._height)}updateMask(){var t=this._displayObject.scrollRect;(t=t||new Laya.Rectangle).x=this._margin.left,t.y=this._margin.top,t.width=this._width-this._margin.right,t.height=this._height-this._margin.bottom,this._displayObject.scrollRect=t}setupScroll(t){this._displayObject==this._container&&(this._container=new Laya.Sprite,this._displayObject.addChild(this._container)),this._scrollPane=new S.ScrollPane(this),this._scrollPane.setup(t)}setupOverflow(t){t==S.OverflowType.Hidden?(this._displayObject==this._container&&(this._container=new Laya.Sprite,this._displayObject.addChild(this._container)),this.updateMask(),this._container.pos(this._margin.left,this._margin.top)):0==this._margin.left&&0==this._margin.top||(this._displayObject==this._container&&(this._container=new Laya.Sprite,this._displayObject.addChild(this._container)),this._container.pos(this._margin.left,this._margin.top))}handleSizeChanged(){super.handleSizeChanged(),this._scrollPane?this._scrollPane.onOwnerSizeChanged():this._displayObject.scrollRect&&this.updateMask(),this._displayObject.hitArea&&this.updateHitArea()}handleGrayedChanged(){var t=this.getController("grayed");if(t)t.selectedIndex=this.grayed?1:0;else for(var e=this.grayed,i=this._children.length,s=0;s<i;++s)this._children[s].grayed=e}handleControllerChanged(t){super.handleControllerChanged(t),this._scrollPane&&this._scrollPane.handleControllerChanged(t)}setBoundsChangedFlag(){!this._scrollPane&&!this._trackBounds||this._boundsChanged||(this._boundsChanged=!0,Laya.timer.callLater(this,this.__render))}__render(){if(this._boundsChanged){for(var t=0,e=this._children.length,t=0;t<e;t++)this._children[t].ensureSizeCorrect();this.updateBounds()}}ensureBoundsCorrect(){for(var t=0,e=this._children.length,t=0;t<e;t++)this._children[t].ensureSizeCorrect();this._boundsChanged&&this.updateBounds()}updateBounds(){var t=0,e=0,i=0,s=0,a=this._children.length;if(0<a){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=0,n=0;n<a;n++){var o,l=this._children[n];(o=l.x)<t&&(t=o),(o=l.y)<e&&(e=o),h<(o=l.x+l.actualWidth)&&(h=o),r<(o=l.y+l.actualHeight)&&(r=o)}i=h-t,s=r-e}this.setBounds(t,e,i,s)}setBounds(t,e,i,s){this._boundsChanged=!1,this._scrollPane&&this._scrollPane.setContentSize(Math.round(t+i),Math.round(e+s))}get viewWidth(){return this._scrollPane?this._scrollPane.viewWidth:this.width-this._margin.left-this._margin.right}set viewWidth(t){this._scrollPane?this._scrollPane.viewWidth=t:this.width=t+this._margin.left+this._margin.right}get viewHeight(){return this._scrollPane?this._scrollPane.viewHeight:this.height-this._margin.top-this._margin.bottom}set viewHeight(t){this._scrollPane?this._scrollPane.viewHeight=t:this.height=t+this._margin.top+this._margin.bottom}getSnappingPosition(t,e,i){return this.getSnappingPositionWithDir(t,e,0,0,i)}getSnappingPositionWithDir(t,e,i,s,a){a=a||new Laya.Point;var h=this._children.length;if(0==h)a.x=0,a.y=0;else{this.ensureBoundsCorrect();var r=null,n=null,o=0;if(0!=e){for(;o<h;o++)if(e<(r=this._children[o]).y){if(0==o){e=0;break}e=(e<(n=this._children[o-1]).y+n.actualHeight/2?n:r).y;break}o==h&&(e=r.y)}if(0!=t){for(0<o&&o--;o<h;o++)if(t<(r=this._children[o]).x){if(0==o){t=0;break}t=(t<(n=this._children[o-1]).x+n.actualWidth/2?n:r).x;break}o==h&&(t=r.x)}a.x=t,a.y=e}return a}childSortingOrderChanged(t,e,i){0==i?(this._sortingChildCount--,this.setChildIndex(t,this._children.length)):(0==e&&this._sortingChildCount++,(i=this._children.indexOf(t))<(e=this.getInsertPosForSortingChild(t))?this._setChildIndex(t,i,e-1):this._setChildIndex(t,i,e))}constructFromResource(t){null!=t&&FGUI.isNative(this)||(t={obj:this,keys:Object.keys(this)}),this.constructFromResource2(null,0,t)}constructFromResource2(t,e,i){for(var s,a,h=this.packageItem.getBranch(),r=(h.decoded||(h.decoded=!0,S.TranslationHelper.translateComponent(h)),h.rawData),n=(r.seek(0,0),this._underConstruct=!0,this.sourceWidth=r.getInt32(),this.sourceHeight=r.getInt32(),this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),r.readBool()&&(this.minWidth=r.getInt32(),this.maxWidth=r.getInt32(),this.minHeight=r.getInt32(),this.maxHeight=r.getInt32()),r.readBool()&&(n=r.getFloat32(),w=r.getFloat32(),this.internalSetPivot(n,w,r.readBool())),r.readBool()&&(this._margin.top=r.getInt32(),this._margin.bottom=r.getInt32(),this._margin.left=r.getInt32(),this._margin.right=r.getInt32()),r.readByte()),o=(n==S.OverflowType.Scroll?(w=r.pos,r.seek(0,7),this.setupScroll(r),r.pos=w):this.setupOverflow(n),r.readBool()&&r.skip(8),this._buildingDisplayList=!0,r.seek(0,1),r.getInt16()),l=0;l<o;l++){s=r.getInt16(),s+=r.pos;var _=new S.Controller;this._controllers.push(_),_.parent=this,_.setup(r),r.pos=s,null!=i&&x(i.obj,i.keys,_,_.name)}r.seek(0,2);var d=r.getInt16();for(l=0;l<d;l++){var c,u,g,p,y=r.getInt16(),f=r.pos;t?a=t[e+l]:(r.seek(f,0),c=r.readByte(),u=r.readS(),g=r.readS(),(p=(p=null)!=u?(g=null!=g?S.UIPackage.getById(g):h.owner)?g.getItemById(u):null:p)?(a=S.UIObjectFactory.newObject(p)).asCom.constructFromResource(i):a=S.UIObjectFactory.newObject(c)),a._underConstruct=!0,a.setup_beforeAdd(r,f),(a.parent=this)._children.push(a),r.pos=f+y,null!=i&&x(i.obj,i.keys,a,a.name)}for(r.seek(0,3),this.relations.setup(r,!0),r.seek(0,2),r.skip(2),l=0;l<d;l++)s=r.getInt16(),s+=r.pos,r.seek(r.pos,3),this._children[l].relations.setup(r,!1),r.pos=s;for(r.seek(0,2),r.skip(2),l=0;l<d;l++)s=r.getInt16(),s+=r.pos,(a=this._children[l]).setup_afterAdd(r,r.pos),a._underConstruct=!1,r.pos=s;r.seek(0,4),r.skip(2),this.opaque=r.readBool();var m,w=r.getInt16(),n=(-1!=w&&this.setMask(this.getChildAt(w).displayObject,r.readBool()),r.readS()),w=r.getInt32(),v=r.getInt32(),C=(n?(p=h.owner.getItemById(n))&&p.pixelHitTestData&&(m=new S.PixelHitTest(p.pixelHitTestData,w,v)):0!=w&&-1!=v&&(m=new S.ChildHitArea(this.getChildAt(v).displayObject)),m&&(this._displayObject.hitArea=m,this._displayObject.mouseThrough=!1,this._displayObject.hitTestPrior=!0),r.seek(0,5),r.getInt16());for(l=0;l<C;l++){s=r.getInt16(),s+=r.pos;var b=new S.Transition(this);b.setup(r),this._transitions.push(b),r.pos=s,null!=i&&x(i.obj,i.keys,b,b.name)}0<this._transitions.length&&(this.displayObject.on(Laya.Event.DISPLAY,this,this.___added),this.displayObject.on(Laya.Event.UNDISPLAY,this,this.___removed)),this.applyAllControllers(),this._buildingDisplayList=!1,this._underConstruct=!1,this.buildNativeDisplayList(),this.setBoundsChangedFlag(),h.objectType!=S.ObjectType.Component&&this.constructExtension(r),this.onConstruct()}constructExtension(t){}onConstruct(){this.constructFromXML(null)}constructFromXML(t){}setup_afterAdd(t,e){super.setup_afterAdd(t,e),t.seek(e,4);var i,s,e=t.getInt16();for(-1!=e&&this._scrollPane&&(this._scrollPane.pageController=this._parent.getControllerAt(e)),i=t.getInt16(),s=0;s<i;s++){var a=this.getController(t.readS()),h=t.readS();a&&(a.selectedPageId=h)}if(2<=t.version)for(i=t.getInt16(),s=0;s<i;s++){var r=t.readS(),n=t.getInt16(),o=t.readS(),r=this.getChildByPath(r);r&&r.setProp(n,o)}}___added(){for(var t=this._transitions.length,e=0;e<t;++e)this._transitions[e].onOwnerAddedToStage()}___removed(){for(var t=this._transitions.length,e=0;e<t;++e)this._transitions[e].onOwnerRemovedFromStage()}}S.GComponent=r}(fgui),function(r){class n extends r.GComponent{constructor(){super(),this._soundVolumeScale=0,this._downEffect=0,this._mode=r.ButtonMode.Common,this._title="",this._icon="",this._sound=r.UIConfig.buttonSound,this._soundVolumeScale=r.UIConfig.buttonSoundVolumeScale,this._changeStateOnClick=!0,this._downEffectValue=.8}get icon(){return this._icon}set icon(t){this._icon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}get selectedIcon(){return this._selectedIcon}set selectedIcon(t){this._selectedIcon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,this._iconObject&&(this._iconObject.icon=t)}get title(){return this._title}set title(t){this._title=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title),this.updateGear(6)}get text(){return this.title}set text(t){this.title=t}get selectedTitle(){return this._selectedTitle}set selectedTitle(t){this._selectedTitle=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title)}get titleColor(){var t=this.getTextField();return t?t.color:"#000000"}set titleColor(t){var e=this.getTextField();e&&(e.color=t),this.updateGear(4)}get titleFontSize(){var t=this.getTextField();return t?t.fontSize:0}set titleFontSize(t){var e=this.getTextField();e&&(e.fontSize=t)}get sound(){return this._sound}set sound(t){this._sound=t}get soundVolumeScale(){return this._soundVolumeScale}set soundVolumeScale(t){this._soundVolumeScale=t}set selected(t){this._mode!=r.ButtonMode.Common&&this._selected!=t&&(this._selected=t,this.grayed&&this._buttonController&&this._buttonController.hasPage(n.DISABLED)?this._selected?this.setState(n.SELECTED_DISABLED):this.setState(n.DISABLED):this._selected?this.setState(this._over?n.SELECTED_OVER:n.DOWN):this.setState(this._over?n.OVER:n.UP),this._selectedTitle&&this._titleObject&&(this._titleObject.text=this._selected?this._selectedTitle:this._title),this._selectedIcon&&(t=this._selected?this._selectedIcon:this._icon,this._iconObject)&&(this._iconObject.icon=t),this._relatedController)&&this._parent&&!this._parent._buildingDisplayList&&(this._selected?(this._relatedController.selectedPageId=this._relatedPageId,this._relatedController.autoRadioGroupDepth&&this._parent.adjustRadioGroupDepth(this,this._relatedController)):this._mode==r.ButtonMode.Check&&this._relatedController.selectedPageId==this._relatedPageId&&(this._relatedController.oppositePageId=this._relatedPageId))}get selected(){return this._selected}get mode(){return this._mode}set mode(t){this._mode!=t&&(t==r.ButtonMode.Common&&(this.selected=!1),this._mode=t)}get relatedController(){return this._relatedController}set relatedController(t){t!=this._relatedController&&(this._relatedController=t,this._relatedPageId=null)}get relatedPageId(){return this._relatedPageId}set relatedPageId(t){this._relatedPageId=t}get changeStateOnClick(){return this._changeStateOnClick}set changeStateOnClick(t){this._changeStateOnClick=t}get linkedPopup(){return this._linkedPopup}set linkedPopup(t){this._linkedPopup=t}get downEffect(){return this._downEffect}set downEffect(t){this._downEffect=t}getTextField(){return this._titleObject instanceof r.GTextField?this._titleObject:this._titleObject instanceof r.GLabel||this._titleObject instanceof n?this._titleObject.getTextField():null}fireClick(t){(t=null==t?!0:t)&&this._mode==r.ButtonMode.Common&&(this.setState(n.OVER),Laya.timer.once(100,this,this.setState,[n.DOWN],!1),Laya.timer.once(200,this,this.setState,[n.UP],!1)),this.__click(r.Events.createEvent(Laya.Event.CLICK,this.displayObject))}setState(t){if(this._buttonController&&(this._buttonController.selectedPage=t),1==this._downEffect){var e=this.numChildren;if(t==n.DOWN||t==n.SELECTED_OVER||t==n.SELECTED_DISABLED)for(var i=255*this._downEffectValue,s=Laya.Utils.toHexColor((i<<16)+(i<<8)+i),a=0;a<e;a++){var h=this.getChildAt(a);h instanceof r.GTextField||h.setProp(r.ObjectPropID.Color,s)}else for(a=0;a<e;a++)(h=this.getChildAt(a))instanceof r.GTextField||h.setProp(r.ObjectPropID.Color,"#FFFFFF")}else 2!=this._downEffect&&3!=this._downEffect||(t==n.DOWN||t==n.SELECTED_OVER||t==n.SELECTED_DISABLED?this._downScaled||(this.setScale(this.scaleX*this._downEffectValue,this.scaleY*this._downEffectValue),this._downScaled=!0):this._downScaled&&(this.setScale(this.scaleX/this._downEffectValue,this.scaleY/this._downEffectValue),this._downScaled=!1))}handleControllerChanged(t){super.handleControllerChanged(t),this._relatedController==t&&(this.selected=this._relatedPageId==t.selectedPageId)}handleGrayedChanged(){this._buttonController&&this._buttonController.hasPage(n.DISABLED)?this.grayed?this._selected&&this._buttonController.hasPage(n.SELECTED_DISABLED)?this.setState(n.SELECTED_DISABLED):this.setState(n.DISABLED):this._selected?this.setState(n.DOWN):this.setState(n.UP):super.handleGrayedChanged()}getProp(t){switch(t){case r.ObjectPropID.Color:return this.titleColor;case r.ObjectPropID.OutlineColor:return(e=this.getTextField())?e.strokeColor:0;case r.ObjectPropID.FontSize:return this.titleFontSize;case r.ObjectPropID.Selected:return this.selected;case r.ObjectPropID.ShadowColor:var e;return(e=this.getTextField())?e.shadowColor:0;default:return super.getProp(t)}}setProp(t,e){switch(t){case r.ObjectPropID.Color:this.titleColor=e;break;case r.ObjectPropID.OutlineColor:(i=this.getTextField())&&(i.strokeColor=e);break;case r.ObjectPropID.FontSize:this.titleFontSize=e;break;case r.ObjectPropID.Selected:this.selected=e;break;case r.ObjectPropID.ShadowColor:var i;(i=this.getTextField())&&(i.shadowColor=e);break;default:super.setProp(t,e)}}constructExtension(t){t.seek(0,6),this._mode=t.readByte();var e=t.readS();e&&(this._sound=e),this._soundVolumeScale=t.getFloat32(),this._downEffect=t.readByte(),this._downEffectValue=t.getFloat32(),2==this._downEffect&&this.setPivot(.5,.5,this.pivotAsAnchor),this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),this._titleObject&&(this._title=this._titleObject.text),this._iconObject&&(this._icon=this._iconObject.icon),this._mode==r.ButtonMode.Common&&this.setState(n.UP),this.on(Laya.Event.ROLL_OVER,this,this.__rollover),this.on(Laya.Event.ROLL_OUT,this,this.__rollout),this.on(Laya.Event.MOUSE_DOWN,this,this.__mousedown),this.on(Laya.Event.CLICK,this,this.__click)}setup_afterAdd(t,e){var i;super.setup_afterAdd(t,e),t.seek(e,6)&&t.readByte()==this.packageItem.objectType&&(null!=(e=t.readS())&&(this.title=e),null!=(e=t.readS())&&(this.selectedTitle=e),null!=(e=t.readS())&&(this.icon=e),null!=(e=t.readS())&&(this.selectedIcon=e),t.readBool()&&(this.titleColor=t.readColorS()),0!=(i=t.getInt32())&&(this.titleFontSize=i),0<=(i=t.getInt16())&&(this._relatedController=this.parent.getControllerAt(i)),this._relatedPageId=t.readS(),null!=(e=t.readS())&&(this._sound=e),t.readBool()&&(this._soundVolumeScale=t.getFloat32()),this.selected=t.readBool())}__rollover(){this._buttonController&&this._buttonController.hasPage(n.OVER)&&(this._over=!0,this._down||this.grayed&&this._buttonController.hasPage(n.DISABLED)||this.setState(this._selected?n.SELECTED_OVER:n.OVER))}__rollout(){this._buttonController&&this._buttonController.hasPage(n.OVER)&&(this._over=!1,this._down||this.grayed&&this._buttonController.hasPage(n.DISABLED)||this.setState(this._selected?n.DOWN:n.UP))}__mousedown(t){this._down=!0,r.GRoot.inst.checkPopups(t.target),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.__mouseup),this._mode==r.ButtonMode.Common&&(this.grayed&&this._buttonController&&this._buttonController.hasPage(n.DISABLED)?this.setState(n.SELECTED_DISABLED):this.setState(n.DOWN)),this._linkedPopup&&(this._linkedPopup instanceof r.Window?this._linkedPopup.toggleStatus():this.root.togglePopup(this._linkedPopup,this))}__mouseup(){this._down&&(Laya.stage.off(Laya.Event.MOUSE_UP,this,this.__mouseup),this._down=!1,null!=this._displayObject)&&this._mode==r.ButtonMode.Common&&(this.grayed&&this._buttonController&&this._buttonController.hasPage(n.DISABLED)?this.setState(n.DISABLED):this._over?this.setState(n.OVER):this.setState(n.UP))}__click(t){var e;this._sound&&((e=r.UIPackage.getItemByURL(this._sound))?r.GRoot.inst.playOneShotSound(e.file):r.GRoot.inst.playOneShotSound(this._sound)),this._mode==r.ButtonMode.Check?this._changeStateOnClick&&(this.selected=!this._selected,r.Events.dispatch(r.Events.STATE_CHANGED,this.displayObject,t)):this._mode==r.ButtonMode.Radio?this._changeStateOnClick&&!this._selected&&(this.selected=!0,r.Events.dispatch(r.Events.STATE_CHANGED,this.displayObject,t)):this._relatedController&&(this._relatedController.selectedPageId=this._relatedPageId)}}n.UP="up",n.DOWN="down",n.OVER="over",n.SELECTED_OVER="selectedOver",n.DISABLED="disabled",n.SELECTED_DISABLED="selectedDisabled",r.GButton=n}(fgui),function(a){class t extends a.GComponent{constructor(){super(),this._visibleItemCount=a.UIConfig.defaultComboBoxVisibleItemCount,this._itemsUpdated=!0,this._selectedIndex=-1,this._popupDirection=0,this._items=[],this._values=[]}get text(){return this._titleObject?this._titleObject.text:null}set text(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)}get titleColor(){var t=this.getTextField();return t?t.color:"#000000"}set titleColor(t){var e=this.getTextField();e&&(e.color=t),this.updateGear(4)}get titleFontSize(){var t=this.getTextField();return t?t.fontSize:0}set titleFontSize(t){var e=this.getTextField();e&&(e.fontSize=t)}get icon(){return this._iconObject?this._iconObject.icon:null}set icon(t){this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}get visibleItemCount(){return this._visibleItemCount}set visibleItemCount(t){this._visibleItemCount=t}get popupDirection(){return this._popupDirection}set popupDirection(t){this._popupDirection=t}get items(){return this._items}set items(t){t?this._items=t.concat():this._items.length=0,0<this._items.length?(this._selectedIndex>=this._items.length?this._selectedIndex=this._items.length-1:-1==this._selectedIndex&&(this._selectedIndex=0),this.text=this._items[this._selectedIndex],this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",this._icons&&(this.icon=null),this._selectedIndex=-1),this._itemsUpdated=!0}get icons(){return this._icons}set icons(t){this._icons=t,this._icons&&-1!=this._selectedIndex&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])}get values(){return this._values}set values(t){t?this._values=t.concat():this._values.length=0}get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._selectedIndex!=t&&(this._selectedIndex=t,0<=this._selectedIndex&&this._selectedIndex<this._items.length?(this.text=this._items[this._selectedIndex],this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",this._icons&&(this.icon=null)),this.updateSelectionController())}get value(){return this._values[this._selectedIndex]}set value(t){var e=this._values.indexOf(t);-1==e&&null==t&&(e=this._values.indexOf("")),this.selectedIndex=e}getTextField(){return this._titleObject instanceof a.GTextField?this._titleObject:this._titleObject instanceof a.GLabel||this._titleObject instanceof a.GButton?this._titleObject.getTextField():null}setState(t){this._buttonController&&(this._buttonController.selectedPage=t)}get selectionController(){return this._selectionController}set selectionController(t){this._selectionController=t}handleControllerChanged(t){super.handleControllerChanged(t),this._selectionController==t&&(this.selectedIndex=t.selectedIndex)}updateSelectionController(){var t;this._selectionController&&!this._selectionController.changing&&this._selectedIndex<this._selectionController.pageCount&&(t=this._selectionController,this._selectionController=null,t.selectedIndex=this._selectedIndex,this._selectionController=t)}dispose(){this.dropdown&&(this.dropdown.dispose(),this.dropdown=null),this._selectionController=null,super.dispose()}getProp(t){switch(t){case a.ObjectPropID.Color:return this.titleColor;case a.ObjectPropID.OutlineColor:return(e=this.getTextField())?e.strokeColor:0;case a.ObjectPropID.FontSize:return(e=this.getTextField())?e.fontSize:0;case a.ObjectPropID.ShadowColor:var e;return(e=this.getTextField())?e.shadowColor:0;default:return super.getProp(t)}}setProp(t,e){switch(t){case a.ObjectPropID.Color:this.titleColor=e;break;case a.ObjectPropID.OutlineColor:(i=this.getTextField())&&(i.strokeColor=e);break;case a.ObjectPropID.FontSize:(i=this.getTextField())&&(i.fontSize=e);break;case a.ObjectPropID.ShadowColor:var i;(i=this.getTextField())&&(i.shadowColor=e);break;default:super.setProp(t,e)}}constructExtension(t){if(this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),t=t.readS()){if(this.dropdown=a.UIPackage.createObjectFromURL(t),!this.dropdown)return void Laya.Log.print("下拉框必须为元件");if(this.dropdown.name="this._dropdownObject",this._list=this.dropdown.getChild("list"),!this._list)return void Laya.Log.print(this.resourceURL+": 下拉框的弹出元件里必须包含名为list的列表");this._list.on(a.Events.CLICK_ITEM,this,this.__clickItem),this._list.addRelation(this.dropdown,a.RelationType.Width),this._list.removeRelation(this.dropdown,a.RelationType.Height),this.dropdown.addRelation(this._list,a.RelationType.Height),this.dropdown.removeRelation(this._list,a.RelationType.Width),this.dropdown.displayObject.on(Laya.Event.UNDISPLAY,this,this.__popupWinClosed)}this.on(Laya.Event.ROLL_OVER,this,this.__rollover),this.on(Laya.Event.ROLL_OUT,this,this.__rollout),this.on(Laya.Event.MOUSE_DOWN,this,this.__mousedown)}setup_afterAdd(t,e){if(super.setup_afterAdd(t,e),t.seek(e,6)&&t.readByte()==this.packageItem.objectType){for(var i,s,a=t.getInt16(),h=0;h<a;h++)i=t.getInt16(),i+=t.pos,this._items[h]=t.readS(),this._values[h]=t.readS(),null!=(s=t.readS())&&(this._icons||(this._icons=[]),this._icons[h]=s),t.pos=i;null!=(s=t.readS())?(this.text=s,this._selectedIndex=this._items.indexOf(s)):0<this._items.length?(this._selectedIndex=0,this.text=this._items[0]):this._selectedIndex=-1,null!=(s=t.readS())&&(this.icon=s),t.readBool()&&(this.titleColor=t.readColorS()),0<(e=t.getInt32())&&(this._visibleItemCount=e),this._popupDirection=t.readByte(),0<=(e=t.getInt16())&&(this._selectionController=this.parent.getControllerAt(e))}}showDropdown(){if(this._itemsUpdated){this._itemsUpdated=!1,this._list.removeChildrenToPool();for(var t=this._items.length,e=0;e<t;e++){var i=this._list.addItemFromPool();i.name=e<this._values.length?this._values[e]:"",i.text=this._items[e],i.icon=this._icons&&e<this._icons.length?this._icons[e]:null}this._list.resizeToFit(this._visibleItemCount)}this._list.selectedIndex=-1,this.dropdown.width=this.width,this._list.ensureBoundsCorrect();var s=null;this._popupDirection==a.PopupDirection.Down?s=!0:this._popupDirection==a.PopupDirection.Up&&(s=!1),this.root.togglePopup(this.dropdown,this,s),this.dropdown.parent&&this.setState(a.GButton.DOWN)}__popupWinClosed(){this._over?this.setState(a.GButton.OVER):this.setState(a.GButton.UP)}__clickItem(t,e){Laya.timer.callLater(this,this.__clickItem2,[this._list.getChildIndex(t),e])}__clickItem2(t,e){this.dropdown.parent instanceof a.GRoot&&this.dropdown.parent.hidePopup(),this._selectedIndex=-1,this.selectedIndex=t,a.Events.dispatch(a.Events.STATE_CHANGED,this.displayObject,e)}__rollover(){this._over=!0,this._down||this.dropdown&&this.dropdown.parent||this.setState(a.GButton.OVER)}__rollout(){this._over=!1,this._down||this.dropdown&&this.dropdown.parent||this.setState(a.GButton.UP)}__mousedown(t){t.target instanceof Laya.Input||(this._down=!0,a.GRoot.inst.checkPopups(t.target),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.__mouseup),this.dropdown&&this.showDropdown())}__mouseup(){this._down&&(this._down=!1,Laya.stage.off(Laya.Event.MOUSE_UP,this,this.__mouseup),this.dropdown)&&!this.dropdown.parent&&(this._over?this.setState(a.GButton.OVER):this.setState(a.GButton.UP))}}a.GComboBox=t}(fgui),function(g){class t extends g.GObject{constructor(){super(),this._type=0,this._lineSize=1,this._lineColor="#000000",this._fillColor="#FFFFFF"}drawRect(t,e,i,s){this._type=1,this._lineSize=t,this._lineColor=e,this._fillColor=i,this._cornerRadius=s,this.updateGraph()}drawEllipse(t,e,i){this._type=2,this._lineSize=t,this._lineColor=e,this._fillColor=i,this.updateGraph()}drawRegularPolygon(t,e,i,s,a,h){this._type=4,this._lineSize=t,this._lineColor=e,this._fillColor=i,this._sides=s,this._startAngle=a||0,this._distances=h,this.updateGraph()}drawPolygon(t,e,i,s){this._type=3,this._lineSize=t,this._lineColor=e,this._fillColor=i,this._polygonPoints=s,this.updateGraph()}get distances(){return this._distances}set distances(t){this._distances=t,3==this._type&&this.updateGraph()}get color(){return this._fillColor}set color(t){this._fillColor=t,this.updateGear(4),0!=this._type&&this.updateGraph()}updateGraph(){this._displayObject.mouseEnabled=this.touchable;var t=this._displayObject.graphics,e=(t.clear(),this.width),i=this.height;if(0!=e&&0!=i){var s,a,h=this._fillColor,r=this._lineColor;if(g.ToolSet.startsWith(h,"rgba")&&(a=h.substring(5,h.lastIndexOf(")")).split(","),0==(s=parseFloat(a[3]))?h=null:(h=Laya.Utils.toHexColor((parseInt(a[0])<<16)+(parseInt(a[1])<<8)+parseInt(a[2])),this.alpha=s)),1==this._type)this._cornerRadius?(a=[["moveTo",this._cornerRadius[0],0],["lineTo",e-this._cornerRadius[1],0],["arcTo",e,0,e,this._cornerRadius[1],this._cornerRadius[1]],["lineTo",e,i-this._cornerRadius[3]],["arcTo",e,i,e-this._cornerRadius[3],i,this._cornerRadius[3]],["lineTo",this._cornerRadius[2],i],["arcTo",0,i,0,i-this._cornerRadius[2],this._cornerRadius[2]],["lineTo",0,this._cornerRadius[0]],["arcTo",0,0,this._cornerRadius[0],0,this._cornerRadius[0]],["closePath"]],t.drawPath(0,0,a,h?{fillStyle:h}:null,0<this._lineSize?{strokeStyle:r,lineWidth:this._lineSize}:null)):t.drawRect(0,0,e,i,h,0<this._lineSize?r:null,this._lineSize);else if(2==this._type)t.drawCircle(e/2,i/2,e/2,h,0<this._lineSize?r:null,this._lineSize);else if(3==this._type)t.drawPoly(0,0,this._polygonPoints,h,0<this._lineSize?r:null,this._lineSize);else if(4==this._type){this._polygonPoints||(this._polygonPoints=[]);for(var n,o=Math.min(this._width,this._height)/2,l=(this._polygonPoints.length=0,Laya.Utils.toRadian(this._startAngle)),_=2*Math.PI/this._sides,d=0;d<this._sides;d++){var c=o+o*(n=!this._distances||(n=this._distances[d],isNaN(n))?1:n)*Math.cos(l),u=o+o*n*Math.sin(l);this._polygonPoints.push(c,u),l+=_}t.drawPoly(0,0,this._polygonPoints,h,0<this._lineSize?r:null,this._lineSize)}this._displayObject.repaint()}}replaceMe(t){if(!this._parent)throw"parent not set";t.name=this.name,t.alpha=this.alpha,t.rotation=this.rotation,t.visible=this.visible,t.touchable=this.touchable,t.grayed=this.grayed,t.setXY(this.x,this.y),t.setSize(this.width,this.height);var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e),t.relations.copyFrom(this.relations),this._parent.removeChild(this,!0)}addBeforeMe(t){if(!this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e)}addAfterMe(t){if(!this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,++e)}setNativeObject(t){this._type=0,this._displayObject.mouseEnabled=this.touchable,this._displayObject.graphics.clear(),this._displayObject.addChild(t)}createDisplayObject(){super.createDisplayObject(),this._displayObject.mouseEnabled=!1,this._hitArea=new Laya.HitArea,this._hitArea.hit=this._displayObject.graphics,this._displayObject.hitArea=this._hitArea}getProp(t){return t==g.ObjectPropID.Color?this.color:super.getProp(t)}setProp(t,e){t==g.ObjectPropID.Color?this.color=e:super.setProp(t,e)}handleSizeChanged(){super.handleSizeChanged(),0!=this._type&&this.updateGraph()}setup_beforeAdd(t,e){if(super.setup_beforeAdd(t,e),t.seek(e,5),this._type=t.readByte(),0!=this._type){var i,s;if(this._lineSize=t.getInt32(),this._lineColor=t.readColorS(!0),this._fillColor=t.readColorS(!0),t.readBool())for(this._cornerRadius=[],i=0;i<4;i++)this._cornerRadius[i]=t.getFloat32();if(3==this._type)for(s=t.getInt16(),this._polygonPoints=[],this._polygonPoints.length=s,i=0;i<s;i++)this._polygonPoints[i]=t.getFloat32();else if(4==this._type&&(this._sides=t.getInt16(),this._startAngle=t.getFloat32(),0<(s=t.getInt16())))for(this._distances=[],i=0;i<s;i++)this._distances[i]=t.getFloat32();this.updateGraph()}}}g.GGraph=t}(fgui),function(d){class t extends d.GObject{constructor(){super(),this._layout=0,this._lineGap=0,this._columnGap=0,this._mainGridIndex=-1,this._mainGridMinSize=50,this._mainChildIndex=-1,this._totalSize=0,this._numChildren=0,this._updating=0}dispose(){this._boundsChanged=!1,super.dispose()}get layout(){return this._layout}set layout(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag())}get lineGap(){return this._lineGap}set lineGap(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(!0))}get columnGap(){return this._columnGap}set columnGap(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(!0))}get excludeInvisibles(){return this._excludeInvisibles}set excludeInvisibles(t){this._excludeInvisibles!=t&&(this._excludeInvisibles=t,this.setBoundsChangedFlag())}get autoSizeDisabled(){return this._autoSizeDisabled}set autoSizeDisabled(t){this._autoSizeDisabled=t}get mainGridMinSize(){return this._mainGridMinSize}set mainGridMinSize(t){this._mainGridMinSize!=t&&(this._mainGridMinSize=t,this.setBoundsChangedFlag())}get mainGridIndex(){return this._mainGridIndex}set mainGridIndex(t){this._mainGridIndex!=t&&(this._mainGridIndex=t,this.setBoundsChangedFlag())}setBoundsChangedFlag(t){0==this._updating&&this._parent&&(t||(this._percentReady=!1),this._boundsChanged||(this._boundsChanged=!0,this._layout!=d.GroupLayoutType.None&&Laya.timer.callLater(this,this.ensureBoundsCorrect)))}ensureSizeCorrect(){this._parent&&this._boundsChanged&&0!=this._layout&&(this._boundsChanged=!1,this._autoSizeDisabled?this.resizeChildren(0,0):(this.handleLayout(),this.updateBounds()))}ensureBoundsCorrect(){this._parent&&this._boundsChanged&&(this._boundsChanged=!1,0==this._layout?this.updateBounds():this._autoSizeDisabled?this.resizeChildren(0,0):(this.handleLayout(),this.updateBounds()))}updateBounds(){Laya.timer.clear(this,this.ensureBoundsCorrect);for(var t,e,i=this._parent.numChildren,s=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=!0,o=0;o<i;o++)(t=this._parent.getChildAt(o)).group!=this||this._excludeInvisibles&&!t.internalVisible3||((e=t.xMin)<s&&(s=e),(e=t.yMin)<a&&(a=e),h<(e=t.xMin+t.width)&&(h=e),r<(e=t.yMin+t.height)&&(r=e),n=!1);var l=0,_=0;n||(this._updating|=1,this.setXY(s,a),this._updating&=2,l=h-s,_=r-a),0==(2&this._updating)?(this._updating|=2,this.setSize(l,_),this._updating&=1):(this._updating&=1,this.resizeChildren(this._width-l,this._height-_))}handleLayout(){var t;if(this._updating|=1,this._layout==d.GroupLayoutType.Horizontal)for(var e=this.x,i=this._parent.numChildren,s=0;s<i;s++)(t=this._parent.getChildAt(s)).group!=this||this._excludeInvisibles&&!t.internalVisible3||(t.xMin=e,0!=t.width&&(e+=t.width+this._columnGap));else if(this._layout==d.GroupLayoutType.Vertical){var a=this.y;for(i=this._parent.numChildren,s=0;s<i;s++)(t=this._parent.getChildAt(s)).group!=this||this._excludeInvisibles&&!t.internalVisible3||(t.yMin=a,0!=t.height&&(a+=t.height+this._lineGap))}this._updating&=2}moveChildren(t,e){if(0==(1&this._updating)&&this._parent){this._updating|=1;for(var i,s=this._parent.numChildren,a=0;a<s;a++)(i=this._parent.getChildAt(a)).group==this&&i.setXY(i.x+t,i.y+e);this._updating&=2}}resizeChildren(t,e){if(this._layout!=d.GroupLayoutType.None&&0==(2&this._updating)&&this._parent)if(this._updating|=2,this._boundsChanged&&(this._boundsChanged=!1,!this._autoSizeDisabled))this.updateBounds();else{var i,s=this._parent.numChildren;if(!this._percentReady){this._percentReady=!0,this._numChildren=0,this._totalSize=0,this._mainChildIndex=-1;for(var a=0,h=0;h<s;h++)(i=this._parent.getChildAt(h)).group==this&&(this._excludeInvisibles&&!i.internalVisible3||(a==this._mainGridIndex&&(this._mainChildIndex=h),this._numChildren++,1==this._layout?this._totalSize+=i.width:this._totalSize+=i.height),a++);for(-1!=this._mainChildIndex&&(1==this._layout?(i=this._parent.getChildAt(this._mainChildIndex),this._totalSize+=this._mainGridMinSize-i.width):(i=this._parent.getChildAt(this._mainChildIndex),this._totalSize+=this._mainGridMinSize-i.height),i._sizePercentInGroup=this._mainGridMinSize/this._totalSize),h=0;h<s;h++)(i=this._parent.getChildAt(h)).group==this&&h!=this._mainChildIndex&&(0<this._totalSize?i._sizePercentInGroup=(1==this._layout?i.width:i.height)/this._totalSize:i._sizePercentInGroup=0)}var r=0,n=1,o=!1;if(1==this._layout){r=this.width-(this._numChildren-1)*this._columnGap,-1!=this._mainChildIndex&&r>=this._totalSize&&((i=this._parent.getChildAt(this._mainChildIndex)).setSize(r-(this._totalSize-this._mainGridMinSize),i._rawHeight+e,!0),r-=i.width,n-=i._sizePercentInGroup,o=!0);var l=this.x;for(h=0;h<s;h++)(i=this._parent.getChildAt(h)).group==this&&(this._excludeInvisibles&&!i.internalVisible3?i.setSize(i._rawWidth,i._rawHeight+e,!0):(o&&h==this._mainChildIndex||(i.setSize(Math.round(i._sizePercentInGroup/n*r),i._rawHeight+e,!0),n-=i._sizePercentInGroup,r-=i.width),i.xMin=l,0!=i.width&&(l+=i.width+this._columnGap)))}else{r=this.height-(this._numChildren-1)*this._lineGap,-1!=this._mainChildIndex&&r>=this._totalSize&&((i=this._parent.getChildAt(this._mainChildIndex)).setSize(i._rawWidth+t,r-(this._totalSize-this._mainGridMinSize),!0),r-=i.height,n-=i._sizePercentInGroup,o=!0);var _=this.y;for(h=0;h<s;h++)(i=this._parent.getChildAt(h)).group==this&&(this._excludeInvisibles&&!i.internalVisible3?i.setSize(i._rawWidth+t,i._rawHeight,!0):(o&&h==this._mainChildIndex||(i.setSize(i._rawWidth+t,Math.round(i._sizePercentInGroup/n*r),!0),n-=i._sizePercentInGroup,r-=i.height),i.yMin=_,0!=i.height&&(_+=i.height+this._lineGap)))}this._updating&=1}}handleAlphaChanged(){if(!this._underConstruct)for(var t=this._parent.numChildren,e=0;e<t;e++){var i=this._parent.getChildAt(e);i.group==this&&(i.alpha=this.alpha)}}handleVisibleChanged(){if(this._parent)for(var t=this._parent.numChildren,e=0;e<t;e++){var i=this._parent.getChildAt(e);i.group==this&&i.handleVisibleChanged()}}setup_beforeAdd(t,e){super.setup_beforeAdd(t,e),t.seek(e,5),this._layout=t.readByte(),this._lineGap=t.getInt32(),this._columnGap=t.getInt32(),2<=t.version&&(this._excludeInvisibles=t.readBool(),this._autoSizeDisabled=t.readBool(),this._mainGridIndex=t.getInt16())}setup_afterAdd(t,e){super.setup_afterAdd(t,e),this.visible||this.handleVisibleChanged()}}d.GGroup=t}(fgui),function(i){class t extends i.GObject{constructor(){super(),this._flip=0}get image(){return this._image}get color(){return this.image.color}set color(t){this.image.color!=t&&(this.image.color=t,this.updateGear(4))}get flip(){return this._flip}set flip(t){var e;this._flip!=t&&(this._flip=t,e=t=1,this._flip!=i.FlipType.Horizontal&&this._flip!=i.FlipType.Both||(t=-1),this._flip!=i.FlipType.Vertical&&this._flip!=i.FlipType.Both||(e=-1),this.setScale(t,e),this.handleXYChanged())}get fillMethod(){return this.image.fillMethod}set fillMethod(t){this.image.fillMethod=t}get fillOrigin(){return this.image.fillOrigin}set fillOrigin(t){this.image.fillOrigin=t}get fillClockwise(){return this.image.fillClockwise}set fillClockwise(t){this.image.fillClockwise=t}get fillAmount(){return this.image.fillAmount}set fillAmount(t){this.image.fillAmount=t}createDisplayObject(){this._displayObject=this._image=new i.Image,this.image.mouseEnabled=!1,this._displayObject.$owner=this}constructFromResource(){this._contentItem=this.packageItem.getBranch(),this.sourceWidth=this._contentItem.width,this.sourceHeight=this._contentItem.height,this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this._contentItem=this._contentItem.getHighResolution(),this._contentItem.load(),this.image.scale9Grid=this._contentItem.scale9Grid,this.image.scaleByTile=this._contentItem.scaleByTile,this.image.tileGridIndice=this._contentItem.tileGridIndice,this.image.texture=this._contentItem.texture,this.setSize(this.sourceWidth,this.sourceHeight)}handleXYChanged(){super.handleXYChanged(),this._flip!=i.FlipType.None&&(-1==this.scaleX&&(this.image.x+=this.width),-1==this.scaleY)&&(this.image.y+=this.height)}getProp(t){return t==i.ObjectPropID.Color?this.color:super.getProp(t)}setProp(t,e){t==i.ObjectPropID.Color?this.color=e:super.setProp(t,e)}setup_beforeAdd(t,e){super.setup_beforeAdd(t,e),t.seek(e,5),t.readBool()&&(this.color=t.readColorS()),this.flip=t.readByte(),this.image.fillMethod=t.readByte(),0!=this.image.fillMethod&&(this.image.fillOrigin=t.readByte(),this.image.fillClockwise=t.readBool(),this.image.fillAmount=t.getFloat32())}}i.GImage=t}(fgui),function(a){class t extends a.GComponent{constructor(){super()}get icon(){return this._iconObject?this._iconObject.icon:null}set icon(t){this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)}get title(){return this._titleObject?this._titleObject.text:null}set title(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)}get text(){return this.title}set text(t){this.title=t}get titleColor(){var t=this.getTextField();return t?t.color:"#000000"}set titleColor(t){var e=this.getTextField();e&&(e.color=t),this.updateGear(4)}get titleFontSize(){var t=this.getTextField();return t?t.fontSize:0}set titleFontSize(t){var e=this.getTextField();e&&(e.fontSize=t)}get color(){return this.titleColor}set color(t){this.titleColor=t}set editable(t){this._titleObject&&(this._titleObject.asTextInput.editable=t)}get editable(){return this._titleObject instanceof a.GTextInput&&this._titleObject.asTextInput.editable}getTextField(){return this._titleObject instanceof a.GTextField?this._titleObject:this._titleObject instanceof t||this._titleObject instanceof a.GButton?this._titleObject.getTextField():null}getProp(t){switch(t){case a.ObjectPropID.Color:return this.titleColor;case a.ObjectPropID.OutlineColor:return(e=this.getTextField())?e.strokeColor:0;case a.ObjectPropID.FontSize:return this.titleFontSize;case a.ObjectPropID.ShadowColor:var e;return(e=this.getTextField())?e.shadowColor:0;default:return super.getProp(t)}}setProp(t,e){switch(t){case a.ObjectPropID.Color:this.titleColor=e;break;case a.ObjectPropID.OutlineColor:(i=this.getTextField())&&(i.strokeColor=e);break;case a.ObjectPropID.FontSize:this.titleFontSize=e;break;case a.ObjectPropID.ShadowColor:var i;(i=this.getTextField())&&(i.shadowColor=e);break;default:super.setProp(t,e)}}constructExtension(t){this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon")}setup_afterAdd(t,e){var i,s;super.setup_afterAdd(t,e),t.seek(e,6)&&t.readByte()==this.packageItem.objectType&&(null!=(e=t.readS())&&(this.title=e),null!=(e=t.readS())&&(this.icon=e),t.readBool()&&(this.titleColor=t.readColorS()),0!=(i=t.getInt32())&&(this.titleFontSize=i),t.readBool())&&((s=this.getTextField())instanceof a.GTextInput?(null!=(e=t.readS())&&(s.promptText=e),null!=(e=t.readS())&&(s.restrict=e),0!=(i=t.getInt32())&&(s.maxLength=i),0!=(i=t.getInt32())&&(4==i?s.keyboardType=Laya.Input.TYPE_NUMBER:3==i&&(s.keyboardType=Laya.Input.TYPE_URL)),t.readBool()&&(s.password=!0)):t.skip(13))}}a.GLabel=t}(fgui),function(x){class t extends x.GComponent{constructor(){super(),this._lineCount=0,this._columnCount=0,this._lineGap=0,this._columnGap=0,this._lastSelectedIndex=0,this._numItems=0,this._firstIndex=0,this._curLineItemCount=0,this._virtualListChanged=0,this.itemInfoVer=0,this._trackBounds=!0,this._pool=new x.GObjectPool,this._layout=x.ListLayoutType.SingleColumn,this._autoResizeItem=!0,this._lastSelectedIndex=-1,this._selectionMode=x.ListSelectionMode.Single,this.opaque=!0,this.scrollItemToViewOnClick=!0,this._align="left",this._verticalAlign="top",this._container=new Laya.Sprite,this._displayObject.addChild(this._container)}dispose(){this._pool.clear(),super.dispose()}get layout(){return this._layout}set layout(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag(),this._virtual)&&this.setVirtualListChangedFlag(!0)}get lineCount(){return this._lineCount}set lineCount(t){this._lineCount!=t&&(this._lineCount=t,this._layout!=x.ListLayoutType.FlowVertical&&this._layout!=x.ListLayoutType.Pagination||(this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0)))}get columnCount(){return this._columnCount}set columnCount(t){this._columnCount!=t&&(this._columnCount=t,this._layout!=x.ListLayoutType.FlowHorizontal&&this._layout!=x.ListLayoutType.Pagination||(this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0)))}get lineGap(){return this._lineGap}set lineGap(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(),this._virtual)&&this.setVirtualListChangedFlag(!0)}get columnGap(){return this._columnGap}set columnGap(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(),this._virtual)&&this.setVirtualListChangedFlag(!0)}get align(){return this._align}set align(t){this._align!=t&&(this._align=t,this.setBoundsChangedFlag(),this._virtual)&&this.setVirtualListChangedFlag(!0)}get verticalAlign(){return this._verticalAlign}set verticalAlign(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.setBoundsChangedFlag(),this._virtual)&&this.setVirtualListChangedFlag(!0)}get virtualItemSize(){return this._itemSize}set virtualItemSize(t){this._virtual&&(null==this._itemSize&&(this._itemSize=new Laya.Point),this._itemSize.setTo(t.x,t.y),this.setVirtualListChangedFlag(!0))}get defaultItem(){return this._defaultItem}set defaultItem(t){this._defaultItem=x.UIPackage.normalizeURL(t)}get autoResizeItem(){return this._autoResizeItem}set autoResizeItem(t){this._autoResizeItem!=t&&(this._autoResizeItem=t,this.setBoundsChangedFlag(),this._virtual)&&this.setVirtualListChangedFlag(!0)}get selectionMode(){return this._selectionMode}set selectionMode(t){this._selectionMode=t}get selectionController(){return this._selectionController}set selectionController(t){this._selectionController=t}get itemPool(){return this._pool}getFromPool(t){t=t||this._defaultItem;t=this._pool.getObject(t);return t&&(t.visible=!0),t}returnToPool(t){t.displayObject.cacheAs="none",this._pool.returnObject(t)}addChildAt(t,e){return super.addChildAt(t,e),t instanceof x.GButton&&(t.selected=!1,t.changeStateOnClick=!1),t.on(Laya.Event.CLICK,this,this.__clickItem),t}addItem(t){return t=t||this._defaultItem,this.addChild(x.UIPackage.createObjectFromURL(t))}addItemFromPool(t){return this.addChild(this.getFromPool(t))}removeChildAt(t,e){t=super.removeChildAt(t);return e?t.dispose():t.off(Laya.Event.CLICK,this,this.__clickItem),t}removeChildToPoolAt(t){t=super.removeChildAt(t);this.returnToPool(t)}removeChildToPool(t){super.removeChild(t),this.returnToPool(t)}removeChildrenToPool(t,e){((e=null==e?-1:e)<0||e>=this._children.length)&&(e=this._children.length-1);for(var i=t=null==t?0:t;i<=e;++i)this.removeChildToPoolAt(t)}get selectedIndex(){if(this._virtual)for(i=0;i<this._realNumItems;i++){var t=this._virtualItems[i];if(t.obj instanceof x.GButton&&t.obj.selected||null==t.obj&&t.selected)return this._loop?i%this._numItems:i}else for(var e=this._children.length,i=0;i<e;i++){var s=this._children[i];if(s instanceof x.GButton&&s.selected)return i}return-1}set selectedIndex(t){0<=t&&t<this.numItems?(this._selectionMode!=x.ListSelectionMode.Single&&this.clearSelection(),this.addSelection(t)):this.clearSelection()}getSelection(t){if(t=t||new Array,this._virtual)for(s=0;s<this._realNumItems;s++){var e=this._virtualItems[s];(e.obj instanceof x.GButton&&e.obj.selected||null==e.obj&&e.selected)&&(e=s,this._loop&&(e=s%this._numItems,-1!=t.indexOf(e))||t.push(e))}else for(var i=this._children.length,s=0;s<i;s++){var a=this._children[s];a instanceof x.GButton&&a.selected&&t.push(s)}return t}addSelection(t,e){var i;this._selectionMode!=x.ListSelectionMode.None&&(this.checkVirtualList(),this._selectionMode==x.ListSelectionMode.Single&&this.clearSelection(),e&&this.scrollToView(t),this._lastSelectedIndex=t,this._virtual?((e=this._virtualItems[t]).obj&&(i=e.obj),e.selected=!0):i=this.getChildAt(t),i instanceof x.GButton)&&!i.selected&&(i.selected=!0,this.updateSelectionController(t))}removeSelection(t){var e,i;this._selectionMode!=x.ListSelectionMode.None&&(this._virtual?((i=this._virtualItems[t]).obj&&(e=i.obj),i.selected=!1):e=this.getChildAt(t),e instanceof x.GButton)&&(e.selected=!1)}clearSelection(){if(this._virtual)for(i=0;i<this._realNumItems;i++){var t=this._virtualItems[i];t.obj instanceof x.GButton&&(t.obj.selected=!1),t.selected=!1}else for(var e=this._children.length,i=0;i<e;i++){var s=this._children[i];s instanceof x.GButton&&(s.selected=!1)}}clearSelectionExcept(t){if(this._virtual)for(s=0;s<this._realNumItems;s++){var e=this._virtualItems[s];e.obj!=t&&(e.obj instanceof x.GButton&&(e.obj.selected=!1),e.selected=!1)}else for(var i=this._children.length,s=0;s<i;s++){var a=this._children[s];a instanceof x.GButton&&a!=t&&(a.selected=!1)}}selectAll(){this.checkVirtualList();var t=-1;if(this._virtual)for(s=0;s<this._realNumItems;s++){var e=this._virtualItems[s];e.obj instanceof x.GButton&&!e.obj.selected&&(e.obj.selected=!0,t=s),e.selected=!0}else for(var i=this._children.length,s=0;s<i;s++){var a=this._children[s];a instanceof x.GButton&&!a.selected&&(a.selected=!0,t=s)}-1!=t&&this.updateSelectionController(t)}selectNone(){this.clearSelection()}selectReverse(){this.checkVirtualList();var t=-1;if(this._virtual)for(s=0;s<this._realNumItems;s++){var e=this._virtualItems[s];e.obj instanceof x.GButton&&(e.obj.selected=!e.obj.selected,e.obj.selected)&&(t=s),e.selected=!e.selected}else for(var i=this._children.length,s=0;s<i;s++){var a=this._children[s];a instanceof x.GButton&&(a.selected=!a.selected,a.selected)&&(t=s)}-1!=t&&this.updateSelectionController(t)}handleArrowKey(t){var e=this.selectedIndex;if(-1!=e)switch(t){case 1:if(this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowVertical)0<=--e&&(this.clearSelection(),this.addSelection(e,!0));else if(this._layout==x.ListLayoutType.FlowHorizontal||this._layout==x.ListLayoutType.Pagination){for(var i=this._children[e],s=0,a=e-1;0<=a;a--){var h=this._children[a];if(h.y!=i.y){i=h;break}s++}for(;0<=a;a--)if((h=this._children[a]).y!=i.y){this.clearSelection(),this.addSelection(a+s+1,!0);break}}break;case 3:if(this._layout==x.ListLayoutType.SingleRow||this._layout==x.ListLayoutType.FlowHorizontal||this._layout==x.ListLayoutType.Pagination)++e<this.numItems&&(this.clearSelection(),this.addSelection(e,!0));else if(this._layout==x.ListLayoutType.FlowVertical){for(var i=this._children[e],s=0,r=this._children.length,a=e+1;a<r;a++){if((h=this._children[a]).x!=i.x){i=h;break}s++}for(;a<r;a++)if((h=this._children[a]).x!=i.x){this.clearSelection(),this.addSelection(a-s-1,!0);break}}break;case 5:if(this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowVertical)++e<this.numItems&&(this.clearSelection(),this.addSelection(e,!0));else if(this._layout==x.ListLayoutType.FlowHorizontal||this._layout==x.ListLayoutType.Pagination){for(i=this._children[e],s=0,r=this._children.length,a=e+1;a<r;a++){if((h=this._children[a]).y!=i.y){i=h;break}s++}for(;a<r;a++)if((h=this._children[a]).y!=i.y){this.clearSelection(),this.addSelection(a-s-1,!0);break}}break;case 7:if(this._layout==x.ListLayoutType.SingleRow||this._layout==x.ListLayoutType.FlowHorizontal||this._layout==x.ListLayoutType.Pagination)0<=--e&&(this.clearSelection(),this.addSelection(e,!0));else if(this._layout==x.ListLayoutType.FlowVertical){for(i=this._children[e],s=0,a=e-1;0<=a;a--){if((h=this._children[a]).x!=i.x){i=h;break}s++}for(;0<=a;a--)if((h=this._children[a]).x!=i.x){this.clearSelection(),this.addSelection(a+s+1,!0);break}}}}__clickItem(t){var e;this._scrollPane&&this._scrollPane.isDragged||(e=x.GObject.cast(t.currentTarget),this.setSelectionOnEvent(e,t),this._scrollPane&&this.scrollItemToViewOnClick&&this._scrollPane.scrollToView(e,!0),this.dispatchItemEvent(e,x.Events.createEvent(x.Events.CLICK_ITEM,this.displayObject,t)))}dispatchItemEvent(t,e){this.displayObject.event(x.Events.CLICK_ITEM,[t,e])}setSelectionOnEvent(t,e){if(t instanceof x.GButton&&this._selectionMode!=x.ListSelectionMode.None){var i=!1,s=this.childIndexToItemIndex(this.getChildIndex(t));if(this._selectionMode==x.ListSelectionMode.Single)t.selected||(this.clearSelectionExcept(t),t.selected=!0);else if(e.shiftKey){if(!t.selected)if(-1!=this._lastSelectedIndex){var a,h=Math.min(this._lastSelectedIndex,s),r=Math.max(this._lastSelectedIndex,s),r=Math.min(r,this.numItems-1);if(this._virtual)for(a=h;a<=r;a++){var n=this._virtualItems[a];n.obj instanceof x.GButton&&(n.obj.selected=!0),n.selected=!0}else for(a=h;a<=r;a++){var o=this.getChildAt(a);o instanceof x.GButton&&(o.selected=!0)}i=!0}else t.selected=!0}else e.ctrlKey||this._selectionMode==x.ListSelectionMode.Multiple_SingleClick?t.selected=!t.selected:t.selected?this.clearSelectionExcept(t):(this.clearSelectionExcept(t),t.selected=!0);i||(this._lastSelectedIndex=s),t.selected&&this.updateSelectionController(s)}}resizeToFit(t,e){null==t&&(t=1e5),e=e||0,this.ensureBoundsCorrect();var i=this.numItems;if(i<t&&(t=i),this._virtual){i=Math.ceil(t/this._curLineItemCount);this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowHorizontal?this.viewHeight=i*this._itemSize.y+Math.max(0,i-1)*this._lineGap:this.viewWidth=i*this._itemSize.x+Math.max(0,i-1)*this._columnGap}else if(0==t)this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowHorizontal?this.viewHeight=e:this.viewWidth=e;else{for(var s=t-1,a=null;0<=s&&(a=this.getChildAt(s),this.foldInvisibleItems)&&!a.visible;)s--;s<0?this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowHorizontal?this.viewHeight=e:this.viewWidth=e:(i=0,this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowHorizontal?((i=a.y+a.height)<e&&(i=e),this.viewHeight=i):((i=a.x+a.width)<e&&(i=e),this.viewWidth=i))}}getMaxItemWidth(){for(var t=this._children.length,e=0,i=0;i<t;i++){var s=this.getChildAt(i);s.width>e&&(e=s.width)}return e}handleSizeChanged(){super.handleSizeChanged(),this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0)}handleControllerChanged(t){super.handleControllerChanged(t),this._selectionController==t&&(this.selectedIndex=t.selectedIndex)}updateSelectionController(t){var e;this._selectionController&&!this._selectionController.changing&&t<this._selectionController.pageCount&&(e=this._selectionController,this._selectionController=null,e.selectedIndex=t,this._selectionController=e)}shouldSnapToNext(t,e,i){return t<0&&e>x.UIConfig.defaultScrollSnappingThreshold*i||0<t&&e>(1-x.UIConfig.defaultScrollSnappingThreshold)*i||0==t&&i/2<e}getSnappingPositionWithDir(t,e,i,s,a){var h,r,n;return this._virtual?(a=a||new Laya.Point,this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowHorizontal?(I=h=e,r=this.getIndexOnPos1(!1),e=I,r<this._virtualItems.length&&r<this._realNumItems&&(n=this._virtualItems[r].height,this.shouldSnapToNext(s,h-e,n))&&(e+=n+this._lineGap)):(t=(r=this._layout==x.ListLayoutType.SingleRow||this._layout==x.ListLayoutType.FlowVertical?(I=h=t,this.getIndexOnPos2(!1)):(I=h=t,this.getIndexOnPos3(!1)),I),r<this._virtualItems.length&&r<this._realNumItems&&(n=this._virtualItems[r].width,this.shouldSnapToNext(i,h-t,n))&&(t+=n+this._columnGap)),a.x=t,a.y=e,a):super.getSnappingPositionWithDir(t,e,i,s,a)}scrollToView(t,e,i){if(this._virtual){if(0!=this._numItems){if(this.checkVirtualList(),t>=this._virtualItems.length)throw new Error("Invalid child index: "+t+">"+this._virtualItems.length);this._loop&&(t=Math.floor(this._firstIndex/this._numItems)*this._numItems+t);var s,a=this._virtualItems[t],h=0;if(this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowHorizontal){for(s=this._curLineItemCount-1;s<t;s+=this._curLineItemCount)h+=this._virtualItems[s].height+this._lineGap;n=new Laya.Rectangle(0,h,this._itemSize.x,a.height)}else if(this._layout==x.ListLayoutType.SingleRow||this._layout==x.ListLayoutType.FlowVertical){for(s=this._curLineItemCount-1;s<t;s+=this._curLineItemCount)h+=this._virtualItems[s].width+this._columnGap;n=new Laya.Rectangle(h,0,a.width,this._itemSize.y)}else var r=t/(this._curLineItemCount*this._curLineItemCount2),n=new Laya.Rectangle(r*this.viewWidth+t%this._curLineItemCount*(a.width+this._columnGap),t/this._curLineItemCount%this._curLineItemCount2*(a.height+this._lineGap),a.width,a.height);this._scrollPane&&this._scrollPane.scrollToView(n,e,i)}}else{r=this.getChildAt(t);this._scrollPane?this._scrollPane.scrollToView(r,e,i):this._parent&&this._parent.scrollPane&&this._parent.scrollPane.scrollToView(r,e,i)}}getFirstChildInView(){return this.childIndexToItemIndex(super.getFirstChildInView())}childIndexToItemIndex(t){if(this._virtual)if(this._layout==x.ListLayoutType.Pagination){for(var e=this._firstIndex;e<this._realNumItems;e++)if(this._virtualItems[e].obj&&--t<0)return e}else t+=this._firstIndex,this._loop&&0<this._numItems&&(t%=this._numItems);return t}itemIndexToChildIndex(t){var e;return this._virtual?this._layout==x.ListLayoutType.Pagination?this.getChildIndex(this._virtualItems[t].obj):(this._loop&&0<this._numItems?(e=this._firstIndex%this._numItems)<=t?t-=e:t=this._numItems-e+t:t-=this._firstIndex,t):t}setVirtual(){this._setVirtual(!1)}setVirtualAndLoop(){this._setVirtual(!0)}_setVirtual(t){if(!this._virtual){if(null==this._scrollPane)throw new Error("Virtual list must be scrollable!");if(t){if(this._layout==x.ListLayoutType.FlowHorizontal||this._layout==x.ListLayoutType.FlowVertical)throw new Error("Loop list instanceof not supported for FlowHorizontal or FlowVertical this.layout!");this._scrollPane.bouncebackEffect=!1}if(this._virtual=!0,this._loop=t,this._virtualItems=new Array,this.removeChildrenToPool(),null==this._itemSize){this._itemSize=new Laya.Point;t=this.getFromPool(null);if(null==t)throw new Error("Virtual List must have a default list item resource.");this._itemSize.x=t.width,this._itemSize.y=t.height,this.returnToPool(t)}this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowHorizontal?(this._scrollPane.scrollStep=this._itemSize.y,this._loop&&(this._scrollPane._loop=2)):(this._scrollPane.scrollStep=this._itemSize.x,this._loop&&(this._scrollPane._loop=1)),this.on(x.Events.SCROLL,this,this.__scrolled),this.setVirtualListChangedFlag(!0)}}get numItems(){return this._virtual?this._numItems:this._children.length}set numItems(t){var e;if(this._virtual){if(null==this.itemRenderer)throw new Error("set itemRenderer first!");this._numItems=t,this._loop?this._realNumItems=6*this._numItems:this._realNumItems=this._numItems;var i=this._virtualItems.length;if(this._realNumItems>i)for(e=i;e<this._realNumItems;e++){var s={width:this._itemSize.x,height:this._itemSize.y,updateFlag:0};this._virtualItems.push(s)}else for(e=this._realNumItems;e<i;e++)this._virtualItems[e].selected=!1;0!=this._virtualListChanged&&Laya.timer.clear(this,this._refreshVirtualList),this._refreshVirtualList()}else{var a=this._children.length;if(a<t)for(e=a;e<t;e++)null==this.itemProvider?this.addItemFromPool():this.addItemFromPool(this.itemProvider.runWith(e));else this.removeChildrenToPool(t,a);if(null!=this.itemRenderer)for(e=0;e<t;e++)this.itemRenderer.runWith([e,this.getChildAt(e)])}}refreshVirtualList(){this.setVirtualListChangedFlag(!1)}checkVirtualList(){0!=this._virtualListChanged&&(this._refreshVirtualList(),Laya.timer.clear(this,this._refreshVirtualList))}setVirtualListChangedFlag(t){t?this._virtualListChanged=2:0==this._virtualListChanged&&(this._virtualListChanged=1),Laya.timer.callLater(this,this._refreshVirtualList)}_refreshVirtualList(){if(this._displayObject){var t=2==this._virtualListChanged,e=(this._virtualListChanged=0,this._eventLocked=!0,t&&(this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.SingleRow?this._curLineItemCount=1:this._layout==x.ListLayoutType.FlowHorizontal?0<this._columnCount?this._curLineItemCount=this._columnCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):this._layout==x.ListLayoutType.FlowVertical?0<this._lineCount?this._curLineItemCount=this._lineCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):(0<this._columnCount?this._curLineItemCount=this._columnCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)),0<this._lineCount?this._curLineItemCount2=this._lineCount:(this._curLineItemCount2=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount2<=0&&(this._curLineItemCount2=1)))),0),i=0;if(0<this._realNumItems){var s,a=Math.ceil(this._realNumItems/this._curLineItemCount)*this._curLineItemCount,h=Math.min(this._curLineItemCount,this._realNumItems);if(this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowHorizontal){for(s=0;s<a;s+=this._curLineItemCount)e+=this._virtualItems[s].height+this._lineGap;if(0<e&&(e-=this._lineGap),this._autoResizeItem)i=this._scrollPane.viewWidth;else{for(s=0;s<h;s++)i+=this._virtualItems[s].width+this._columnGap;0<i&&(i-=this._columnGap)}}else if(this._layout==x.ListLayoutType.SingleRow||this._layout==x.ListLayoutType.FlowVertical){for(s=0;s<a;s+=this._curLineItemCount)i+=this._virtualItems[s].width+this._columnGap;if(0<i&&(i-=this._columnGap),this._autoResizeItem)e=this._scrollPane.viewHeight;else{for(s=0;s<h;s++)e+=this._virtualItems[s].height+this._lineGap;0<e&&(e-=this._lineGap)}}else i=Math.ceil(a/(this._curLineItemCount*this._curLineItemCount2))*this.viewWidth,e=this.viewHeight}this.handleAlign(i,e),this._scrollPane.setContentSize(i,e),this._eventLocked=!1,this.handleScroll(!0)}}__scrolled(t){this.handleScroll(!1)}getIndexOnPos1(t){if(this._realNumItems<this._curLineItemCount)return I=0;var e,i,s;if(0<this.numChildren&&!t){if(i=this.getChildAt(0).y,I<i){for(e=this._firstIndex-this._curLineItemCount;0<=e;e-=this._curLineItemCount)if((i-=this._virtualItems[e].height+this._lineGap)<=I)return I=i,e;return I=0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if(s=i+this._virtualItems[e].height+this._lineGap,I<s)return I=i,e;i=s}}else for(e=i=0;e<this._realNumItems;e+=this._curLineItemCount){if(s=i+this._virtualItems[e].height+this._lineGap,I<s)return I=i,e;i=s}return I=i,this._realNumItems-this._curLineItemCount}getIndexOnPos2(t){if(this._realNumItems<this._curLineItemCount)return I=0;var e,i,s;if(0<this.numChildren&&!t){if(i=this.getChildAt(0).x,I<i){for(e=this._firstIndex-this._curLineItemCount;0<=e;e-=this._curLineItemCount)if((i-=this._virtualItems[e].width+this._columnGap)<=I)return I=i,e;return I=0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if(s=i+this._virtualItems[e].width+this._columnGap,I<s)return I=i,e;i=s}}else for(e=i=0;e<this._realNumItems;e+=this._curLineItemCount){if(s=i+this._virtualItems[e].width+this._columnGap,I<s)return I=i,e;i=s}return I=i,this._realNumItems-this._curLineItemCount}getIndexOnPos3(t){if(this._realNumItems<this._curLineItemCount)return I=0;for(var e,i=this.viewWidth,s=Math.floor(I/i),a=s*(this._curLineItemCount*this._curLineItemCount2),h=s*i,r=0;r<this._curLineItemCount;r++){if(e=h+this._virtualItems[a+r].width+this._columnGap,I<e)return I=h,a+r;h=e}return I=h,a+this._curLineItemCount-1}handleScroll(t){if(!this._eventLocked){if(this._layout==x.ListLayoutType.SingleColumn||this._layout==x.ListLayoutType.FlowHorizontal){for(var e=0;this.handleScroll1(t);)if(t=!1,20<++e){console.log("FairyGUI: list will never be <the> filled item renderer function always returns a different size.");break}this.handleArchOrder1()}else if(this._layout==x.ListLayoutType.SingleRow||this._layout==x.ListLayoutType.FlowVertical){for(e=0;this.handleScroll2(t);)if(t=!1,20<++e){console.log("FairyGUI: list will never be <the> filled item renderer function always returns a different size.");break}this.handleArchOrder2()}else this.handleScroll3(t);this._boundsChanged=!1}}handleScroll1(t){var e=(a=this._scrollPane.scrollingPosY)+this._scrollPane.viewHeight,i=e==this._scrollPane.contentHeight,s=(I=a,this.getIndexOnPos1(t)),a=I;if(s==this._firstIndex&&!t)return!1;var h,r,n,o,l,_=this._firstIndex,d=this._firstIndex=s,c=s<_,u=this.numChildren,g=_+u-1,p=c?g:_,y=0,f=a,m=0,w=0,v=this._defaultItem,C=(this._scrollPane.viewWidth-this._columnGap*(this._curLineItemCount-1))/this._curLineItemCount;for(this.itemInfoVer++;d<this._realNumItems&&(i||f<e);){if((null==(r=this._virtualItems[d]).obj||t)&&(null!=this.itemProvider&&(null==(v=this.itemProvider.runWith(d%this._numItems))&&(v=this._defaultItem),v=x.UIPackage.normalizeURL(v)),r.obj)&&r.obj.resourceURL!=v&&(r.obj instanceof x.GButton&&(r.selected=r.obj.selected),this.removeChildToPool(r.obj),r.obj=null),null==r.obj){if(c){for(l=p;_<=l;l--)if((n=this._virtualItems[l]).obj&&n.updateFlag!=this.itemInfoVer&&n.obj.resourceURL==v){n.obj instanceof x.GButton&&(n.selected=n.obj.selected),r.obj=n.obj,n.obj=null,l==p&&p--;break}}else for(l=p;l<=g;l++)if((n=this._virtualItems[l]).obj&&n.updateFlag!=this.itemInfoVer&&n.obj.resourceURL==v){n.obj instanceof x.GButton&&(n.selected=n.obj.selected),r.obj=n.obj,n.obj=null,l==p&&p++;break}r.obj?this.setChildIndex(r.obj,c?d-s:this.numChildren):(r.obj=this._pool.getObject(v),c?this.addChildAt(r.obj,d-s):this.addChild(r.obj)),r.obj instanceof x.GButton&&(r.obj.selected=r.selected),h=!0}else h=t;h&&(this._autoResizeItem&&(this._layout==x.ListLayoutType.SingleColumn||0<this._columnCount)&&r.obj.setSize(C,r.obj.height,!0),this.itemRenderer.runWith([d%this._numItems,r.obj]),d%this._curLineItemCount==0&&(m+=Math.ceil(r.obj.height)-r.height,d==s)&&s<_&&(w=Math.ceil(r.obj.height)-r.height),r.width=Math.ceil(r.obj.width),r.height=Math.ceil(r.obj.height)),r.updateFlag=this.itemInfoVer,r.obj.setXY(y,f),d==s&&(e+=r.height),y+=r.width+this._columnGap,d%this._curLineItemCount==this._curLineItemCount-1&&(y=0,f+=r.height+this._lineGap),d++}for(o=0;o<u;o++)(r=this._virtualItems[_+o]).updateFlag!=this.itemInfoVer&&r.obj&&(r.obj instanceof x.GButton&&(r.selected=r.obj.selected),this.removeChildToPool(r.obj),r.obj=null);for(u=this._children.length,o=0;o<u;o++){var b=this._virtualItems[s+o].obj;this._children[o]!=b&&this.setChildIndex(b,o)}return 0==m&&0==w||this._scrollPane.changeContentSizeOnScrolling(0,m,0,w),0<d&&0<this.numChildren&&this._container.y<=0&&this.getChildAt(0).y>-this._container.y}handleScroll2(t){var e=(a=this._scrollPane.scrollingPosX)+this._scrollPane.viewWidth,i=a==this._scrollPane.contentWidth,s=(I=a,this.getIndexOnPos2(t)),a=I;if(s==this._firstIndex&&!t)return!1;var h,r,n,o,l,_=this._firstIndex,d=this._firstIndex=s,c=s<_,u=this.numChildren,g=_+u-1,p=c?g:_,y=a,f=0,m=0,w=0,v=this._defaultItem,C=(this._scrollPane.viewHeight-this._lineGap*(this._curLineItemCount-1))/this._curLineItemCount;for(this.itemInfoVer++;d<this._realNumItems&&(i||y<e);){if((null==(r=this._virtualItems[d]).obj||t)&&(null!=this.itemProvider&&(null==(v=this.itemProvider.runWith(d%this._numItems))&&(v=this._defaultItem),v=x.UIPackage.normalizeURL(v)),r.obj)&&r.obj.resourceURL!=v&&(r.obj instanceof x.GButton&&(r.selected=r.obj.selected),this.removeChildToPool(r.obj),r.obj=null),null==r.obj){if(c){for(l=p;_<=l;l--)if((n=this._virtualItems[l]).obj&&n.updateFlag!=this.itemInfoVer&&n.obj.resourceURL==v){n.obj instanceof x.GButton&&(n.selected=n.obj.selected),r.obj=n.obj,n.obj=null,l==p&&p--;break}}else for(l=p;l<=g;l++)if((n=this._virtualItems[l]).obj&&n.updateFlag!=this.itemInfoVer&&n.obj.resourceURL==v){n.obj instanceof x.GButton&&(n.selected=n.obj.selected),r.obj=n.obj,n.obj=null,l==p&&p++;break}r.obj?this.setChildIndex(r.obj,c?d-s:this.numChildren):(r.obj=this._pool.getObject(v),c?this.addChildAt(r.obj,d-s):this.addChild(r.obj)),r.obj instanceof x.GButton&&(r.obj.selected=r.selected),h=!0}else h=t;h&&(this._autoResizeItem&&(this._layout==x.ListLayoutType.SingleRow||0<this._lineCount)&&r.obj.setSize(r.obj.width,C,!0),this.itemRenderer.runWith([d%this._numItems,r.obj]),d%this._curLineItemCount==0&&(m+=Math.ceil(r.obj.width)-r.width,d==s)&&s<_&&(w=Math.ceil(r.obj.width)-r.width),r.width=Math.ceil(r.obj.width),r.height=Math.ceil(r.obj.height)),r.updateFlag=this.itemInfoVer,r.obj.setXY(y,f),d==s&&(e+=r.width),f+=r.height+this._lineGap,d%this._curLineItemCount==this._curLineItemCount-1&&(f=0,y+=r.width+this._columnGap),d++}for(o=0;o<u;o++)(r=this._virtualItems[_+o]).updateFlag!=this.itemInfoVer&&r.obj&&(r.obj instanceof x.GButton&&(r.selected=r.obj.selected),this.removeChildToPool(r.obj),r.obj=null);for(u=this._children.length,o=0;o<u;o++){var b=this._virtualItems[s+o].obj;this._children[o]!=b&&this.setChildIndex(b,o)}return 0==m&&0==w||this._scrollPane.changeContentSizeOnScrolling(m,0,w,0),0<d&&0<this.numChildren&&this._container.x<=0&&this.getChildAt(0).x>-this._container.x}handleScroll3(t){var e=this._scrollPane.scrollingPosX,e=(I=e,this.getIndexOnPos3(t));if(e!=this._firstIndex||t){var i,s,a,h,r=this._firstIndex,n=(this._firstIndex=e,r),o=this._virtualItems.length,l=this._curLineItemCount*this._curLineItemCount2,_=e%this._curLineItemCount,d=this.viewWidth,c=Math.floor(e/l)*l,u=c+2*l,g=this._defaultItem,p=(this._scrollPane.viewWidth-this._columnGap*(this._curLineItemCount-1))/this._curLineItemCount,y=(this._scrollPane.viewHeight-this._lineGap*(this._curLineItemCount2-1))/this._curLineItemCount2;for(this.itemInfoVer++,w=c;w<u;w++)if(!(w>=this._realNumItems)){if(h=w%this._curLineItemCount,w-c<l){if(h<_)continue}else if(_<h)continue;(s=this._virtualItems[w]).updateFlag=this.itemInfoVer}for(var f=null,m=0,w=c;w<u;w++)if(!(w>=this._realNumItems)&&(s=this._virtualItems[w]).updateFlag==this.itemInfoVer){if(null==s.obj){for(;n<o;){if((a=this._virtualItems[n]).obj&&a.updateFlag!=this.itemInfoVer){a.obj instanceof x.GButton&&(a.selected=a.obj.selected),s.obj=a.obj,a.obj=null;break}n++}-1==m&&(m=this.getChildIndex(f)+1),null==s.obj?(null!=this.itemProvider&&(null==(g=this.itemProvider.runWith(w%this._numItems))&&(g=this._defaultItem),g=x.UIPackage.normalizeURL(g)),s.obj=this._pool.getObject(g),this.addChildAt(s.obj,m)):m=this.setChildIndexBefore(s.obj,m),m++,s.obj instanceof x.GButton&&(s.obj.selected=s.selected),i=!0}else i=t,m=-1,f=s.obj;i&&(this._autoResizeItem&&(this._curLineItemCount==this._columnCount&&this._curLineItemCount2==this._lineCount?s.obj.setSize(p,y,!0):this._curLineItemCount==this._columnCount?s.obj.setSize(p,s.obj.height,!0):this._curLineItemCount2==this._lineCount&&s.obj.setSize(s.obj.width,y,!0)),this.itemRenderer.runWith([w%this._numItems,s.obj]),s.width=Math.ceil(s.obj.width),s.height=Math.ceil(s.obj.height))}var v=c/l*d,C=v,b=0,S=0;for(w=c;w<u;w++)w>=this._realNumItems||((s=this._virtualItems[w]).updateFlag==this.itemInfoVer&&s.obj.setXY(C,b),s.height>S&&(S=s.height),w%this._curLineItemCount==this._curLineItemCount-1?(C=v,b+=S+this._lineGap,S=0,w==c+l-1&&(C=v+=d,b=0)):C+=s.width+this._columnGap);for(w=n;w<o;w++)(s=this._virtualItems[w]).updateFlag!=this.itemInfoVer&&s.obj&&(s.obj instanceof x.GButton&&(s.selected=s.obj.selected),this.removeChildToPool(s.obj),s.obj=null)}}handleArchOrder1(){if(this.childrenRenderOrder==x.ChildrenRenderOrder.Arch){for(var t=this._scrollPane.posY+this.viewHeight/2,e=Number.POSITIVE_INFINITY,i=0,s=this.numChildren,a=0;a<s;a++){var h=this.getChildAt(a);this.foldInvisibleItems&&!h.visible||(h=Math.abs(t-h.y-h.height/2))<e&&(e=h,i=a)}this.apexIndex=i}}handleArchOrder2(){if(this.childrenRenderOrder==x.ChildrenRenderOrder.Arch){for(var t=this._scrollPane.posX+this.viewWidth/2,e=Number.POSITIVE_INFINITY,i=0,s=this.numChildren,a=0;a<s;a++){var h=this.getChildAt(a);this.foldInvisibleItems&&!h.visible||(h=Math.abs(t-h.x-h.width/2))<e&&(e=h,i=a)}this.apexIndex=i}}handleAlign(t,e){var i=0,s=0;e<this.viewHeight&&("middle"==this._verticalAlign?s=Math.floor((this.viewHeight-e)/2):"bottom"==this._verticalAlign&&(s=this.viewHeight-e)),t<this.viewWidth&&("center"==this._align?i=Math.floor((this.viewWidth-t)/2):"right"==this._align&&(i=this.viewWidth-t)),i==this._alignOffset.x&&s==this._alignOffset.y||(this._alignOffset.setTo(i,s),this._scrollPane?this._scrollPane.adjustMaskContainer():this._container.pos(this._margin.left+this._alignOffset.x,this._margin.top+this._alignOffset.y))}updateBounds(){if(!this._virtual){var t,e,i,s,a,h,r=0,n=0,o=0,l=0,_=0,d=0,c=0,u=this._children.length,g=this.viewWidth,p=this.viewHeight,y=0,f=0;if(this._layout==x.ListLayoutType.SingleColumn){for(t=0;t<u;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=n&&(n+=this._lineGap),e.y=n,this._autoResizeItem&&e.setSize(g,e.height,!0),n+=Math.ceil(e.height),e.width>o&&(o=e.width));if((s=n)<=p&&this._autoResizeItem&&this._scrollPane&&this._scrollPane._displayInDemand&&this._scrollPane.vtScrollBar)for(g+=this._scrollPane.vtScrollBar.width,t=0;t<u;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(e.setSize(g,e.height,!0),e.width>o&&(o=e.width));i=Math.ceil(o)}else if(this._layout==x.ListLayoutType.SingleRow){for(t=0;t<u;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=r&&(r+=this._columnGap),e.x=r,this._autoResizeItem&&e.setSize(e.width,p,!0),r+=Math.ceil(e.width),e.height>l&&(l=e.height));if((i=r)<=g&&this._autoResizeItem&&this._scrollPane&&this._scrollPane._displayInDemand&&this._scrollPane.hzScrollBar)for(p+=this._scrollPane.hzScrollBar.height,t=0;t<u;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(e.setSize(e.width,p,!0),e.height>l&&(l=e.height));s=Math.ceil(l)}else if(this._layout==x.ListLayoutType.FlowHorizontal)if(this._autoResizeItem&&0<this._columnCount){for(t=0;t<u;t++)if(e=this.getChildAt(t),(!this.foldInvisibleItems||e.visible)&&(y+=e.sourceWidth,++_==this._columnCount||t==u-1)){for(a=(g-y-(_-1)*this._columnGap)/y,r=0,_=f;_<=t;_++)e=this.getChildAt(_),this.foldInvisibleItems&&!e.visible||(e.setXY(r,n),_<t?(e.setSize(e.sourceWidth+Math.round(e.sourceWidth*a),e.height,!0),r+=Math.ceil(e.width)+this._columnGap):e.setSize(g-r,e.height,!0),e.height>l&&(l=e.height));n+=Math.ceil(l)+this._lineGap,f=t+1,y=_=l=0}s=n+Math.ceil(l),i=g}else{for(t=0;t<u;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=r&&(r+=this._columnGap),(0!=this._columnCount&&_>=this._columnCount||0==this._columnCount&&r+e.width>g&&0!=l)&&(r=0,n+=Math.ceil(l)+this._lineGap,_=l=0),e.setXY(r,n),o<(r+=Math.ceil(e.width))&&(o=r),e.height>l&&(l=e.height),_++);s=n+Math.ceil(l),i=Math.ceil(o)}else if(this._layout==x.ListLayoutType.FlowVertical)if(this._autoResizeItem&&0<this._lineCount){for(t=0;t<u;t++)if(e=this.getChildAt(t),(!this.foldInvisibleItems||e.visible)&&(y+=e.sourceHeight,++_==this._lineCount||t==u-1)){for(a=(p-y-(_-1)*this._lineGap)/y,n=0,_=f;_<=t;_++)e=this.getChildAt(_),this.foldInvisibleItems&&!e.visible||(e.setXY(r,n),_<t?(e.setSize(e.width,e.sourceHeight+Math.round(e.sourceHeight*a),!0),n+=Math.ceil(e.height)+this._lineGap):e.setSize(e.width,p-n,!0),e.width>o&&(o=e.width));r+=Math.ceil(o)+this._columnGap,f=t+1,y=_=o=0}i=r+Math.ceil(o),s=p}else{for(t=0;t<u;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=n&&(n+=this._lineGap),(0!=this._lineCount&&_>=this._lineCount||0==this._lineCount&&n+e.height>p&&0!=o)&&(n=0,r+=Math.ceil(o)+this._columnGap,_=o=0),e.setXY(r,n),l<(n+=Math.ceil(e.height))&&(l=n),e.width>o&&(o=e.width),_++);i=r+Math.ceil(o),s=Math.ceil(l)}else{if(this._autoResizeItem&&0<this._lineCount&&(h=Math.floor((p-(this._lineCount-1)*this._lineGap)/this._lineCount)),this._autoResizeItem&&0<this._columnCount){for(t=0;t<u;t++)if(e=this.getChildAt(t),(!this.foldInvisibleItems||e.visible)&&(0==_&&(0!=this._lineCount&&c>=this._lineCount||0==this._lineCount&&n+e.height>p)&&(d++,c=n=0),y+=e.sourceWidth,++_==this._columnCount||t==u-1)){for(a=(g-y-(_-1)*this._columnGap)/y,r=0,_=f;_<=t;_++)e=this.getChildAt(_),this.foldInvisibleItems&&!e.visible||(e.setXY(d*g+r,n),_<t?(e.setSize(e.sourceWidth+Math.round(e.sourceWidth*a),0<this._lineCount?h:e.height,!0),r+=Math.ceil(e.width)+this._columnGap):e.setSize(g-r,0<this._lineCount?h:e.height,!0),e.height>l&&(l=e.height));n+=Math.ceil(l)+this._lineGap,f=t+1,y=_=l=0,c++}}else for(t=0;t<u;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=r&&(r+=this._columnGap),this._autoResizeItem&&0<this._lineCount&&e.setSize(e.width,h,!0),(0!=this._columnCount&&_>=this._columnCount||0==this._columnCount&&r+e.width>g&&0!=l)&&(r=0,n+=Math.ceil(l)+this._lineGap,c++,(_=l=0)!=this._lineCount&&c>=this._lineCount||0==this._lineCount&&n+e.height>p&&0!=o)&&(d++,c=n=0),e.setXY(d*g+r,n),o<(r+=Math.ceil(e.width))&&(o=r),e.height>l&&(l=e.height),_++);s=0<d?p:n+Math.ceil(l),i=(d+1)*g}this.handleAlign(i,s),this.setBounds(0,0,i,s)}}setup_beforeAdd(t,e){super.setup_beforeAdd(t,e),t.seek(e,5),this._layout=t.readByte(),this._selectionMode=t.readByte(),s=t.readByte(),this._align=0==s?"left":1==s?"center":"right",s=t.readByte(),this._verticalAlign=0==s?"top":1==s?"middle":"bottom",this._lineGap=t.getInt16(),this._columnGap=t.getInt16(),this._lineCount=t.getInt16(),this._columnCount=t.getInt16(),this._autoResizeItem=t.readBool(),this._childrenRenderOrder=t.readByte(),this._apexIndex=t.getInt16(),t.readBool()&&(this._margin.top=t.getInt32(),this._margin.bottom=t.getInt32(),this._margin.left=t.getInt32(),this._margin.right=t.getInt32());var i,s=t.readByte();s==x.OverflowType.Scroll?(i=t.pos,t.seek(e,7),this.setupScroll(t),t.pos=i):this.setupOverflow(s),t.readBool()&&t.skip(8),2<=t.version&&(this.scrollItemToViewOnClick=t.readBool(),this.foldInvisibleItems=t.readBool()),t.seek(e,8),this._defaultItem=t.readS(),this.readItems(t)}readItems(t){for(var e=t.getInt16(),i=0;i<e;i++){var s,a=t.getInt16();a+=t.pos,null!=(s=t.readS())||(s=this._defaultItem)?((s=this.getFromPool(s))&&(this.addChild(s),this.setupItem(t,s)),t.pos=a):t.pos=a}}setupItem(t,e){var i,s;if(null!=(h=t.readS())&&(e.text=h),null!=(h=t.readS())&&e instanceof x.GButton&&(e.selectedTitle=h),null!=(h=t.readS())&&(e.icon=h),null!=(h=t.readS())&&e instanceof x.GButton&&(e.selectedIcon=h),null!=(h=t.readS())&&(e.name=h),e instanceof x.GComponent){for(i=t.getInt16(),s=0;s<i;s++){var a=e.getController(t.readS()),h=t.readS();a&&(a.selectedPageId=h)}if(2<=t.version)for(i=t.getInt16(),s=0;s<i;s++){var r=t.readS(),n=t.getInt16(),o=t.readS(),r=e.getChildByPath(r);r&&r.setProp(n,o)}}}setup_afterAdd(t,e){super.setup_afterAdd(t,e),t.seek(e,6);e=t.getInt16();-1!=e&&(this._selectionController=this._parent.getControllerAt(e))}}x.GList=t;var I=0}(fgui),function(i){i.GObjectPool=class{constructor(){this._count=0,this._pool={}}clear(){for(var t in this._pool)for(var e=this._pool[t],i=e.length,s=0;s<i;s++)e[s].dispose();this._pool={},this._count=0}get count(){return this._count}getObject(t){var e;return null==(t=i.UIPackage.normalizeURL(t))?null:(e=this._pool[t])&&0<e.length?(this._count--,e.shift()):i.UIPackage.createObjectFromURL(t)}returnObject(t){var e,i=t.resourceURL;i&&(null==(e=this._pool[i])&&(this._pool[i]=e=[]),this._count++,e.push(t))}}}(fgui),function(a){class t extends a.GObject{constructor(){super(),this._url="",this._fill=a.LoaderFillType.None,this._align="left",this._valign="top",this._showErrorSign=!0}createDisplayObject(){super.createDisplayObject(),this._content=new a.MovieClip,this._displayObject.addChild(this._content),this._displayObject.mouseEnabled=!0}dispose(){!this._contentItem&&this._content.texture&&this.freeExternal(this._content.texture),this._content2&&this._content2.dispose(),super.dispose()}get url(){return this._url}set url(t){this._url!=t&&(this._url=t,this.loadContent(),this.updateGear(7))}get icon(){return this._url}set icon(t){this.url=t}get align(){return this._align}set align(t){this._align!=t&&(this._align=t,this.updateLayout())}get verticalAlign(){return this._valign}set verticalAlign(t){this._valign!=t&&(this._valign=t,this.updateLayout())}get fill(){return this._fill}set fill(t){this._fill!=t&&(this._fill=t,this.updateLayout())}get shrinkOnly(){return this._shrinkOnly}set shrinkOnly(t){this._shrinkOnly!=t&&(this._shrinkOnly=t,this.updateLayout())}get autoSize(){return this._autoSize}set autoSize(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())}get playing(){return this._content.playing}set playing(t){this._content.playing!=t&&(this._content.playing=t,this.updateGear(5))}get frame(){return this._content.frame}set frame(t){this._content.frame!=t&&(this._content.frame=t,this.updateGear(5))}get color(){return this._content.color}set color(t){this._content.color!=t&&(this._content.color=t,this.updateGear(4))}get fillMethod(){return this._content.fillMethod}set fillMethod(t){this._content.fillMethod=t}get fillOrigin(){return this._content.fillOrigin}set fillOrigin(t){this._content.fillOrigin=t}get fillClockwise(){return this._content.fillClockwise}set fillClockwise(t){this._content.fillClockwise=t}get fillAmount(){return this._content.fillAmount}set fillAmount(t){this._content.fillAmount=t}get showErrorSign(){return this._showErrorSign}set showErrorSign(t){this._showErrorSign=t}get content(){return this._content}get component(){return this._content2}loadContent(){this.clearContent(),this._url&&(a.ToolSet.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())}loadFromPackage(t){this._contentItem=a.UIPackage.getItemByURL(t),this._contentItem?(this._contentItem=this._contentItem.getBranch(),this.sourceWidth=this._contentItem.width,this.sourceHeight=this._contentItem.height,this._contentItem=this._contentItem.getHighResolution(),this._contentItem.load(),this._autoSize&&this.setSize(this.sourceWidth,this.sourceHeight),this._contentItem.type==a.PackageItemType.Image?this._contentItem.texture?(this._content.texture=this._contentItem.texture,this._content.scale9Grid=this._contentItem.scale9Grid,this._content.scaleByTile=this._contentItem.scaleByTile,this._content.tileGridIndice=this._contentItem.tileGridIndice,this.sourceWidth=this._contentItem.width,this.sourceHeight=this._contentItem.height,this.updateLayout()):this.setErrorState():this._contentItem.type==a.PackageItemType.MovieClip?(this.sourceWidth=this._contentItem.width,this.sourceHeight=this._contentItem.height,this._content.interval=this._contentItem.interval,this._content.swing=this._contentItem.swing,this._content.repeatDelay=this._contentItem.repeatDelay,this._content.frames=this._contentItem.frames,this.updateLayout()):this._contentItem.type==a.PackageItemType.Component&&(t=a.UIPackage.createObjectFromURL(t))?t instanceof a.GComponent?(this._content2=t.asCom,this._displayObject.addChild(this._content2.displayObject),this.updateLayout()):(t.dispose(),this.setErrorState()):this.setErrorState()):this.setErrorState()}loadExternal(){a.AssetProxy.inst.load(this._url,Laya.Handler.create(this,this.__getResCompleted),null,Laya.Loader.IMAGE)}freeExternal(t){}onExternalLoadSuccess(t){this._content.texture=t,this._content.scale9Grid=null,this._content.scaleByTile=!1,this.sourceWidth=t.width,this.sourceHeight=t.height,this.updateLayout()}onExternalLoadFailed(){this.setErrorState()}__getResCompleted(t){null!=t?this.onExternalLoadSuccess(t):this.onExternalLoadFailed()}setErrorState(){this._showErrorSign&&(this._errorSign||null!=a.UIConfig.loaderErrorSign&&(this._errorSign=t._errorSignPool.getObject(a.UIConfig.loaderErrorSign)),this._errorSign)&&(this._errorSign.setSize(this.width,this.height),this._displayObject.addChild(this._errorSign.displayObject))}clearErrorState(){this._errorSign&&(this._displayObject.removeChild(this._errorSign.displayObject),t._errorSignPool.returnObject(this._errorSign),this._errorSign=null)}updateLayout(){if(this._content2||this._content.texture||this._content.frames){let t=this.sourceWidth,e=this.sourceHeight;var i,s;this._autoSize&&(this._updatingLayout=!0,0==t&&(t=50),0==e&&(e=30),this.setSize(t,e),this._updatingLayout=!1,t==this._width)&&e==this._height?this._content2?(this._content2.setXY(0,0),this._content2.setScale(1,1)):(this._content.size(t,e),this._content.pos(0,0)):(s=i=1,this._fill!=a.LoaderFillType.None&&(i=this.width/this.sourceWidth,s=this.height/this.sourceHeight,1==i&&1==s||(this._fill==a.LoaderFillType.ScaleMatchHeight?i=s:this._fill==a.LoaderFillType.ScaleMatchWidth?s=i:this._fill==a.LoaderFillType.Scale?s<i?i=s:s=i:this._fill==a.LoaderFillType.ScaleNoBorder&&(s<i?s=i:i=s),this._shrinkOnly&&(1<i&&(i=1),1<s)&&(s=1),t=this.sourceWidth*i,e=this.sourceHeight*s)),this._content2?this._content2.setScale(i,s):this._content.size(t,e),i="center"==this._align?Math.floor((this.width-t)/2):"right"==this._align?this.width-t:0,s="middle"==this._valign?Math.floor((this.height-e)/2):"bottom"==this._valign?this.height-e:0,this._content2?this._content2.setXY(i,s):this._content.pos(i,s))}else this._autoSize&&(this._updatingLayout=!0,this.setSize(50,30),this._updatingLayout=!1)}clearContent(){this.clearErrorState(),!this._contentItem&&this._content.texture&&this.freeExternal(this._content.texture),this._content.texture=null,this._content.frames=null,this._content2&&(this._content2.dispose(),this._content2=null),this._contentItem=null}handleSizeChanged(){super.handleSizeChanged(),this._updatingLayout||this.updateLayout()}getProp(t){switch(t){case a.ObjectPropID.Color:return this.color;case a.ObjectPropID.Playing:return this.playing;case a.ObjectPropID.Frame:return this.frame;case a.ObjectPropID.TimeScale:return this._content.timeScale;default:return super.getProp(t)}}setProp(t,e){switch(t){case a.ObjectPropID.Color:this.color=e;break;case a.ObjectPropID.Playing:this.playing=e;break;case a.ObjectPropID.Frame:this.frame=e;break;case a.ObjectPropID.TimeScale:this._content.timeScale=e;break;case a.ObjectPropID.DeltaTime:this._content.advance(e);break;default:super.setProp(t,e)}}setup_beforeAdd(t,e){super.setup_beforeAdd(t,e),t.seek(e,5),this._url=t.readS(),e=t.readByte(),this._align=0==e?"left":1==e?"center":"right",e=t.readByte(),this._valign=0==e?"top":1==e?"middle":"bottom",this._fill=t.readByte(),this._shrinkOnly=t.readBool(),this._autoSize=t.readBool(),this._showErrorSign=t.readBool(),this._content.playing=t.readBool(),this._content.frame=t.getInt32(),t.readBool()&&(this.color=t.readColorS()),this._content.fillMethod=t.readByte(),0!=this._content.fillMethod&&(this._content.fillOrigin=t.readByte(),this._content.fillClockwise=t.readBool(),this._content.fillAmount=t.getFloat32()),this._url&&this.loadContent()}}t._errorSignPool=new a.GObjectPool,a.GLoader=t}(fgui),function(a){class t extends a.GObject{constructor(){super(),this._frame=0,this._playing=!0,this._url="",this._fill=a.LoaderFillType.None,this._align=a.AlignType.Left,this._verticalAlign=a.VertAlignType.Top,this._color="#FFFFFF"}createDisplayObject(){super.createDisplayObject(),this._container=new Laya.Sprite,this._displayObject.addChild(this._container)}dispose(){super.dispose()}get url(){return this._url}set url(t){this._url!=t&&(this._url=t,this.loadContent(),this.updateGear(7))}get icon(){return this._url}set icon(t){this.url=t}get align(){return this._align}set align(t){this._align!=t&&(this._align=t,this.updateLayout())}get verticalAlign(){return this._verticalAlign}set verticalAlign(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.updateLayout())}get fill(){return this._fill}set fill(t){this._fill!=t&&(this._fill=t,this.updateLayout())}get shrinkOnly(){return this._shrinkOnly}set shrinkOnly(t){this._shrinkOnly!=t&&(this._shrinkOnly=t,this.updateLayout())}get autoSize(){return this._autoSize}set autoSize(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())}get playing(){return this._playing}set playing(t){this._playing!=t&&(this._playing=t,this.updateGear(5),this.onChange())}get frame(){return this._frame}set frame(t){this._frame!=t&&(this._frame=t,this.updateGear(5),this.onChange())}get animationName(){return this._animationName}set animationName(t){this._animationName!=t&&(this._animationName=t,this.onChange())}get skinName(){return this._skinName}set skinName(t){this._skinName!=t&&(this._skinName=t,this.onChange())}get loop(){return this._loop}set loop(t){this._loop!=t&&(this._loop=t,this.onChange())}get color(){return this._color}set color(t){this._color!=t&&(this._color=t,this.updateGear(4),this._content)&&a.ToolSet.setColorFilter(this._content,this._color)}get content(){return this._content}loadContent(){this.clearContent(),this._url&&(a.ToolSet.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())}loadFromPackage(t){this._contentItem=a.UIPackage.getItemByURL(t),this._contentItem&&(this._contentItem=this._contentItem.getBranch(),this.sourceWidth=this._contentItem.width,this.sourceHeight=this._contentItem.height,this._contentItem=this._contentItem.getHighResolution(),this._autoSize&&this.setSize(this.sourceWidth,this.sourceHeight),this._contentItem.type!=a.PackageItemType.Spine&&this._contentItem.type!=a.PackageItemType.DragonBones||this._contentItem.owner.getItemAssetAsync(this._contentItem,this.onLoaded.bind(this)))}onLoaded(t,e){this._contentItem==e&&(t&&console.warn(t),this._contentItem.templet)&&this.setSkeleton(this._contentItem.templet.buildArmature(1),this._contentItem.skeletonAnchor)}setSkeleton(t,e){this.url=null,this._content=t,this._container.addChild(this._content),this._content.pos(e.x,e.y),a.ToolSet.setColorFilter(this._content,this._color),this.onChange(),this.updateLayout()}onChange(){this._content&&(this._animationName?this._playing?this._content.play(this._animationName,this._loop):this._content.play(this._animationName,!1,!0,this._frame,this._frame):this._content.stop(),this._skinName?this._content.showSkinByName(this._skinName):this._content.showSkinByIndex(0))}loadExternal(){}updateLayout(){let t=this.sourceWidth,e=this.sourceHeight;var i,s;this._autoSize&&(this._updatingLayout=!0,0==t&&(t=50),0==e&&(e=30),this.setSize(t,e),this._updatingLayout=!1,t==this._width)&&e==this._height?(this._container.scale(1,1),this._container.pos(0,0)):(s=i=1,this._fill!=a.LoaderFillType.None&&(i=this.width/this.sourceWidth,s=this.height/this.sourceHeight,1==i&&1==s||(this._fill==a.LoaderFillType.ScaleMatchHeight?i=s:this._fill==a.LoaderFillType.ScaleMatchWidth?s=i:this._fill==a.LoaderFillType.Scale?s<i?i=s:s=i:this._fill==a.LoaderFillType.ScaleNoBorder&&(s<i?s=i:i=s),this._shrinkOnly&&(1<i&&(i=1),1<s)&&(s=1),t=this.sourceWidth*i,e=this.sourceHeight*s)),this._container.scale(i,s),i=this._align==a.AlignType.Center?Math.floor((this.width-t)/2):this._align==a.AlignType.Right?this.width-t:0,s=this._verticalAlign==a.VertAlignType.Middle?Math.floor((this.height-e)/2):this._verticalAlign==a.VertAlignType.Bottom?this.height-e:0,this._container.pos(i,s))}clearContent(){this._contentItem=null,this._content&&(this._container.removeChild(this._content),this._content.destroy(),this._content=null)}handleSizeChanged(){super.handleSizeChanged(),this._updatingLayout||this.updateLayout()}handleGrayedChanged(){}getProp(t){switch(t){case a.ObjectPropID.Color:return this.color;case a.ObjectPropID.Playing:return this.playing;case a.ObjectPropID.Frame:return this.frame;case a.ObjectPropID.TimeScale:return 1;default:return super.getProp(t)}}setProp(t,e){switch(t){case a.ObjectPropID.Color:this.color=e;break;case a.ObjectPropID.Playing:this.playing=e;break;case a.ObjectPropID.Frame:this.frame=e;break;case a.ObjectPropID.TimeScale:case a.ObjectPropID.DeltaTime:break;default:super.setProp(t,e)}}setup_beforeAdd(t,e){super.setup_beforeAdd(t,e),t.seek(e,5),this._url=t.readS(),this._align=t.readByte(),this._verticalAlign=t.readByte(),this._fill=t.readByte(),this._shrinkOnly=t.readBool(),this._autoSize=t.readBool(),this._animationName=t.readS(),this._skinName=t.readS(),this._playing=t.readBool(),this._frame=t.getInt32(),this._loop=t.readBool(),t.readBool()&&(this.color=t.readColorS()),this._url&&this.loadContent()}}a.GLoader3D=t}(fgui),function(i){class t extends i.GObject{constructor(){super()}get color(){return this._movieClip.color}set color(t){this._movieClip.color=t}createDisplayObject(){this._displayObject=this._movieClip=new i.MovieClip,this._movieClip.mouseEnabled=!1,this._displayObject.$owner=this}get playing(){return this._movieClip.playing}set playing(t){this._movieClip.playing!=t&&(this._movieClip.playing=t,this.updateGear(5))}get frame(){return this._movieClip.frame}set frame(t){this._movieClip.frame!=t&&(this._movieClip.frame=t,this.updateGear(5))}get timeScale(){return this._movieClip.timeScale}set timeScale(t){this._movieClip.timeScale=t}rewind(){this._movieClip.rewind()}syncStatus(t){this._movieClip.syncStatus(t._movieClip)}advance(t){this._movieClip.advance(t)}setPlaySettings(t,e,i,s,a){this._movieClip.setPlaySettings(t,e,i,s,a)}getProp(t){switch(t){case i.ObjectPropID.Color:return this.color;case i.ObjectPropID.Playing:return this.playing;case i.ObjectPropID.Frame:return this.frame;case i.ObjectPropID.TimeScale:return this.timeScale;default:return super.getProp(t)}}setProp(t,e){switch(t){case i.ObjectPropID.Color:this.color=e;break;case i.ObjectPropID.Playing:this.playing=e;break;case i.ObjectPropID.Frame:this.frame=e;break;case i.ObjectPropID.TimeScale:this.timeScale=e;break;case i.ObjectPropID.DeltaTime:this.advance(e);break;default:super.setProp(t,e)}}constructFromResource(){var t=this.packageItem.getBranch();this.sourceWidth=t.width,this.sourceHeight=t.height,this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),(t=t.getHighResolution()).load(),this._movieClip.interval=t.interval,this._movieClip.swing=t.swing,this._movieClip.repeatDelay=t.repeatDelay,this._movieClip.frames=t.frames}setup_beforeAdd(t,e){super.setup_beforeAdd(t,e),t.seek(e,5),t.readBool()&&(this.color=t.readColorS()),t.readByte(),this._movieClip.frame=t.getInt32(),this._movieClip.playing=t.readBool()}}i.GMovieClip=t}(fgui),function(a){class t extends a.GComponent{constructor(){super(),this._min=0,this._max=0,this._value=0,this._barMaxWidth=0,this._barMaxHeight=0,this._barMaxWidthDelta=0,this._barMaxHeightDelta=0,this._barStartX=0,this._barStartY=0,this._titleType=a.ProgressTitleType.Percent,this._value=50,this._max=100}get titleType(){return this._titleType}set titleType(t){this._titleType!=t&&(this._titleType=t,this.update(t))}get min(){return this._min}set min(t){this._min!=t&&(this._min=t,this.update(this._value))}get max(){return this._max}set max(t){this._max!=t&&(this._max=t,this.update(this._value))}get value(){return this._value}set value(t){this._value!=t&&(a.GTween.kill(this,!1,this.update),this._value=t,this.update(t))}tweenValue(t,e){var i,s=a.GTween.getTween(this,this.update);return s?(i=s.value.x,s.kill()):i=this._value,this._value=t,a.GTween.to(i,this._value,e).setTarget(this,this.update).setEase(a.EaseType.Linear)}update(t){var e=a.ToolSet.clamp01((t-this._min)/(this._max-this._min));if(this._titleObject)switch(this._titleType){case a.ProgressTitleType.Percent:this._titleObject.text=Math.floor(100*e)+"%";break;case a.ProgressTitleType.ValueAndMax:this._titleObject.text=Math.floor(t)+"/"+Math.floor(this._max);break;case a.ProgressTitleType.Value:this._titleObject.text=""+Math.floor(t);break;case a.ProgressTitleType.Max:this._titleObject.text=""+Math.floor(this._max)}var e=Math.max(1e-4,e),i=this.width-this._barMaxWidthDelta,s=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&!this.setFillAmount(this._barObjectH,1-e)&&(this._barObjectH.width=Math.round(i*e),this._barObjectH.x=this._barStartX+(i-this._barObjectH.width)),this._barObjectV&&!this.setFillAmount(this._barObjectV,1-e)&&(this._barObjectV.height=Math.round(s*e),this._barObjectV.y=this._barStartY+(s-this._barObjectV.height))):(this._barObjectH&&!this.setFillAmount(this._barObjectH,e)&&(this._barObjectH.width=Math.round(i*e)),this._barObjectV&&!this.setFillAmount(this._barObjectV,e)&&(this._barObjectV.height=Math.round(s*e))),this._aniObject&&this._aniObject.setProp(a.ObjectPropID.Frame,Math.floor(100*e))}setFillAmount(t,e){return(t instanceof a.GImage||t instanceof a.GLoader)&&t.fillMethod!=a.FillMethod.None&&(t.fillAmount=e,!0)}constructExtension(t){t.seek(0,6),this._titleType=t.readByte(),this._reverse=t.readBool(),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y)}handleSizeChanged(){super.handleSizeChanged(),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update(this._value)}setup_afterAdd(t,e){super.setup_afterAdd(t,e),t.seek(e,6)&&t.readByte()==this.packageItem.objectType&&(this._value=t.getInt32(),this._max=t.getInt32(),2<=t.version)&&(this._min=t.getInt32()),this.update(this._value)}}a.GProgressBar=t}(fgui),function(s){class t extends s.GTextField{constructor(){super(),this._text=""}createDisplayObject(){this._displayObject=this._div=new Laya.HTMLDivElement,this._displayObject.mouseEnabled=!0,this._displayObject.$owner=this}get div(){return this._div}set text(t){this._text=t;var e,i,t=this._text;this._templateVars&&(t=this.parseTemplate(t));try{this._div.size(this._width,this._height),this._ubbEnabled?this._div.innerHTML=s.UBBParser.inst.parse(t):this._div.innerHTML=t,(this._widthAutoSize||this._heightAutoSize)&&(i=0,this._widthAutoSize?0<(e=this._div.contextWidth)&&(e+=8):e=this._width,i=this._heightAutoSize?this._div.contextHeight:this._height,this._updatingSize=!0,this.setSize(e,i),this._updatingSize=!1)}catch(t){console.log("laya reports html error:"+t)}}get text(){return this._text}get font(){return this._div.style.font}set font(t){this._div.style.font=t||s.UIConfig.defaultFont}get fontSize(){return this._div.style.fontSize}set fontSize(t){this._div.style.fontSize=t}get color(){return this._div.style.color}set color(t){this._div.style.color!=t&&(this._div.style.color=t,this.refresh(),this.updateGear(4))}get align(){return this._div.style.align}set align(t){this._div.style.align!=t&&(this._div.style.align=t,this.refresh())}get valign(){return this._div.style.valign}set valign(t){this._div.style.valign!=t&&(this._div.style.valign=t,this.refresh())}get leading(){return this._div.style.leading}set leading(t){this._div.style.leading!=t&&(this._div.style.leading=t,this.refresh())}get bold(){return this._div.style.bold}set bold(t){this._div.style.bold!=t&&(this._div.style.bold=t,this.refresh())}get italic(){return this._div.style.italic}set italic(t){this._div.style.italic!=t&&(this._div.style.italic=t,this.refresh())}get stroke(){return this._div.style.stroke}set stroke(t){this._div.style.stroke!=t&&(this._div.style.stroke=t,this.refresh())}get strokeColor(){return this._div.style.strokeColor}set strokeColor(t){this._div.style.strokeColor!=t&&(this._div.style.strokeColor=t,this.refresh(),this.updateGear(4))}set ubbEnabled(t){this._ubbEnabled=t}get ubbEnabled(){return this._ubbEnabled}get textWidth(){var t=this._div.contextWidth;return 0<t&&(t+=8),t}refresh(){0<this._text.length&&this._div._refresh&&this._div._refresh()}updateAutoSize(){this._div.style.wordWrap=!this._widthAutoSize}handleSizeChanged(){this._updatingSize||(this._div.size(this._width,this._height),this._div.style.width=this._width,this._div.style.height=this._height)}}s.GRichTextField=t}(fgui),function(_){class e extends _.GComponent{constructor(){super(),e._inst||(e._inst=this),this.opaque=!1,this._popupStack=[],this._justClosedPopups=[],this.displayObject.once(Laya.Event.DISPLAY,this,this.__addedToStage)}static get inst(){return e._inst||new e,e._inst}showWindow(t){this.addChild(t),t.requestFocus(),t.x>this.width?t.x=this.width-t.width:t.x+t.width<0&&(t.x=0),t.y>this.height?t.y=this.height-t.height:t.y+t.height<0&&(t.y=0),this.adjustModalLayer()}hideWindow(t){t.hide()}hideWindowImmediately(t){t.parent==this&&this.removeChild(t),this.adjustModalLayer()}bringToFront(t){for(var e=this.numChildren,i=this._modalLayer.parent&&!t.modal?this.getChildIndex(this._modalLayer)-1:e-1;0<=i;i--){var s=this.getChildAt(i);if(s==t)return;if(s instanceof _.Window)break}0<=i&&this.setChildIndex(t,i)}showModalWait(t){null!=_.UIConfig.globalModalWaiting&&(null==this._modalWaitPane&&(this._modalWaitPane=_.UIPackage.createObjectFromURL(_.UIConfig.globalModalWaiting)),this._modalWaitPane.setSize(this.width,this.height),this._modalWaitPane.addRelation(this,_.RelationType.Size),this.addChild(this._modalWaitPane),this._modalWaitPane.text=t)}closeModalWait(){this._modalWaitPane&&this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane)}closeAllExceptModals(){for(var t=this._children.slice(),e=t.length,i=0;i<e;i++){var s=t[i];s instanceof _.Window&&!s.modal&&s.hide()}}closeAllWindows(){for(var t=this._children.slice(),e=t.length,i=0;i<e;i++){var s=t[i];s instanceof _.Window&&s.hide()}}getTopWindow(){for(var t=this.numChildren-1;0<=t;t--){var e=this.getChildAt(t);if(e instanceof _.Window)return e}return null}get modalLayer(){return this._modalLayer}get hasModalWindow(){return null!=this._modalLayer.parent}get modalWaiting(){return this._modalWaitPane&&this._modalWaitPane.inContainer}showPopup(t,e,i){if(0<this._popupStack.length){var s=this._popupStack.indexOf(t);if(-1!=s)for(var a=this._popupStack.length-1;s<=a;a--)this.removeChild(this._popupStack.pop())}if(this._popupStack.push(t),e)for(var h=e;h;){if(h.parent==this){t.sortingOrder<h.sortingOrder&&(t.sortingOrder=h.sortingOrder);break}h=h.parent}this.addChild(t),this.adjustModalLayer();var r,n=0,o=0,l=(e?(r=e.localToGlobal(),n=e.width,o=e.height):r=this.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY),(e=r.x)+t.width>this.width&&(e=e+n-t.width),o=r.y+o,t._pivotAsAnchor?t.height*(1-t._pivotY):t.height);((void 0===i||i===_.PopupDirection.Auto)&&r.y+l>this.height||!1===i||i===_.PopupDirection.Up)&&(o=r.y-t.height-1)<0&&(o=0,e+=n/2),t.x=e,t.y=o}togglePopup(t,e,i){-1==this._justClosedPopups.indexOf(t)&&this.showPopup(t,e,i)}hidePopup(t){if(t){var e=this._popupStack.indexOf(t);if(-1!=e)for(var i=this._popupStack.length-1;e<=i;i--)this.closePopup(this._popupStack.pop())}else{for(i=this._popupStack.length-1;0<=i;i--)this.closePopup(this._popupStack[i]);this._popupStack.length=0}}get hasAnyPopup(){return 0!=this._popupStack.length}closePopup(t){t.parent&&(t instanceof _.Window?t.hide():this.removeChild(t))}showTooltips(t){if(null==this._defaultTooltipWin){var e=_.UIConfig.tooltipsWin;if(!e)return void Laya.Log.print("UIConfig.tooltipsWin not defined");this._defaultTooltipWin=_.UIPackage.createObjectFromURL(e)}this._defaultTooltipWin.text=t,this.showTooltipsWin(this._defaultTooltipWin)}showTooltipsWin(t,e){this.hideTooltips(),this._tooltipWin=t;var t=0,i=0,i=null==e?(t=Laya.stage.mouseX+10,Laya.stage.mouseY+20):(t=e.x,e.y),e=this.globalToLocal(t,i),t=e.x;i=e.y,t+this._tooltipWin.width>this.width&&(t=t-this._tooltipWin.width-1)<0&&(t=10),i+this._tooltipWin.height>this.height&&(i=i-this._tooltipWin.height-1,0<t-this._tooltipWin.width-1&&(t=t-this._tooltipWin.width-1),i<0)&&(i=10),this._tooltipWin.x=t,this._tooltipWin.y=i,this.addChild(this._tooltipWin)}hideTooltips(){this._tooltipWin&&(this._tooltipWin.parent&&this.removeChild(this._tooltipWin),this._tooltipWin=null)}get focus(){return null}set focus(t){this.setFocus(t)}setFocus(t){}get volumeScale(){return Laya.SoundManager.soundVolume}set volumeScale(t){Laya.SoundManager.soundVolume=t}playOneShotSound(t,e){_.ToolSet.startsWith(t,"ui://")||Laya.SoundManager.playSound(t)}adjustModalLayer(){var t=this.numChildren;null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.setChildIndex(this._modalWaitPane,t-1);for(var e=t-1;0<=e;e--){var i=this.getChildAt(e);if(i instanceof _.Window&&i.modal)return void(null==this._modalLayer.parent?this.addChildAt(this._modalLayer,e):this.setChildIndexBefore(this._modalLayer,e))}this._modalLayer.parent&&this.removeChild(this._modalLayer)}__addedToStage(){Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.__stageMouseDown),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.__stageMouseUp),this._modalLayer=new _.GGraph,this._modalLayer.setSize(this.width,this.height),this._modalLayer.drawRect(0,null,_.UIConfig.modalLayerColor),this._modalLayer.addRelation(this,_.RelationType.Size),this.displayObject.stage.on(Laya.Event.RESIZE,this,this.__winResize),this.__winResize()}checkPopups(t){if(!this._checkPopups&&(this._checkPopups=!0,(this._justClosedPopups.length=0)<this._popupStack.length)){for(var e=t;e!=this.displayObject.stage&&e;){if(e.$owner){var i=this._popupStack.indexOf(e.$owner);if(-1!=i){for(var s=this._popupStack.length-1;i<s;s--){var a=this._popupStack.pop();this.closePopup(a),this._justClosedPopups.push(a)}return}}e=e.parent}for(s=this._popupStack.length-1;0<=s;s--)a=this._popupStack[s],this.closePopup(a),this._justClosedPopups.push(a);this._popupStack.length=0}}__stageMouseDown(t){this._tooltipWin&&this.hideTooltips(),this.checkPopups(t.target)}__stageMouseUp(){this._checkPopups=!1}__winResize(){this.setSize(Laya.stage.width,Laya.stage.height),this.updateContentScaleLevel()}updateContentScaleLevel(){var t=Laya.stage._canvasTransform,t=Math.max(t.getScaleX(),t.getScaleY());e.contentScaleLevel=3.5<=t?3:2.5<=t?2:1.5<=t?1:0}}e.contentScaleLevel=0,_.GRoot=e}(fgui),function(t){class e extends t.GComponent{constructor(){super(),this._dragOffset=new Laya.Point,this._scrollPerc=0}setScrollPane(t,e){this._target=t,this._vertical=e}setDisplayPerc(t){this._vertical?(this._fixedGripSize||(this._grip.height=Math.floor(t*this._bar.height)),this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc):(this._fixedGripSize||(this._grip.width=Math.floor(t*this._bar.width)),this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc),this._grip.visible=0!=t&&1!=t}setScrollPerc(t){this._scrollPerc=t,this._vertical?this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc:this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc}get minSize(){return this._vertical?(this._arrowButton1?this._arrowButton1.height:0)+(this._arrowButton2?this._arrowButton2.height:0):(this._arrowButton1?this._arrowButton1.width:0)+(this._arrowButton2?this._arrowButton2.width:0)}get gripDragging(){return this._gripDragging}constructExtension(t){t.seek(0,6),this._fixedGripSize=t.readBool(),this._grip=this.getChild("grip"),this._grip?(this._bar=this.getChild("bar"),this._bar?(this._arrowButton1=this.getChild("arrow1"),this._arrowButton2=this.getChild("arrow2"),this._grip.on(Laya.Event.MOUSE_DOWN,this,this.__gripMouseDown),this._arrowButton1&&this._arrowButton1.on(Laya.Event.MOUSE_DOWN,this,this.__arrowButton1Click),this._arrowButton2&&this._arrowButton2.on(Laya.Event.MOUSE_DOWN,this,this.__arrowButton2Click),this.on(Laya.Event.MOUSE_DOWN,this,this.__barMouseDown)):Laya.Log.print("需要定义bar")):Laya.Log.print("需要定义grip")}__gripMouseDown(t){t.stopPropagation(),this._gripDragging=!0,this._target.updateScrollBarVisible(),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.__gripMouseMove),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.__gripMouseUp),this.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY,this._dragOffset),this._dragOffset.x-=this._grip.x,this._dragOffset.y-=this._grip.y}__gripMouseMove(){var t,e;this.onStage&&(t=this.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY,i),this._vertical?(e=t.y-this._dragOffset.y,this._target.setPercY((e-this._bar.y)/(this._bar.height-this._grip.height),!1)):(e=t.x-this._dragOffset.x,this._target.setPercX((e-this._bar.x)/(this._bar.width-this._grip.width),!1)))}__gripMouseUp(t){this.onStage&&(Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.__gripMouseMove),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.__gripMouseUp),this._gripDragging=!1,this._target.updateScrollBarVisible())}__arrowButton1Click(t){t.stopPropagation(),this._vertical?this._target.scrollUp():this._target.scrollLeft()}__arrowButton2Click(t){t.stopPropagation(),this._vertical?this._target.scrollDown():this._target.scrollRight()}__barMouseDown(t){var e=this._grip.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY,i);this._vertical?e.y<0?this._target.scrollUp(4):this._target.scrollDown(4):e.x<0?this._target.scrollLeft(4):this._target.scrollRight(4)}}t.GScrollBar=e;var i=new Laya.Point}(fgui),function(a){class t extends a.GComponent{constructor(){super(),this._min=0,this._max=0,this._value=0,this._barMaxWidth=0,this._barMaxHeight=0,this._barMaxWidthDelta=0,this._barMaxHeightDelta=0,this._clickPercent=0,this._barStartX=0,this._barStartY=0,this.changeOnClick=!0,this.canDrag=!0,this._titleType=a.ProgressTitleType.Percent,this._value=50,this._max=100,this._clickPos=new Laya.Point}get titleType(){return this._titleType}set titleType(t){this._titleType=t}get wholeNumbers(){return this._wholeNumbers}set wholeNumbers(t){this._wholeNumbers!=t&&(this._wholeNumbers=t,this.update())}get min(){return this._min}set min(t){this._min!=t&&(this._min=t,this.update())}get max(){return this._max}set max(t){this._max!=t&&(this._max=t,this.update())}get value(){return this._value}set value(t){this._value!=t&&(this._value=t,this.update())}update(){this.updateWithPercent((this._value-this._min)/(this._max-this._min))}updateWithPercent(t,e){if(t=a.ToolSet.clamp01(t),e&&(i=a.ToolSet.clamp(this._min+(this._max-this._min)*t,this._min,this._max),this._wholeNumbers&&(i=Math.round(i),t=a.ToolSet.clamp01((i-this._min)/(this._max-this._min))),i!=this._value)&&(this._value=i,a.Events.dispatch(a.Events.STATE_CHANGED,this.displayObject,e)),this._titleObject)switch(this._titleType){case a.ProgressTitleType.Percent:this._titleObject.text=Math.floor(100*t)+"%";break;case a.ProgressTitleType.ValueAndMax:this._titleObject.text=this._value+"/"+this._max;break;case a.ProgressTitleType.Value:this._titleObject.text=""+this._value;break;case a.ProgressTitleType.Max:this._titleObject.text=""+this._max}var i=this.width-this._barMaxWidthDelta,e=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this._barObjectH.width=Math.round(i*t),this._barObjectH.x=this._barStartX+(i-this._barObjectH.width)),this._barObjectV&&(this._barObjectV.height=Math.round(e*t),this._barObjectV.y=this._barStartY+(e-this._barObjectV.height))):(this._barObjectH&&(this._barObjectH.width=Math.round(i*t)),this._barObjectV&&(this._barObjectV.height=Math.round(e*t)))}constructExtension(t){t.seek(0,6),this._titleType=t.readByte(),this._reverse=t.readBool(),2<=t.version&&(this._wholeNumbers=t.readBool(),this.changeOnClick=t.readBool()),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._gripObject=this.getChild("grip"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y),this._gripObject&&this._gripObject.on(Laya.Event.MOUSE_DOWN,this,this.__gripMouseDown),this.displayObject.on(Laya.Event.MOUSE_DOWN,this,this.__barMouseDown)}handleSizeChanged(){super.handleSizeChanged(),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update()}setup_afterAdd(t,e){super.setup_afterAdd(t,e),t.seek(e,6)&&t.readByte()==this.packageItem.objectType&&(this._value=t.getInt32(),this._max=t.getInt32(),2<=t.version)&&(this._min=t.getInt32()),this.update()}__gripMouseDown(t){this.canDrag=!0,t.stopPropagation(),this._clickPos=this.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY),this._clickPercent=a.ToolSet.clamp01((this._value-this._min)/(this._max-this._min)),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.__gripMouseMove),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.__gripMouseUp)}__gripMouseMove(t){var e,i;this.canDrag&&(i=(e=this.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY,h)).x-this._clickPos.x,e=e.y-this._clickPos.y,this._reverse&&(i=-i,e=-e),i=this._barObjectH?this._clickPercent+i/this._barMaxWidth:this._clickPercent+e/this._barMaxHeight,this.updateWithPercent(i,t))}__gripMouseUp(t){Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.__gripMouseMove),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.__gripMouseUp)}__barMouseDown(t){var e,i,s;this.changeOnClick&&(e=this._gripObject.globalToLocal(t.stageX,t.stageY,h),i=a.ToolSet.clamp01((this._value-this._min)/(this._max-this._min)),this._barObjectH&&(s=e.x/this._barMaxWidth),this._barObjectV&&(s=e.y/this._barMaxHeight),this._reverse?i-=s:i+=s,this.updateWithPercent(i,t))}}a.GSlider=t;var h=new Laya.Point}(fgui),function(e){class t extends e.GTextField{constructor(){super()}createDisplayObject(){this._displayObject=this._input=new Laya.Input,this._displayObject.mouseEnabled=!0,this._displayObject.$owner=this}get nativeInput(){return this._input}set text(t){this._input.text=t}get text(){return this._input.text}get font(){return this._input.font}set font(t){this._input.font=t||e.UIConfig.defaultFont}get fontSize(){return this._input.fontSize}set fontSize(t){this._input.fontSize=t}get color(){return this._input.color}set color(t){this._input.color=t}get align(){return this._input.align}set align(t){this._input.align=t}get valign(){return this._input.valign}set valign(t){this._input.valign=t}get leading(){return this._input.leading}set leading(t){this._input.leading=t}get bold(){return this._input.bold}set bold(t){this._input.bold=t}get italic(){return this._input.italic}set italic(t){this._input.italic=t}get singleLine(){return!this._input.multiline}set singleLine(t){this._input.multiline=!t}get stroke(){return this._input.stroke}set stroke(t){this._input.stroke=t}get strokeColor(){return this._input.strokeColor}set strokeColor(t){this._input.strokeColor=t,this.updateGear(4)}get shadowColor(){return this._input.shadowColor}set shadowColor(t){this._input.shadowColor=t,this.updateGear(10)}get password(){return"password"==this._input.type}set password(t){this._input.type=t?"password":"text"}get keyboardType(){return this._input.type}set keyboardType(t){this._input.type=t}set editable(t){this._input.editable=t}get editable(){return this._input.editable}set maxLength(t){this._input.maxChars=t}get maxLength(){return this._input.maxChars}set promptText(t){this._prompt=t;t=e.UBBParser.inst.parse(t,!0);this._input.prompt=t,e.UBBParser.inst.lastColor&&(this._input.promptColor=e.UBBParser.inst.lastColor)}get promptText(){return this._prompt}set restrict(t){this._input.restrict=t}get restrict(){return this._input.restrict}get textWidth(){return this._input.textWidth}requestFocus(){this._input.focus=!0,super.requestFocus()}handleSizeChanged(){this._input.size(this._width,this._height)}setup_beforeAdd(t,e){super.setup_beforeAdd(t,e),t.seek(e,4);e=t.readS(),null!=e&&(this.promptText=e),null!=(e=t.readS())&&(this._input.restrict=e),e=t.getInt32();0!=e&&(this._input.maxChars=e),0!=(e=t.getInt32())&&(4==e?this.keyboardType=Laya.Input.TYPE_NUMBER:3==e&&(this.keyboardType=Laya.Input.TYPE_URL)),t.readBool()&&(this.password=!0)}}e.GTextInput=t}(fgui),function(_){class t extends _.GList{constructor(){super(),this._indent=15,this._rootNode=new _.GTreeNode(!0),this._rootNode._setTree(this),this._rootNode.expanded=!0}get rootNode(){return this._rootNode}get indent(){return this._indent}set indent(t){this._indent=t}get clickToExpand(){return this._clickToExpand}set clickToExpand(t){this._clickToExpand=t}getSelectedNode(){return-1!=this.selectedIndex?this.getChildAt(this.selectedIndex)._treeNode:null}getSelectedNodes(t){t=t||new Array,h.length=0,super.getSelection(h);for(var e=h.length,i=new Array,s=0;s<e;s++){var a=this.getChildAt(h[s])._treeNode;i.push(a)}return i}selectNode(t,e){for(var i=t.parent;i&&i!=this._rootNode;)i.expanded=!0,i=i.parent;t._cell&&this.addSelection(this.getChildIndex(t._cell),e)}unselectNode(t){t._cell&&this.removeSelection(this.getChildIndex(t._cell))}expandAll(t){(t=t||this._rootNode).expanded=!0;for(var e=t.numChildren,i=0;i<e;i++){var s=t.getChildAt(i);s.isFolder&&this.expandAll(s)}}collapseAll(t){(t=t||this._rootNode)!=this._rootNode&&(t.expanded=!1);for(var e=t.numChildren,i=0;i<e;i++){var s=t.getChildAt(i);s.isFolder&&this.collapseAll(s)}}createCell(t){var e=this.getFromPool(t._resURL||this.defaultItem);if(!e)throw new Error("cannot create tree node object.");var i=((e._treeNode=t)._cell=e).getChild("indent");i&&(i.width=(t.level-1)*this._indent),(i=e.getController("expanded"))&&(i.on(_.Events.STATE_CHANGED,this,this.__expandedStateChanged),i.selectedIndex=t.expanded?1:0),(i=e.getController("leaf"))&&(i.selectedIndex=t.isFolder?0:1),t.isFolder&&e.on(Laya.Event.MOUSE_DOWN,this,this.__cellMouseDown),this.treeNodeRender&&this.treeNodeRender.runWith([t,e])}_afterInserted(t){t._cell||this.createCell(t);var e=this.getInsertIndexForNode(t);this.addChildAt(t._cell,e),this.treeNodeRender&&this.treeNodeRender.runWith([t,t._cell]),t.isFolder&&t.expanded&&this.checkChildren(t,e)}getInsertIndexForNode(t){for(var e=(e=t.getPrevSibling())||t.parent,i=this.getChildIndex(e._cell)+1,s=t.level,a=this.numChildren,h=i;h<a&&!(this.getChildAt(h)._treeNode.level<=s);h++)i++;return i}_afterRemoved(t){this.removeNode(t)}_afterExpanded(t){var e;t==this._rootNode?this.checkChildren(this._rootNode,0):(null!=this.treeNodeWillExpand&&this.treeNodeWillExpand.runWith([t,!0]),t._cell&&(this.treeNodeRender&&this.treeNodeRender.runWith([t,t._cell]),(e=t._cell.getController("expanded"))&&(e.selectedIndex=1),t._cell.parent)&&this.checkChildren(t,this.getChildIndex(t._cell)))}_afterCollapsed(t){var e;t==this._rootNode?this.checkChildren(this._rootNode,0):(this.treeNodeWillExpand&&this.treeNodeWillExpand.runWith([t,!1]),t._cell&&(this.treeNodeRender&&this.treeNodeRender.runWith([t,t._cell]),(e=t._cell.getController("expanded"))&&(e.selectedIndex=0),t._cell.parent)&&this.hideFolderNode(t))}_afterMoved(t){var e,i,s=this.getChildIndex(t._cell),a=t.isFolder?this.getFolderEndIndex(s,t.level):s+1,h=this.getInsertIndexForNode(t),r=a-s;if(h<s)for(e=0;e<r;e++)i=this.getChildAt(s+e),this.setChildIndex(i,h+e);else for(e=0;e<r;e++)i=this.getChildAt(s),this.setChildIndex(i,h)}getFolderEndIndex(t,e){for(var i=this.numChildren,s=t+1;s<i;s++)if(this.getChildAt(s)._treeNode.level<=e)return s;return i}checkChildren(t,e){for(var i=t.numChildren,s=0;s<i;s++){e++;var a=t.getChildAt(s);a._cell||this.createCell(a),a._cell.parent||this.addChildAt(a._cell,e),a.isFolder&&a.expanded&&(e=this.checkChildren(a,e))}return e}hideFolderNode(t){for(var e=t.numChildren,i=0;i<e;i++){var s=t.getChildAt(i);s._cell&&this.removeChild(s._cell),s.isFolder&&s.expanded&&this.hideFolderNode(s)}}removeNode(t){if(t._cell&&(t._cell.parent&&this.removeChild(t._cell),this.returnToPool(t._cell),t._cell._treeNode=null,t._cell=null),t.isFolder)for(var e=t.numChildren,i=0;i<e;i++){var s=t.getChildAt(i);this.removeNode(s)}}__cellMouseDown(t){t=_.GObject.cast(t.currentTarget)._treeNode;this._expandedStatusInEvt=t.expanded}__expandedStateChanged(t){t.parent._treeNode.expanded=1==t.selectedIndex}dispatchItemEvent(t,e){var i;0!=this._clickToExpand&&(i=t._treeNode)&&i.isFolder&&this._expandedStatusInEvt==i.expanded&&2!=this._clickToExpand&&(i.expanded=!i.expanded),super.dispatchItemEvent(t,e)}setup_beforeAdd(t,e){super.setup_beforeAdd(t,e),t.seek(e,9),this._indent=t.getInt32(),this._clickToExpand=t.getUint8()}readItems(t){for(var e,i,s,a=0,h=t.getInt16(),r=0;r<h;r++){if(e=t.getInt16(),e+=t.pos,null!=(i=t.readS())||(i=this.defaultItem)){var n=t.readBool(),o=t.getUint8(),n=new _.GTreeNode(n,i);if(n.expanded=!0,0==r)this._rootNode.addChild(n);else if(a<o)s.addChild(n);else if(o<a){for(var l=o;l<=a;l++)s=s.parent;s.addChild(n)}else s.parent.addChild(n);a=o,this.setupItem(t,(s=n).cell)}t.pos=e}}}_.GTree=t;var h=new Array}(fgui),function(t){t.GTreeNode=class{constructor(t,e){this._level=0,this._resURL=e,t&&(this._children=new Array)}set expanded(t){null!=this._children&&this._expanded!=t&&(this._expanded=t,this._tree)&&(this._expanded?this._tree._afterExpanded(this):this._tree._afterCollapsed(this))}get expanded(){return this._expanded}get isFolder(){return null!=this._children}get parent(){return this._parent}get text(){return this._cell?this._cell.text:null}set text(t){this._cell&&(this._cell.text=t)}get icon(){return this._cell?this._cell.icon:null}set icon(t){this._cell&&(this._cell.icon=t)}get cell(){return this._cell}get level(){return this._level}_setLevel(t){this._level=t}addChild(t){return this.addChildAt(t,this._children.length),t}addChildAt(t,e){if(!t)throw new Error("child is null");var i=this._children.length;if(0<=e&&e<=i)return t._parent==this?this.setChildIndex(t,e):(t._parent&&t._parent.removeChild(t),e==this._children.length?this._children.push(t):this._children.splice(e,0,t),t._parent=this,t._level=this._level+1,t._setTree(this._tree),(this._tree&&this==this._tree.rootNode||this._cell&&this._cell.parent&&this._expanded)&&this._tree._afterInserted(t)),t;throw new RangeError("Invalid child index")}removeChild(t){var e=this._children.indexOf(t);return-1!=e&&this.removeChildAt(e),t}removeChildAt(t){var e;if(0<=t&&t<this.numChildren)return e=this._children[t],this._children.splice(t,1),e._parent=null,this._tree&&(e._setTree(null),this._tree._afterRemoved(e)),e;throw"Invalid child index"}removeChildren(t,e){((e=null==e?-1:e)<0||e>=this.numChildren)&&(e=this.numChildren-1);for(var i=t=t||0;i<=e;++i)this.removeChildAt(t)}getChildAt(t){if(0<=t&&t<this.numChildren)return this._children[t];throw"Invalid child index"}getChildIndex(t){return this._children.indexOf(t)}getPrevSibling(){var t;return null==this._parent||(t=this._parent._children.indexOf(this))<=0?null:this._parent._children[t-1]}getNextSibling(){var t;return null==this._parent||(t=this._parent._children.indexOf(this))<0||t>=this._parent._children.length-1?null:this._parent._children[t+1]}setChildIndex(t,e){var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";var s=this._children.length;e<0?e=0:s<e&&(e=s),i!=e&&(this._children.splice(i,1),this._children.splice(e,0,t),this._tree&&this==this._tree.rootNode||this._cell&&this._cell.parent&&this._expanded)&&this._tree._afterMoved(t)}swapChildren(t,e){t=this._children.indexOf(t),e=this._children.indexOf(e);if(-1==t||-1==e)throw"Not a child of this container";this.swapChildrenAt(t,e)}swapChildrenAt(t,e){var i=this._children[t],s=this._children[e];this.setChildIndex(i,e),this.setChildIndex(s,t)}get numChildren(){return this._children.length}expandToRoot(){for(var t=this;t;)t.expanded=!0,t=t.parent}get tree(){return this._tree}_setTree(t){if(this._tree=t,this._tree&&this._tree.treeNodeWillExpand&&this._expanded&&this._tree.treeNodeWillExpand.runWith([this,!0]),this._children)for(var e=this._children.length,i=0;i<e;i++){var s=this._children[i];s._level=this._level+1,s._setTree(t)}}}}(fgui),function(e){e.PackageItem=class{constructor(){this.width=0,this.height=0}load(){return this.owner.getItemAsset(this)}getBranch(){if(this.branches&&-1!=this.owner._branchIndex){var t=this.branches[this.owner._branchIndex];if(t)return this.owner.getItemById(t)}return this}getHighResolution(){if(this.highResolution&&0<e.GRoot.contentScaleLevel){var t=this.highResolution[e.GRoot.contentScaleLevel-1];if(t)return this.owner.getItemById(t)}return this}toString(){return this.name}}}(fgui),function(i){i.PopupMenu=class{constructor(t){if(!t&&!(t=i.UIConfig.popupMenu))throw"UIConfig.popupMenu not defined";this._contentPane=i.UIPackage.createObjectFromURL(t).asCom,this._contentPane.on(Laya.Event.DISPLAY,this,this.__addedToStage),this._list=this._contentPane.getChild("list"),this._list.removeChildrenToPool(),this._list.addRelation(this._contentPane,i.RelationType.Width),this._list.removeRelation(this._contentPane,i.RelationType.Height),this._contentPane.addRelation(this._list,i.RelationType.Height),this._list.on(i.Events.CLICK_ITEM,this,this.__clickItem)}dispose(){this._contentPane.dispose()}addItem(t,e){var i=this._list.addItemFromPool().asButton,t=(i.title=t,i.data=e,i.grayed=!1,i.getController("checked"));return t&&(t.selectedIndex=0),i}addItemAt(t,e,i){var s=this._list.getFromPool().asButton,e=(this._list.addChildAt(s,e),s.title=t,s.data=i,s.grayed=!1,s.getController("checked"));return e&&(e.selectedIndex=0),s}addSeperator(){if(null==i.UIConfig.popupMenu_seperator)throw"UIConfig.popupMenu_seperator not defined";this.list.addItemFromPool(i.UIConfig.popupMenu_seperator)}getItemName(t){return this._list.getChildAt(t).name}setItemText(t,e){this._list.getChild(t).asButton.title=e}setItemVisible(t,e){t=this._list.getChild(t).asButton;t.visible!=e&&(t.visible=e,this._list.setBoundsChangedFlag())}setItemGrayed(t,e){this._list.getChild(t).asButton.grayed=e}setItemCheckable(t,e){t=this._list.getChild(t).asButton.getController("checked");t&&(e?0==t.selectedIndex&&(t.selectedIndex=1):t.selectedIndex=0)}setItemChecked(t,e){t=this._list.getChild(t).asButton.getController("checked");t&&(t.selectedIndex=e?2:1)}isItemChecked(t){t=this._list.getChild(t).asButton.getController("checked");return!!t&&2==t.selectedIndex}removeItem(t){var t=this._list.getChild(t);return!!t&&(t=this._list.getChildIndex(t),this._list.removeChildToPoolAt(t),!0)}clearItems(){this._list.removeChildrenToPool()}get itemCount(){return this._list.numChildren}get contentPane(){return this._contentPane}get list(){return this._list}show(t=null,e){(null!=t?t.root:i.GRoot.inst).showPopup(this.contentPane,t instanceof i.GRoot?null:t,e)}__clickItem(t){Laya.timer.once(100,this,this.__clickItem2,[t])}__clickItem2(t){var e;t instanceof i.GButton&&(t.grayed?this._list.selectedIndex=-1:((e=t.asCom.getController("checked"))&&0!=e.selectedIndex&&(1==e.selectedIndex?e.selectedIndex=2:e.selectedIndex=1),this._contentPane.parent.hidePopup(this.contentPane),null!=t.data&&t.data.run()))}__addedToStage(){this._list.selectedIndex=-1,this._list.resizeToFit(1e5,10)}}}(fgui),function(o){o.RelationItem=class{constructor(t){this._owner=t,this._defs=new Array}get owner(){return this._owner}set target(t){this._target!=t&&(this._target&&this.releaseRefTarget(),this._target=t,this._target)&&this.addRefTarget()}get target(){return this._target}add(t,e){if(t==o.RelationType.Size)this.add(o.RelationType.Width,e),this.add(o.RelationType.Height,e);else{for(var i=this._defs.length,s=0;s<i;s++)if(this._defs[s].type==t)return;this.internalAdd(t,e)}}internalAdd(t,e){var i;t==o.RelationType.Size?(this.internalAdd(o.RelationType.Width,e),this.internalAdd(o.RelationType.Height,e)):((i=new h).percent=e,i.type=t,i.axis=t<=o.RelationType.Right_Right||t==o.RelationType.Width||t>=o.RelationType.LeftExt_Left&&t<=o.RelationType.RightExt_Right?0:1,this._defs.push(i))}remove(t){if(t==o.RelationType.Size)this.remove(o.RelationType.Width),this.remove(o.RelationType.Height);else for(var e=this._defs.length,i=0;i<e;i++)if(this._defs[i].type==t){this._defs.splice(i,1);break}}copyFrom(t){this._target=t.target,this._defs.length=0;for(var e=t._defs.length,i=0;i<e;i++){var s=t._defs[i],a=new h;a.copyFrom(s),this._defs.push(a)}}dispose(){this._target&&(this.releaseRefTarget(),this._target=null)}get isEmpty(){return 0==this._defs.length}applyOnSelfResized(t,e,i){var s=this._defs.length;if(0!=s){for(var a=this._owner.x,h=this._owner.y,r=0;r<s;r++)switch(this._defs[r].type){case o.RelationType.Center_Center:this._owner.x-=(.5-(i?this._owner.pivotX:0))*t;break;case o.RelationType.Right_Center:case o.RelationType.Right_Left:case o.RelationType.Right_Right:this._owner.x-=(1-(i?this._owner.pivotX:0))*t;break;case o.RelationType.Middle_Middle:this._owner.y-=(.5-(i?this._owner.pivotY:0))*e;break;case o.RelationType.Bottom_Middle:case o.RelationType.Bottom_Top:case o.RelationType.Bottom_Bottom:this._owner.y-=(1-(i?this._owner.pivotY:0))*e}if((a!=this._owner.x||h!=this._owner.y)&&(a=this._owner.x-a,h=this._owner.y-h,this._owner.updateGearFromRelations(1,a,h),this._owner.parent)&&0<this._owner.parent._transitions.length)for(var s=this._owner.parent._transitions.length,n=0;n<s;n++)this._owner.parent._transitions[n].updateFromRelations(this._owner.id,a,h)}}applyOnXYChanged(t,e,i){var s;switch(t.type){case o.RelationType.Left_Left:case o.RelationType.Left_Center:case o.RelationType.Left_Right:case o.RelationType.Center_Center:case o.RelationType.Right_Left:case o.RelationType.Right_Center:case o.RelationType.Right_Right:this._owner.x+=e;break;case o.RelationType.Top_Top:case o.RelationType.Top_Middle:case o.RelationType.Top_Bottom:case o.RelationType.Middle_Middle:case o.RelationType.Bottom_Top:case o.RelationType.Bottom_Middle:case o.RelationType.Bottom_Bottom:this._owner.y+=i;break;case o.RelationType.Width:case o.RelationType.Height:break;case o.RelationType.LeftExt_Left:case o.RelationType.LeftExt_Right:this._owner!=this._target.parent?(s=this._owner.xMin,this._owner.width=this._owner._rawWidth-e,this._owner.xMin=s+e):this._owner.width=this._owner._rawWidth-e;break;case o.RelationType.RightExt_Left:case o.RelationType.RightExt_Right:this._owner!=this._target.parent?(s=this._owner.xMin,this._owner.width=this._owner._rawWidth+e,this._owner.xMin=s):this._owner.width=this._owner._rawWidth+e;break;case o.RelationType.TopExt_Top:case o.RelationType.TopExt_Bottom:this._owner!=this._target.parent?(s=this._owner.yMin,this._owner.height=this._owner._rawHeight-i,this._owner.yMin=s+i):this._owner.height=this._owner._rawHeight-i;break;case o.RelationType.BottomExt_Top:case o.RelationType.BottomExt_Bottom:this._owner!=this._target.parent?(s=this._owner.yMin,this._owner.height=this._owner._rawHeight+i,this._owner.yMin=s):this._owner.height=this._owner._rawHeight+i}}applyOnSizeChanged(t){var e,i,s=0,a=0,h=0;switch(0==t.axis?(this._target!=this._owner.parent&&(s=this._target.x,this._target.pivotAsAnchor)&&(a=this._target.pivotX),t.percent?0!=this._targetWidth&&(h=this._target._width/this._targetWidth):h=this._target._width-this._targetWidth):(this._target!=this._owner.parent&&(s=this._target.y,this._target.pivotAsAnchor)&&(a=this._target.pivotY),t.percent?0!=this._targetHeight&&(h=this._target._height/this._targetHeight):h=this._target._height-this._targetHeight),t.type){case o.RelationType.Left_Left:t.percent?this._owner.xMin=s+(this._owner.xMin-s)*h:0!=a&&(this._owner.x+=h*-a);break;case o.RelationType.Left_Center:t.percent?this._owner.xMin=s+(this._owner.xMin-s)*h:this._owner.x+=h*(.5-a);break;case o.RelationType.Left_Right:t.percent?this._owner.xMin=s+(this._owner.xMin-s)*h:this._owner.x+=h*(1-a);break;case o.RelationType.Center_Center:t.percent?this._owner.xMin=s+(this._owner.xMin+.5*this._owner._rawWidth-s)*h-.5*this._owner._rawWidth:this._owner.x+=h*(.5-a);break;case o.RelationType.Right_Left:t.percent?this._owner.xMin=s+(this._owner.xMin+this._owner._rawWidth-s)*h-this._owner._rawWidth:0!=a&&(this._owner.x+=h*-a);break;case o.RelationType.Right_Center:t.percent?this._owner.xMin=s+(this._owner.xMin+this._owner._rawWidth-s)*h-this._owner._rawWidth:this._owner.x+=h*(.5-a);break;case o.RelationType.Right_Right:t.percent?this._owner.xMin=s+(this._owner.xMin+this._owner._rawWidth-s)*h-this._owner._rawWidth:this._owner.x+=h*(1-a);break;case o.RelationType.Top_Top:t.percent?this._owner.yMin=s+(this._owner.yMin-s)*h:0!=a&&(this._owner.y+=h*-a);break;case o.RelationType.Top_Middle:t.percent?this._owner.yMin=s+(this._owner.yMin-s)*h:this._owner.y+=h*(.5-a);break;case o.RelationType.Top_Bottom:t.percent?this._owner.yMin=s+(this._owner.yMin-s)*h:this._owner.y+=h*(1-a);break;case o.RelationType.Middle_Middle:t.percent?this._owner.yMin=s+(this._owner.yMin+.5*this._owner._rawHeight-s)*h-.5*this._owner._rawHeight:this._owner.y+=h*(.5-a);break;case o.RelationType.Bottom_Top:t.percent?this._owner.yMin=s+(this._owner.yMin+this._owner._rawHeight-s)*h-this._owner._rawHeight:0!=a&&(this._owner.y+=h*-a);break;case o.RelationType.Bottom_Middle:t.percent?this._owner.yMin=s+(this._owner.yMin+this._owner._rawHeight-s)*h-this._owner._rawHeight:this._owner.y+=h*(.5-a);break;case o.RelationType.Bottom_Bottom:t.percent?this._owner.yMin=s+(this._owner.yMin+this._owner._rawHeight-s)*h-this._owner._rawHeight:this._owner.y+=h*(1-a);break;case o.RelationType.Width:e=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-this._target.initWidth:this._owner._rawWidth-this._targetWidth,t.percent&&(e*=h),this._target==this._owner.parent?this._owner.pivotAsAnchor?(i=this._owner.xMin,this._owner.setSize(this._target._width+e,this._owner._rawHeight,!0),this._owner.xMin=i):this._owner.setSize(this._target._width+e,this._owner._rawHeight,!0):this._owner.width=this._target._width+e;break;case o.RelationType.Height:e=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-this._target.initHeight:this._owner._rawHeight-this._targetHeight,t.percent&&(e*=h),this._target==this._owner.parent?this._owner.pivotAsAnchor?(i=this._owner.yMin,this._owner.setSize(this._owner._rawWidth,this._target._height+e,!0),this._owner.yMin=i):this._owner.setSize(this._owner._rawWidth,this._target._height+e,!0):this._owner.height=this._target._height+e;break;case o.RelationType.LeftExt_Left:i=this._owner.xMin,e=t.percent?s+(i-s)*h-i:h*-a,this._owner.width=this._owner._rawWidth-e,this._owner.xMin=i+e;break;case o.RelationType.LeftExt_Right:i=this._owner.xMin,e=t.percent?s+(i-s)*h-i:h*(1-a),this._owner.width=this._owner._rawWidth-e,this._owner.xMin=i+e;break;case o.RelationType.RightExt_Left:i=this._owner.xMin,e=t.percent?s+(i+this._owner._rawWidth-s)*h-(i+this._owner._rawWidth):h*-a,this._owner.width=this._owner._rawWidth+e,this._owner.xMin=i;break;case o.RelationType.RightExt_Right:i=this._owner.xMin,t.percent?this._owner==this._target.parent?this._owner._underConstruct?this._owner.width=s+this._target._width-this._target._width*a+(this._owner.sourceWidth-s-this._target.initWidth+this._target.initWidth*a)*h:this._owner.width=s+(this._owner._rawWidth-s)*h:(e=s+(i+this._owner._rawWidth-s)*h-(i+this._owner._rawWidth),this._owner.width=this._owner._rawWidth+e,this._owner.xMin=i):this._owner==this._target.parent?this._owner._underConstruct?this._owner.width=this._owner.sourceWidth+(this._target._width-this._target.initWidth)*(1-a):this._owner.width=this._owner._rawWidth+h*(1-a):(this._owner.width=this._owner._rawWidth+(e=h*(1-a)),this._owner.xMin=i);break;case o.RelationType.TopExt_Top:i=this._owner.yMin,e=t.percent?s+(i-s)*h-i:h*-a,this._owner.height=this._owner._rawHeight-e,this._owner.yMin=i+e;break;case o.RelationType.TopExt_Bottom:i=this._owner.yMin,e=t.percent?s+(i-s)*h-i:h*(1-a),this._owner.height=this._owner._rawHeight-e,this._owner.yMin=i+e;break;case o.RelationType.BottomExt_Top:i=this._owner.yMin,e=t.percent?s+(i+this._owner._rawHeight-s)*h-(i+this._owner._rawHeight):h*-a,this._owner.height=this._owner._rawHeight+e,this._owner.yMin=i;break;case o.RelationType.BottomExt_Bottom:i=this._owner.yMin,t.percent?this._owner==this._target.parent?this._owner._underConstruct?this._owner.height=s+this._target._height-this._target._height*a+(this._owner.sourceHeight-s-this._target.initHeight+this._target.initHeight*a)*h:this._owner.height=s+(this._owner._rawHeight-s)*h:(e=s+(i+this._owner._rawHeight-s)*h-(i+this._owner._rawHeight),this._owner.height=this._owner._rawHeight+e,this._owner.yMin=i):this._owner==this._target.parent?this._owner._underConstruct?this._owner.height=this._owner.sourceHeight+(this._target._height-this._target.initHeight)*(1-a):this._owner.height=this._owner._rawHeight+h*(1-a):(this._owner.height=this._owner._rawHeight+(e=h*(1-a)),this._owner.yMin=i)}}addRefTarget(){this._target!=this._owner.parent&&this._target.on(o.Events.XY_CHANGED,this,this.__targetXYChanged),this._target.on(o.Events.SIZE_CHANGED,this,this.__targetSizeChanged),this._target.on(o.Events.SIZE_DELAY_CHANGE,this,this.__targetSizeWillChange),this._targetX=this._target.x,this._targetY=this._target.y,this._targetWidth=this._target._width,this._targetHeight=this._target._height}releaseRefTarget(){null!=this._target.displayObject&&(this._target.off(o.Events.XY_CHANGED,this,this.__targetXYChanged),this._target.off(o.Events.SIZE_CHANGED,this,this.__targetSizeChanged),this._target.off(o.Events.SIZE_DELAY_CHANGE,this,this.__targetSizeWillChange))}__targetXYChanged(){if(null!=this._owner.relations.handling||null!=this._owner.group&&this._owner.group._updating)this._targetX=this._target.x,this._targetY=this._target.y;else{this._owner.relations.handling=this._target;for(var t=this._owner.x,e=this._owner.y,i=this._target.x-this._targetX,s=this._target.y-this._targetY,a=this._defs.length,h=0;h<a;h++)this.applyOnXYChanged(this._defs[h],i,s);if(this._targetX=this._target.x,this._targetY=this._target.y,(t!=this._owner.x||e!=this._owner.y)&&(t=this._owner.x-t,e=this._owner.y-e,this._owner.updateGearFromRelations(1,t,e),this._owner.parent)&&0<this._owner.parent._transitions.length)for(var a=this._owner.parent._transitions.length,r=0;r<a;r++)this._owner.parent._transitions[r].updateFromRelations(this._owner.id,t,e);this._owner.relations.handling=null}}__targetSizeChanged(){if(this._owner.relations.sizeDirty&&this._owner.relations.ensureRelationsSizeCorrect(),null!=this._owner.relations.handling)this._targetWidth=this._target._width,this._targetHeight=this._target._height;else{this._owner.relations.handling=this._target;for(var t=this._owner.x,e=this._owner.y,i=this._owner._rawWidth,s=this._owner._rawHeight,a=this._defs.length,h=0;h<a;h++)this.applyOnSizeChanged(this._defs[h]);if(this._targetWidth=this._target._width,this._targetHeight=this._target._height,(t!=this._owner.x||e!=this._owner.y)&&(t=this._owner.x-t,e=this._owner.y-e,this._owner.updateGearFromRelations(1,t,e),this._owner.parent)&&0<this._owner.parent._transitions.length)for(var a=this._owner.parent._transitions.length,r=0;r<a;r++)this._owner.parent._transitions[r].updateFromRelations(this._owner.id,t,e);i==this._owner._rawWidth&&s==this._owner._rawHeight||(i=this._owner._rawWidth-i,s=this._owner._rawHeight-s,this._owner.updateGearFromRelations(2,i,s)),this._owner.relations.handling=null}}__targetSizeWillChange(){this._owner.relations.sizeDirty=!0}};class h{constructor(){}copyFrom(t){this.percent=t.percent,this.type=t.type,this.axis=t.axis}}}(fgui),function(_){_.Relations=class{constructor(t){this._owner=t,this._items=[]}add(t,e,i){for(var s=this._items.length,a=0;a<s;a++){var h=this._items[a];if(h.target==t)return void h.add(e,i)}var r=new _.RelationItem(this._owner);r.target=t,r.add(e,i),this._items.push(r)}remove(t,e){e=e||0;for(var i=this._items.length,s=0;s<i;){var a=this._items[s];a.target==t&&(a.remove(e),a.isEmpty)?(a.dispose(),this._items.splice(s,1),i--):s++}}contains(t){for(var e=this._items.length,i=0;i<e;i++)if(this._items[i].target==t)return!0;return!1}clearFor(t){for(var e=this._items.length,i=0;i<e;){var s=this._items[i];s.target==t?(s.dispose(),this._items.splice(i,1),e--):i++}}clearAll(){for(var t=this._items.length,e=0;e<t;e++)this._items[e].dispose();this._items.length=0}copyFrom(t){this.clearAll();for(var e=t._items,i=e.length,s=0;s<i;s++){var a=e[s],h=new _.RelationItem(this._owner);h.copyFrom(a),this._items.push(h)}}dispose(){this.clearAll()}onOwnerSizeChanged(t,e,i){if(0!=this._items.length)for(var s=this._items.length,a=0;a<s;a++)this._items[a].applyOnSelfResized(t,e,i)}ensureRelationsSizeCorrect(){if(0!=this._items.length){this.sizeDirty=!1;for(var t=this._items.length,e=0;e<t;e++)this._items[e].target.ensureSizeCorrect()}}get empty(){return 0==this._items.length}setup(t,e){for(var i=t.readByte(),s=0;s<i;s++)for(var a=t.getInt16(),a=-1==a?this._owner.parent:(e?this._owner:this._owner.parent).getChildAt(a),h=new _.RelationItem(this._owner),r=(h.target=a,this._items.push(h),t.readByte()),n=0;n<r;n++){var o=t.readByte(),l=t.readBool();h.internalAdd(o,l)}}}}(fgui),function(_){class d{constructor(t){this._owner=t,this._maskContainer=new Laya.Sprite,this._owner.displayObject.addChild(this._maskContainer),this._container=this._owner._container,this._container.pos(0,0),this._maskContainer.addChild(this._container),this._mouseWheelEnabled=!0,this._xPos=0,this._yPos=0,this._aniFlag=0,this._tweening=0,this._loop=0,this._footerLockedSize=0,this._headerLockedSize=0,this._scrollBarMargin=new _.Margin,this._viewSize=new Laya.Point,this._contentSize=new Laya.Point,this._pageSize=new Laya.Point(1,1),this._overlapSize=new Laya.Point,this._tweenTime=new Laya.Point,this._tweenStart=new Laya.Point,this._tweenDuration=new Laya.Point,this._tweenChange=new Laya.Point,this._velocity=new Laya.Point,this._containerPos=new Laya.Point,this._beginTouchPos=new Laya.Point,this._lastTouchPos=new Laya.Point,this._lastTouchGlobalPos=new Laya.Point,this._scrollStep=_.UIConfig.defaultScrollStep,this._mouseWheelStep=2*this._scrollStep,this._decelerationRate=_.UIConfig.defaultScrollDecelerationRate,this._owner.on(Laya.Event.MOUSE_DOWN,this,this.__mouseDown),this._owner.on(Laya.Event.MOUSE_WHEEL,this,this.__mouseWheel)}setup(t){this._scrollType=t.readByte();var e=t.readByte(),i=t.getInt32(),s=(t.readBool()&&(this._scrollBarMargin.top=t.getInt32(),this._scrollBarMargin.bottom=t.getInt32(),this._scrollBarMargin.left=t.getInt32(),this._scrollBarMargin.right=t.getInt32()),t.readS()),a=t.readS(),h=t.readS(),t=t.readS();if(0!=(1&i)&&(this._displayOnLeft=!0),0!=(2&i)&&(this._snapToItem=!0),0!=(4&i)&&(this._displayInDemand=!0),0!=(8&i)&&(this._pageMode=!0),this._touchEffect=!!(16&i)||!(32&i)&&_.UIConfig.defaultScrollTouchEffect,this._bouncebackEffect=!!(64&i)||!(128&i)&&_.UIConfig.defaultScrollBounceEffect,0!=(256&i)&&(this._inertiaDisabled=!0),0==(512&i)&&(this._maskContainer.scrollRect=new Laya.Rectangle),0!=(1024&i)&&(this._floating=!0),0!=(2048&i)&&(this._dontClipMargin=!0),(e=e==_.ScrollBarDisplayType.Default?_.UIConfig.defaultScrollBarDisplay:e)!=_.ScrollBarDisplayType.Hidden){if(this._scrollType==_.ScrollType.Both||this._scrollType==_.ScrollType.Vertical){var r=s||_.UIConfig.verticalScrollBar;if(r){if(this._vtScrollBar=_.UIPackage.createObjectFromURL(r),!this._vtScrollBar)throw"cannot create scrollbar from "+r;this._vtScrollBar.setScrollPane(this,!0),this._owner.displayObject.addChild(this._vtScrollBar.displayObject)}}if((this._scrollType==_.ScrollType.Both||this._scrollType==_.ScrollType.Horizontal)&&(r=a||_.UIConfig.horizontalScrollBar)){if(this._hzScrollBar=_.UIPackage.createObjectFromURL(r),!this._hzScrollBar)throw"cannot create scrollbar from "+r;this._hzScrollBar.setScrollPane(this,!1),this._owner.displayObject.addChild(this._hzScrollBar.displayObject)}e==_.ScrollBarDisplayType.Auto&&(this._scrollBarDisplayAuto=!0),this._scrollBarDisplayAuto&&(this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=!1),this._hzScrollBar)&&(this._hzScrollBar.displayObject.visible=!1)}else this._mouseWheelEnabled=!1;if(h&&(this._header=_.UIPackage.createObjectFromURL(h),!this._header))throw new Error("FairyGUI: cannot create scrollPane this.header from "+h);if(t&&(this._footer=_.UIPackage.createObjectFromURL(t),!this._footer))throw new Error("FairyGUI: cannot create scrollPane this.footer from "+t);(this._header||this._footer)&&(this._refreshBarAxis=this._scrollType==_.ScrollType.Both||this._scrollType==_.ScrollType.Vertical?"y":"x"),this.setSize(this.owner.width,this.owner.height)}dispose(){d.draggingPane==this&&(d.draggingPane=null),0!=this._tweening&&Laya.timer.clear(this,this.tweenUpdate),this._pageController=null,this._hzScrollBar&&this._hzScrollBar.dispose(),this._vtScrollBar&&this._vtScrollBar.dispose(),this._header&&this._header.dispose(),this._footer&&this._footer.dispose()}get owner(){return this._owner}get hzScrollBar(){return this._hzScrollBar}get vtScrollBar(){return this._vtScrollBar}get header(){return this._header}get footer(){return this._footer}get bouncebackEffect(){return this._bouncebackEffect}set bouncebackEffect(t){this._bouncebackEffect=t}get touchEffect(){return this._touchEffect}set touchEffect(t){this._touchEffect=t}set scrollStep(t){this._scrollStep=t,0==this._scrollStep&&(this._scrollStep=_.UIConfig.defaultScrollStep),this._mouseWheelStep=2*this._scrollStep}get scrollStep(){return this._scrollStep}get snapToItem(){return this._snapToItem}set snapToItem(t){this._snapToItem=t}get mouseWheelEnabled(){return this._mouseWheelEnabled}set mouseWheelEnabled(t){this._mouseWheelEnabled=t}get decelerationRate(){return this._decelerationRate}set decelerationRate(t){this._decelerationRate=t}get isDragged(){return this._dragged}get percX(){return 0==this._overlapSize.x?0:this._xPos/this._overlapSize.x}set percX(t){this.setPercX(t,!1)}setPercX(t,e){this._owner.ensureBoundsCorrect(),this.setPosX(this._overlapSize.x*_.ToolSet.clamp01(t),e)}get percY(){return 0==this._overlapSize.y?0:this._yPos/this._overlapSize.y}set percY(t){this.setPercY(t,!1)}setPercY(t,e){this._owner.ensureBoundsCorrect(),this.setPosY(this._overlapSize.y*_.ToolSet.clamp01(t),e)}get posX(){return this._xPos}set posX(t){this.setPosX(t,!1)}setPosX(t,e){this._owner.ensureBoundsCorrect(),1==this._loop&&(t=this.loopCheckingNewPos(t,"x")),(t=_.ToolSet.clamp(t,0,this._overlapSize.x))!=this._xPos&&(this._xPos=t,this.posChanged(e))}get posY(){return this._yPos}set posY(t){this.setPosY(t,!1)}setPosY(t,e){this._owner.ensureBoundsCorrect(),1==this._loop&&(t=this.loopCheckingNewPos(t,"y")),(t=_.ToolSet.clamp(t,0,this._overlapSize.y))!=this._yPos&&(this._yPos=t,this.posChanged(e))}get contentWidth(){return this._contentSize.x}get contentHeight(){return this._contentSize.y}get viewWidth(){return this._viewSize.x}set viewWidth(t){t=t+this._owner.margin.left+this._owner.margin.right,this._vtScrollBar&&!this._floating&&(t+=this._vtScrollBar.width),this._owner.width=t}get viewHeight(){return this._viewSize.y}set viewHeight(t){t=t+this._owner.margin.top+this._owner.margin.bottom,this._hzScrollBar&&!this._floating&&(t+=this._hzScrollBar.height),this._owner.height=t}get currentPageX(){var t;return this._pageMode?(t=Math.floor(this._xPos/this._pageSize.x),this._xPos-t*this._pageSize.x>.5*this._pageSize.x&&t++,t):0}set currentPageX(t){this.setCurrentPageX(t,!1)}get currentPageY(){var t;return this._pageMode?(t=Math.floor(this._yPos/this._pageSize.y),this._yPos-t*this._pageSize.y>.5*this._pageSize.y&&t++,t):0}set currentPageY(t){this.setCurrentPageY(t,!1)}setCurrentPageX(t,e){this._pageMode&&(this._owner.ensureBoundsCorrect(),0<this._overlapSize.x)&&this.setPosX(t*this._pageSize.x,e)}setCurrentPageY(t,e){this._pageMode&&(this._owner.ensureBoundsCorrect(),0<this._overlapSize.y)&&this.setPosY(t*this._pageSize.y,e)}get isBottomMost(){return this._yPos==this._overlapSize.y||0==this._overlapSize.y}get isRightMost(){return this._xPos==this._overlapSize.x||0==this._overlapSize.x}get pageController(){return this._pageController}set pageController(t){this._pageController=t}get scrollingPosX(){return _.ToolSet.clamp(-this._container.x,0,this._overlapSize.x)}get scrollingPosY(){return _.ToolSet.clamp(-this._container.y,0,this._overlapSize.y)}scrollTop(t){this.setPercY(0,t)}scrollBottom(t){this.setPercY(1,t)}scrollUp(t,e){t=t||1,this._pageMode?this.setPosY(this._yPos-this._pageSize.y*t,e):this.setPosY(this._yPos-this._scrollStep*t,e)}scrollDown(t,e){t=t||1,this._pageMode?this.setPosY(this._yPos+this._pageSize.y*t,e):this.setPosY(this._yPos+this._scrollStep*t,e)}scrollLeft(t,e){t=t||1,this._pageMode?this.setPosX(this._xPos-this._pageSize.x*t,e):this.setPosX(this._xPos-this._scrollStep*t,e)}scrollRight(t,e){t=t||1,this._pageMode?this.setPosX(this._xPos+this._pageSize.x*t,e):this.setPosX(this._xPos+this._scrollStep*t,e)}scrollToView(t,e,i){var s;this._owner.ensureBoundsCorrect(),this._needRefresh&&this.refresh(),t instanceof _.GObject?t.parent!=this._owner?(t.parent.localToGlobalRect(t.x,t.y,t.width,t.height,a),s=this._owner.globalToLocalRect(a.x,a.y,a.width,a.height,a)):(s=a).setTo(t.x,t.y,t.width,t.height):s=t,0<this._overlapSize.y&&(t=this._yPos+this._viewSize.y,i||s.y<=this._yPos||s.height>=this._viewSize.y?this._pageMode?this.setPosY(Math.floor(s.y/this._pageSize.y)*this._pageSize.y,e):this.setPosY(s.y,e):s.y+s.height>t&&(this._pageMode?this.setPosY(Math.floor(s.y/this._pageSize.y)*this._pageSize.y,e):s.height<=this._viewSize.y/2?this.setPosY(s.y+2*s.height-this._viewSize.y,e):this.setPosY(s.y+s.height-this._viewSize.y,e))),0<this._overlapSize.x&&(t=this._xPos+this._viewSize.x,i||s.x<=this._xPos||s.width>=this._viewSize.x?this._pageMode?this.setPosX(Math.floor(s.x/this._pageSize.x)*this._pageSize.x,e):this.setPosX(s.x,e):s.x+s.width>t&&(this._pageMode?this.setPosX(Math.floor(s.x/this._pageSize.x)*this._pageSize.x,e):s.width<=this._viewSize.x/2?this.setPosX(s.x+2*s.width-this._viewSize.x,e):this.setPosX(s.x+s.width-this._viewSize.x,e))),!e&&this._needRefresh&&this.refresh()}isChildInView(t){if(0<this._overlapSize.y){var e=t.y+this._container.y;if(e<-t.height||e>this._viewSize.y)return!1}return!(0<this._overlapSize.x&&((e=t.x+this._container.x)<-t.width||e>this._viewSize.x))}cancelDragging(){this._owner.displayObject.stage.off(Laya.Event.MOUSE_MOVE,this,this.__mouseMove),this._owner.displayObject.stage.off(Laya.Event.MOUSE_UP,this,this.__mouseUp),this._owner.displayObject.stage.off(Laya.Event.CLICK,this,this.__click),d.draggingPane==this&&(d.draggingPane=null),c=0,this._dragged=!1,this._maskContainer.mouseEnabled=!0}lockHeader(t){this._headerLockedSize!=t&&(this._headerLockedSize=t,!this._refreshEventDispatching)&&0<=this._container[this._refreshBarAxis]&&(this._tweenStart.setTo(this._container.x,this._container.y),this._tweenChange.setTo(0,0),this._tweenChange[this._refreshBarAxis]=this._headerLockedSize-this._tweenStart[this._refreshBarAxis],this._tweenDuration.setTo(_.TWEEN_TIME_DEFAULT,_.TWEEN_TIME_DEFAULT),this.startTween(2))}lockFooter(t){this._footerLockedSize!=t&&(this._footerLockedSize=t,!this._refreshEventDispatching)&&this._container[this._refreshBarAxis]<=-this._overlapSize[this._refreshBarAxis]&&(this._tweenStart.setTo(this._container.x,this._container.y),this._tweenChange.setTo(0,0),0==(t=this._overlapSize[this._refreshBarAxis])?t=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):t+=this._footerLockedSize,this._tweenChange[this._refreshBarAxis]=-t-this._tweenStart[this._refreshBarAxis],this._tweenDuration.setTo(_.TWEEN_TIME_DEFAULT,_.TWEEN_TIME_DEFAULT),this.startTween(2))}onOwnerSizeChanged(){this.setSize(this._owner.width,this._owner.height),this.posChanged(!1)}handleControllerChanged(t){this._pageController==t&&(this._scrollType==_.ScrollType.Horizontal?this.setCurrentPageX(t.selectedIndex,!0):this.setCurrentPageY(t.selectedIndex,!0))}updatePageController(){var t,e;null==this._pageController||this._pageController.changing||(e=this._scrollType==_.ScrollType.Horizontal?this.currentPageX:this.currentPageY)<this._pageController.pageCount&&(t=this._pageController,this._pageController=null,t.selectedIndex=e,this._pageController=t)}adjustMaskContainer(){var t=0,e=0;this._dontClipMargin?this._displayOnLeft&&this._vtScrollBar&&!this._floating&&(t=this._vtScrollBar.width):(t=this._displayOnLeft&&this._vtScrollBar&&!this._floating?this._owner.margin.left+this._vtScrollBar.width:this._owner.margin.left,e=this._owner.margin.top),this._maskContainer.pos(t,e),t=this._owner._alignOffset.x,e=this._owner._alignOffset.y,0==t&&0==e&&!this._dontClipMargin||this._alignContainer||(this._alignContainer=new Laya.Sprite,this._maskContainer.addChild(this._alignContainer),this._alignContainer.addChild(this._container)),this._alignContainer&&(this._dontClipMargin&&(t+=this._owner.margin.left,e+=this._owner.margin.top),this._alignContainer.pos(t,e))}setSize(t,e){this.adjustMaskContainer(),this._hzScrollBar&&(this._hzScrollBar.y=e-this._hzScrollBar.height,this._vtScrollBar?(this._hzScrollBar.width=t-this._vtScrollBar.width-this._scrollBarMargin.left-this._scrollBarMargin.right,this._displayOnLeft?this._hzScrollBar.x=this._scrollBarMargin.left+this._vtScrollBar.width:this._hzScrollBar.x=this._scrollBarMargin.left):(this._hzScrollBar.width=t-this._scrollBarMargin.left-this._scrollBarMargin.right,this._hzScrollBar.x=this._scrollBarMargin.left)),this._vtScrollBar&&(this._displayOnLeft||(this._vtScrollBar.x=t-this._vtScrollBar.width),this._hzScrollBar?this._vtScrollBar.height=e-this._hzScrollBar.height-this._scrollBarMargin.top-this._scrollBarMargin.bottom:this._vtScrollBar.height=e-this._scrollBarMargin.top-this._scrollBarMargin.bottom,this._vtScrollBar.y=this._scrollBarMargin.top),this._viewSize.x=t,this._viewSize.y=e,this._hzScrollBar&&!this._floating&&(this._viewSize.y-=this._hzScrollBar.height),this._vtScrollBar&&!this._floating&&(this._viewSize.x-=this._vtScrollBar.width),this._viewSize.x-=this._owner.margin.left+this._owner.margin.right,this._viewSize.y-=this._owner.margin.top+this._owner.margin.bottom,this._viewSize.x=Math.max(1,this._viewSize.x),this._viewSize.y=Math.max(1,this._viewSize.y),this._pageSize.x=this._viewSize.x,this._pageSize.y=this._viewSize.y,this.handleSizeChanged()}setContentSize(t,e){this._contentSize.x==t&&this._contentSize.y==e||(this._contentSize.x=t,this._contentSize.y=e,this.handleSizeChanged())}changeContentSizeOnScrolling(t,e,i,s){var a=this._xPos==this._overlapSize.x,h=this._yPos==this._overlapSize.y;this._contentSize.x+=t,this._contentSize.y+=e,this.handleSizeChanged(),1==this._tweening?(0!=t&&a&&this._tweenChange.x<0&&(this._xPos=this._overlapSize.x,this._tweenChange.x=-this._xPos-this._tweenStart.x),0!=e&&h&&this._tweenChange.y<0&&(this._yPos=this._overlapSize.y,this._tweenChange.y=-this._yPos-this._tweenStart.y)):2==this._tweening?(0!=i&&(this._container.x-=i,this._tweenStart.x-=i,this._xPos=-this._container.x),0!=s&&(this._container.y-=s,this._tweenStart.y-=s,this._yPos=-this._container.y)):this._dragged?(0!=i&&(this._container.x-=i,this._containerPos.x-=i,this._xPos=-this._container.x),0!=s&&(this._container.y-=s,this._containerPos.y-=s,this._yPos=-this._container.y)):(0!=t&&a&&(this._xPos=this._overlapSize.x,this._container.x=-this._xPos),0!=e&&h&&(this._yPos=this._overlapSize.y,this._container.y=-this._yPos)),this._pageMode&&this.updatePageController()}handleSizeChanged(){this._displayInDemand&&(this._vScrollNone=this._contentSize.y<=this._viewSize.y,this._hScrollNone=this._contentSize.x<=this._viewSize.x),this._vtScrollBar&&(0==this._contentSize.y?this._vtScrollBar.setDisplayPerc(0):this._vtScrollBar.setDisplayPerc(Math.min(1,this._viewSize.y/this._contentSize.y))),this._hzScrollBar&&(0==this._contentSize.x?this._hzScrollBar.setDisplayPerc(0):this._hzScrollBar.setDisplayPerc(Math.min(1,this._viewSize.x/this._contentSize.x))),this.updateScrollBarVisible();var t=this._maskContainer.scrollRect;t&&(t.width=this._viewSize.x,t.height=this._viewSize.y,this._vScrollNone&&this._vtScrollBar&&(t.width+=this._vtScrollBar.width),this._hScrollNone&&this._hzScrollBar&&(t.height+=this._hzScrollBar.height),this._dontClipMargin&&(t.width+=this._owner.margin.left+this._owner.margin.right,t.height+=this._owner.margin.top+this._owner.margin.bottom),this._maskContainer.scrollRect=t),this._scrollType==_.ScrollType.Horizontal||this._scrollType==_.ScrollType.Both?this._overlapSize.x=Math.ceil(Math.max(0,this._contentSize.x-this._viewSize.x)):this._overlapSize.x=0,this._scrollType==_.ScrollType.Vertical||this._scrollType==_.ScrollType.Both?this._overlapSize.y=Math.ceil(Math.max(0,this._contentSize.y-this._viewSize.y)):this._overlapSize.y=0,this._xPos=_.ToolSet.clamp(this._xPos,0,this._overlapSize.x),this._yPos=_.ToolSet.clamp(this._yPos,0,this._overlapSize.y),null!=this._refreshBarAxis?(0==(t=this._overlapSize[this._refreshBarAxis])?t=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):t+=this._footerLockedSize,"x"==this._refreshBarAxis?this._container.pos(_.ToolSet.clamp(this._container.x,-t,this._headerLockedSize),_.ToolSet.clamp(this._container.y,-this._overlapSize.y,0)):this._container.pos(_.ToolSet.clamp(this._container.x,-this._overlapSize.x,0),_.ToolSet.clamp(this._container.y,-t,this._headerLockedSize)),this._header&&("x"==this._refreshBarAxis?this._header.height=this._viewSize.y:this._header.width=this._viewSize.x),this._footer&&("y"==this._refreshBarAxis?this._footer.height=this._viewSize.y:this._footer.width=this._viewSize.x)):this._container.pos(_.ToolSet.clamp(this._container.x,-this._overlapSize.x,0),_.ToolSet.clamp(this._container.y,-this._overlapSize.y,0)),this.updateScrollBarPos(),this._pageMode&&this.updatePageController()}posChanged(t){0==this._aniFlag?this._aniFlag=t?1:-1:1!=this._aniFlag||t||(this._aniFlag=-1),this._needRefresh=!0,Laya.timer.callLater(this,this.refresh)}refresh(){this._owner.displayObject&&(this._needRefresh=!1,Laya.timer.clear(this,this.refresh),(this._pageMode||this._snapToItem)&&(e.setTo(-this._xPos,-this._yPos),this.alignPosition(e,!1),this._xPos=-e.x,this._yPos=-e.y),this.refresh2(),_.Events.dispatch(_.Events.SCROLL,this._owner.displayObject),this._needRefresh&&(this._needRefresh=!1,Laya.timer.clear(this,this.refresh),this.refresh2()),this.updateScrollBarPos(),this._aniFlag=0)}refresh2(){var t,e;1!=this._aniFlag||this._dragged?(0!=this._tweening&&this.killTween(),this._container.pos(Math.floor(-this._xPos),Math.floor(-this._yPos)),this.loopCheckingCurrent()):(t=0<this._overlapSize.x?-Math.floor(this._xPos):(0!=this._container.x&&(this._container.x=0),0),e=0<this._overlapSize.y?-Math.floor(this._yPos):(0!=this._container.y&&(this._container.y=0),0),t!=this._container.x||e!=this._container.y?(this._tweenDuration.setTo(i,i),this._tweenStart.setTo(this._container.x,this._container.y),this._tweenChange.setTo(t-this._tweenStart.x,e-this._tweenStart.y),this.startTween(1)):0!=this._tweening&&this.killTween()),this._pageMode&&this.updatePageController()}__mouseDown(){var t;this._touchEffect&&(0!=this._tweening?(this.killTween(),this._dragged=!0):this._dragged=!1,t=this._owner.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY,u),this._containerPos.setTo(this._container.x,this._container.y),this._beginTouchPos.setTo(t.x,t.y),this._lastTouchPos.setTo(t.x,t.y),this._lastTouchGlobalPos.setTo(Laya.stage.mouseX,Laya.stage.mouseY),this._isHoldAreaDone=!1,this._velocity.setTo(0,0),this._velocityScale=1,this._lastMoveTime=Laya.timer.currTimer/1e3,this._owner.displayObject.stage.on(Laya.Event.MOUSE_MOVE,this,this.__mouseMove),this._owner.displayObject.stage.on(Laya.Event.MOUSE_UP,this,this.__mouseUp),this._owner.displayObject.stage.on(Laya.Event.CLICK,this,this.__click))}__mouseMove(){if(this._touchEffect&&!this.owner.isDisposed&&!(d.draggingPane&&d.draggingPane!=this||_.GObject.draggingObject)){var t=_.UIConfig.touchScrollSensitivity,e=this._owner.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY,u);if(this._scrollType==_.ScrollType.Vertical){if(!this._isHoldAreaDone){if(c|=1,(i=Math.abs(this._beginTouchPos.y-e.y))<t)return;if(0!=(2&c)&&i<Math.abs(this._beginTouchPos.x-e.x))return}l=!0}else if(this._scrollType==_.ScrollType.Horizontal){if(!this._isHoldAreaDone){if(c|=2,(i=Math.abs(this._beginTouchPos.x-e.x))<t)return;if(0!=(1&c)&&i<Math.abs(this._beginTouchPos.y-e.y))return}o=!0}else{if(c=3,!this._isHoldAreaDone&&(i=Math.abs(this._beginTouchPos.y-e.y))<t&&(i=Math.abs(this._beginTouchPos.x-e.x))<t)return;l=o=!0}var i=Math.floor(this._containerPos.x+e.x-this._beginTouchPos.x),t=Math.floor(this._containerPos.y+e.y-this._beginTouchPos.y),s=(l&&(0<t?this._bouncebackEffect?this._header&&0!=this._header.maxHeight?this._container.y=Math.floor(Math.min(.5*t,this._header.maxHeight)):this._container.y=Math.floor(Math.min(.5*t,this._viewSize.y*_.PULL_RATIO)):this._container.y=0:t<-this._overlapSize.y?this._bouncebackEffect?this._footer&&0<this._footer.maxHeight?this._container.y=Math.floor(Math.max(.5*(t+this._overlapSize.y),-this._footer.maxHeight)-this._overlapSize.y):this._container.y=Math.floor(Math.max(.5*(t+this._overlapSize.y),-this._viewSize.y*_.PULL_RATIO)-this._overlapSize.y):this._container.y=-this._overlapSize.y:this._container.y=t),o&&(0<i?this._bouncebackEffect?this._header&&0!=this._header.maxWidth?this._container.x=Math.floor(Math.min(.5*i,this._header.maxWidth)):this._container.x=Math.floor(Math.min(.5*i,this._viewSize.x*_.PULL_RATIO)):this._container.x=0:i<0-this._overlapSize.x?this._bouncebackEffect?this._footer&&0<this._footer.maxWidth?this._container.x=Math.floor(Math.max(.5*(i+this._overlapSize.x),-this._footer.maxWidth)-this._overlapSize.x):this._container.x=Math.floor(Math.max(.5*(i+this._overlapSize.x),-this._viewSize.x*_.PULL_RATIO)-this._overlapSize.x):this._container.x=-this._overlapSize.x:this._container.x=i),Laya.stage.frameRate==Laya.Stage.FRAME_SLOW?30:60),a=Laya.timer.currTimer/1e3,h=Math.max(a-this._lastMoveTime,1/s),r=e.x-this._lastTouchPos.x,n=e.y-this._lastTouchPos.y,o=(o||(r=0),l||(n=0),0!=h&&(1<(o=h*s-1)&&(l=Math.pow(.833,o),this._velocity.x=this._velocity.x*l,this._velocity.y=this._velocity.y*l),this._velocity.x=_.ToolSet.lerp(this._velocity.x,60*r/s/h,10*h),this._velocity.y=_.ToolSet.lerp(this._velocity.y,60*n/s/h,10*h)),this._lastTouchGlobalPos.x-Laya.stage.mouseX),l=this._lastTouchGlobalPos.y-Laya.stage.mouseY;0!=r?this._velocityScale=Math.abs(o/r):0!=n&&(this._velocityScale=Math.abs(l/n)),this._lastTouchPos.setTo(e.x,e.y),this._lastTouchGlobalPos.setTo(Laya.stage.mouseX,Laya.stage.mouseY),this._lastMoveTime=a,0<this._overlapSize.x&&(this._xPos=_.ToolSet.clamp(-this._container.x,0,this._overlapSize.x)),0<this._overlapSize.y&&(this._yPos=_.ToolSet.clamp(-this._container.y,0,this._overlapSize.y)),0!=this._loop&&(i=this._container.x,t=this._container.y,this.loopCheckingCurrent())&&(this._containerPos.x+=this._container.x-i,this._containerPos.y+=this._container.y-t),(d.draggingPane=this)._isHoldAreaDone=!0,this._dragged=!0,this._maskContainer.mouseEnabled=!1,this.updateScrollBarPos(),this.updateScrollBarVisible(),this._pageMode&&this.updatePageController(),_.Events.dispatch(_.Events.SCROLL,this._owner.displayObject)}}__mouseUp(){if(!this._owner.isDisposed)if(this._owner.displayObject.stage.off(Laya.Event.MOUSE_MOVE,this,this.__mouseMove),this._owner.displayObject.stage.off(Laya.Event.MOUSE_UP,this,this.__mouseUp),this._owner.displayObject.stage.off(Laya.Event.CLICK,this,this.__click),d.draggingPane==this&&(d.draggingPane=null),c=0,this._dragged&&this._touchEffect){this._dragged=!1,this._maskContainer.mouseEnabled=!0,this._tweenStart.setTo(this._container.x,this._container.y),e.setTo(this._tweenStart.x,this._tweenStart.y);var t=!1;if(0<this._container.x?t=!(e.x=0):this._container.x<-this._overlapSize.x&&(e.x=-this._overlapSize.x,t=!0),0<this._container.y?t=!(e.y=0):this._container.y<-this._overlapSize.y&&(e.y=-this._overlapSize.y,t=!0),t)this._tweenChange.setTo(e.x-this._tweenStart.x,e.y-this._tweenStart.y),this._tweenChange.x<-_.UIConfig.touchDragSensitivity||this._tweenChange.y<-_.UIConfig.touchDragSensitivity?(this._refreshEventDispatching=!0,_.Events.dispatch(_.Events.PULL_DOWN_RELEASE,this._owner.displayObject),this._refreshEventDispatching=!1):(this._tweenChange.x>_.UIConfig.touchDragSensitivity||this._tweenChange.y>_.UIConfig.touchDragSensitivity)&&(this._refreshEventDispatching=!0,_.Events.dispatch(_.Events.PULL_UP_RELEASE,this._owner.displayObject),this._refreshEventDispatching=!1),0<this._headerLockedSize&&0==e[this._refreshBarAxis]?(e[this._refreshBarAxis]=this._headerLockedSize,this._tweenChange.x=e.x-this._tweenStart.x,this._tweenChange.y=e.y-this._tweenStart.y):0<this._footerLockedSize&&e[this._refreshBarAxis]==-this._overlapSize[this._refreshBarAxis]&&(0==(t=this._overlapSize[this._refreshBarAxis])?t=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):t+=this._footerLockedSize,e[this._refreshBarAxis]=-t,this._tweenChange.x=e.x-this._tweenStart.x,this._tweenChange.y=e.y-this._tweenStart.y),this._tweenDuration.setTo(_.TWEEN_TIME_DEFAULT,_.TWEEN_TIME_DEFAULT);else{if(this._inertiaDisabled?this._tweenDuration.setTo(_.TWEEN_TIME_DEFAULT,_.TWEEN_TIME_DEFAULT):(t=Laya.stage.frameRate==Laya.Stage.FRAME_SLOW?30:60,1<(t=(Laya.timer.currTimer/1e3-this._lastMoveTime)*t-1)&&(t=Math.pow(.833,t),this._velocity.x=this._velocity.x*t,this._velocity.y=this._velocity.y*t),this.updateTargetAndDuration(this._tweenStart,e)),s.setTo(e.x-this._tweenStart.x,e.y-this._tweenStart.y),this.loopCheckingTarget(e),(this._pageMode||this._snapToItem)&&this.alignPosition(e,!0),this._tweenChange.x=e.x-this._tweenStart.x,this._tweenChange.y=e.y-this._tweenStart.y,0==this._tweenChange.x&&0==this._tweenChange.y)return void this.updateScrollBarVisible();(this._pageMode||this._snapToItem)&&(this.fixDuration("x",s.x),this.fixDuration("y",s.y))}this.startTween(2)}else this._dragged=!1,this._maskContainer.mouseEnabled=!0}__click(){this._dragged=!1}__mouseWheel(t){this._mouseWheelEnabled&&(t=0<(t=t.delta)?-1:t<0?1:0,0<this._overlapSize.x&&0==this._overlapSize.y?this._pageMode?this.setPosX(this._xPos+this._pageSize.x*t,!1):this.setPosX(this._xPos+this._mouseWheelStep*t,!1):this._pageMode?this.setPosY(this._yPos+this._pageSize.y*t,!1):this.setPosY(this._yPos+this._mouseWheelStep*t,!1))}updateScrollBarPos(){this._vtScrollBar&&this._vtScrollBar.setScrollPerc(0==this._overlapSize.y?0:_.ToolSet.clamp(-this._container.y,0,this._overlapSize.y)/this._overlapSize.y),this._hzScrollBar&&this._hzScrollBar.setScrollPerc(0==this._overlapSize.x?0:_.ToolSet.clamp(-this._container.x,0,this._overlapSize.x)/this._overlapSize.x),this.checkRefreshBar()}updateScrollBarVisible(){this._vtScrollBar&&(this._viewSize.y<=this._vtScrollBar.minSize||this._vScrollNone?this._vtScrollBar.displayObject.visible=!1:this.updateScrollBarVisible2(this._vtScrollBar)),this._hzScrollBar&&(this._viewSize.x<=this._hzScrollBar.minSize||this._hScrollNone?this._hzScrollBar.displayObject.visible=!1:this.updateScrollBarVisible2(this._hzScrollBar))}updateScrollBarVisible2(t){this._scrollBarDisplayAuto&&_.GTween.kill(t,!1,"alpha"),!this._scrollBarDisplayAuto||0!=this._tweening||this._dragged||t.gripDragging?(t.alpha=1,t.displayObject.visible=!0):t.displayObject.visible&&_.GTween.to(1,0,.5).setDelay(.5).onComplete(this.__barTweenComplete,this).setTarget(t,"alpha")}__barTweenComplete(t){t=t.target;t.alpha=1,t.displayObject.visible=!1}getLoopPartSize(t,e){return(this._contentSize[e]+("x"==e?this._owner.columnGap:this._owner.lineGap))/t}loopCheckingCurrent(){var t=!1;return 1==this._loop&&0<this._overlapSize.x?this._xPos<.001?(this._xPos+=this.getLoopPartSize(2,"x"),t=!0):this._xPos>=this._overlapSize.x&&(this._xPos-=this.getLoopPartSize(2,"x"),t=!0):2==this._loop&&0<this._overlapSize.y&&(this._yPos<.001?(this._yPos+=this.getLoopPartSize(2,"y"),t=!0):this._yPos>=this._overlapSize.y&&(this._yPos-=this.getLoopPartSize(2,"y"),t=!0)),t&&this._container.pos(Math.floor(-this._xPos),Math.floor(-this._yPos)),t}loopCheckingTarget(t){1==this._loop&&this.loopCheckingTarget2(t,"x"),2==this._loop&&this.loopCheckingTarget2(t,"y")}loopCheckingTarget2(t,e){var i,s;0<t[e]?(i=this.getLoopPartSize(2,e),(s=this._tweenStart[e]-i)<=0&&s>=-this._overlapSize[e]&&(t[e]-=i,this._tweenStart[e]=s)):t[e]<-this._overlapSize[e]&&(i=this.getLoopPartSize(2,e),(s=this._tweenStart[e]+i)<=0)&&s>=-this._overlapSize[e]&&(t[e]+=i,this._tweenStart[e]=s)}loopCheckingNewPos(t,e){var i,s,a;return 0!=this._overlapSize[e]&&(i="x"==e?this._xPos:this._yPos,s=!1,t<.001?i<(t+=this.getLoopPartSize(2,e))&&(a=this.getLoopPartSize(6,e),a=Math.ceil((t-i)/a)*a,i=_.ToolSet.clamp(i+a,0,this._overlapSize[e]),s=!0):t>=this._overlapSize[e]&&(t-=this.getLoopPartSize(2,e))<i&&(a=this.getLoopPartSize(6,e),a=Math.ceil((i-t)/a)*a,i=_.ToolSet.clamp(i-a,0,this._overlapSize[e]),s=!0),s)&&("x"==e?this._container.x=-Math.floor(i):this._container.y=-Math.floor(i)),t}alignPosition(t,e){var i,s;this._pageMode?(t.x=this.alignByPage(t.x,"x",e),t.y=this.alignByPage(t.y,"y",e)):this._snapToItem&&(s=i=0,e&&(i=t.x-this._containerPos.x,s=t.y-this._containerPos.y),e=this._owner.getSnappingPositionWithDir(-t.x,-t.y,i,s,u),t.x<0&&t.x>-this._overlapSize.x&&(t.x=-e.x),t.y<0)&&t.y>-this._overlapSize.y&&(t.y=-e.y)}alignByPage(t,e,i){var s,a,h,r;return 0<t?s=0:t<-this._overlapSize[e]?s=Math.ceil(this._contentSize[e]/this._pageSize[e])-1:(s=Math.floor(-t/this._pageSize[e]),r=i?t-this._containerPos[e]:t-this._container[e],h=Math.min(this._pageSize[e],this._contentSize[e]-(s+1)*this._pageSize[e]),a=-t-s*this._pageSize[e],Math.abs(r)>this._pageSize[e]?.5*h<a&&s++:a>h*(r<0?_.UIConfig.defaultScrollPagingThreshold:1-_.UIConfig.defaultScrollPagingThreshold)&&s++,(t=-s*this._pageSize[e])<-this._overlapSize[e]&&(t=-this._overlapSize[e])),t=i&&(h=0<(a=this._tweenStart[e])?0:a<-this._overlapSize[e]?Math.ceil(this._contentSize[e]/this._pageSize[e])-1:Math.floor(-a/this._pageSize[e]),r=Math.floor(-this._containerPos[e]/this._pageSize[e]),1<Math.abs(s-r))&&Math.abs(h-r)<=1?-(s=r<s?r+1:r-1)*this._pageSize[e]:t}updateTargetAndDuration(t,e){e.x=this.updateTargetAndDuration2(t.x,"x"),e.y=this.updateTargetAndDuration2(t.y,"y")}updateTargetAndDuration2(t,e){var i,s,a=this._velocity[e],h=0;return 0<t?t=0:t<-this._overlapSize[e]?t=-this._overlapSize[e]:(i=Math.abs(a)*this._velocityScale,Laya.Browser.onMobile&&(i*=1136/Math.max(Laya.stage.width,Laya.stage.height)),s=0,this._pageMode||!Laya.Browser.onMobile?500<i&&(s=Math.pow((i-500)/500,2)):1e3<i&&(s=Math.pow((i-1e3)/1e3,2)),0!=s&&(i*=s=1<s?1:s,this._velocity[e]=a*=s,h=Math.log(60/i)/Math.log(this._decelerationRate)/60,t+=Math.floor(a*h*.4))),h<_.TWEEN_TIME_DEFAULT&&(h=_.TWEEN_TIME_DEFAULT),this._tweenDuration[e]=h,t}fixDuration(t,e){0==this._tweenChange[t]||Math.abs(this._tweenChange[t])>=Math.abs(e)||((e=Math.abs(this._tweenChange[t]/e)*this._tweenDuration[t])<_.TWEEN_TIME_DEFAULT&&(e=_.TWEEN_TIME_DEFAULT),this._tweenDuration[t]=e)}startTween(t){this._tweenTime.setTo(0,0),this._tweening=t,Laya.timer.frameLoop(1,this,this.tweenUpdate),this.updateScrollBarVisible()}killTween(){1==this._tweening&&(this._container.pos(this._tweenStart.x+this._tweenChange.x,this._tweenStart.y+this._tweenChange.y),_.Events.dispatch(_.Events.SCROLL,this._owner.displayObject)),this._tweening=0,Laya.timer.clear(this,this.tweenUpdate),this.updateScrollBarVisible(),_.Events.dispatch(_.Events.SCROLL_END,this._owner.displayObject)}checkRefreshBar(){var t,e,i;(this._header||this._footer)&&(t=this._container[this._refreshBarAxis],this._header&&(0<t?(this._header.displayObject.parent||this._maskContainer.addChildAt(this._header.displayObject,0),(e=u).setTo(this._header.width,this._header.height),e[this._refreshBarAxis]=t,this._header.setSize(e.x,e.y)):this._header.displayObject.parent&&this._maskContainer.removeChild(this._header.displayObject)),this._footer)&&(t<-(i=this._overlapSize[this._refreshBarAxis])||0==i&&0<this._footerLockedSize?(this._footer.displayObject.parent||this._maskContainer.addChildAt(this._footer.displayObject,0),(e=u).setTo(this._footer.x,this._footer.y),e[this._refreshBarAxis]=0<i?t+this._contentSize[this._refreshBarAxis]:Math.max(Math.min(t+this._viewSize[this._refreshBarAxis],this._viewSize[this._refreshBarAxis]-this._footerLockedSize),this._viewSize[this._refreshBarAxis]-this._contentSize[this._refreshBarAxis]),this._footer.setXY(e.x,e.y),e.setTo(this._footer.width,this._footer.height),e[this._refreshBarAxis]=0<i?-i-t:this._viewSize[this._refreshBarAxis]-this._footer[this._refreshBarAxis],this._footer.setSize(e.x,e.y)):this._footer.displayObject.parent&&this._maskContainer.removeChild(this._footer.displayObject))}tweenUpdate(){var t=this.runTween("x"),e=this.runTween("y");this._container.pos(t,e),2==this._tweening&&(0<this._overlapSize.x&&(this._xPos=_.ToolSet.clamp(-t,0,this._overlapSize.x)),0<this._overlapSize.y&&(this._yPos=_.ToolSet.clamp(-e,0,this._overlapSize.y)),this._pageMode)&&this.updatePageController(),0==this._tweenChange.x&&0==this._tweenChange.y?(this._tweening=0,Laya.timer.clear(this,this.tweenUpdate),this.loopCheckingCurrent(),this.updateScrollBarPos(),this.updateScrollBarVisible(),_.Events.dispatch(_.Events.SCROLL,this._owner.displayObject),_.Events.dispatch(_.Events.SCROLL_END,this._owner.displayObject)):(this.updateScrollBarPos(),_.Events.dispatch(_.Events.SCROLL,this._owner.displayObject))}runTween(t){var e,i,s,a;return 0!=this._tweenChange[t]?(this._tweenTime[t]+=Laya.timer.delta/1e3,this._tweenTime[t]>=this._tweenDuration[t]?(e=this._tweenStart[t]+this._tweenChange[t],this._tweenChange[t]=0):(s=h(this._tweenTime[t],this._tweenDuration[t]),e=this._tweenStart[t]+Math.floor(this._tweenChange[t]*s)),s=-this._overlapSize[t],(i=0)<this._headerLockedSize&&this._refreshBarAxis==t&&(i=this._headerLockedSize),0<this._footerLockedSize&&this._refreshBarAxis==t&&(0==(a=this._overlapSize[this._refreshBarAxis])?a=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):a+=this._footerLockedSize,s=-a),2==this._tweening&&this._bouncebackEffect?20+i<e&&0<this._tweenChange[t]||i<e&&0==this._tweenChange[t]?(this._tweenTime[t]=0,this._tweenDuration[t]=_.TWEEN_TIME_DEFAULT,this._tweenChange[t]=-e+i,this._tweenStart[t]=e):(e<s-20&&this._tweenChange[t]<0||e<s&&0==this._tweenChange[t])&&(this._tweenTime[t]=0,this._tweenDuration[t]=_.TWEEN_TIME_DEFAULT,this._tweenChange[t]=s-e,this._tweenStart[t]=e):i<e?(e=i,this._tweenChange[t]=0):e<s&&(e=s,this._tweenChange[t]=0)):e=this._container[t],e}}_.ScrollPane=d;var c=0;const i=.5;_.TWEEN_TIME_DEFAULT=.3,_.PULL_RATIO=.5;var u=new Laya.Point,a=new Laya.Rectangle,e=new Laya.Point,s=new Laya.Point;function h(t,e){return(t=t/e-1)*t*t+1}}(fgui),function(g){g.Transition=class{constructor(t){this._owner=t,this._items=new Array,this._totalDuration=0,this._autoPlayTimes=1,this._autoPlayDelay=0,this._timeScale=1,this._startTime=0,this._endTime=0}play(t,e,i,s,a){this._play(t,e,i,s,a,!1)}playReverse(t,e,i,s,a){this._play(t,1,i,s,a,!0)}changePlayTimes(t){this._totalTimes=t}setAutoPlay(t,e,i){null==e&&(e=-1),null==i&&(i=0),this._autoPlay!=t&&(this._autoPlay=t,this._autoPlayTimes=e,this._autoPlayDelay=i,this._autoPlay?this._owner.onStage&&this.play(null,null,this._autoPlayTimes,this._autoPlayDelay):this._owner.onStage||this.stop(!1,!0))}_play(t,e,i,s,a,h){null==e&&(e=1),null==i&&(i=0),null==s&&(s=0),null==a&&(a=-1),this.stop(!0,!0),this._totalTimes=e,this._reversed=h,this._startTime=s,this._endTime=a,this._playing=!0,this._paused=!1,this._onComplete=t;for(var r=this._items.length,n=0;n<r;n++){var o=this._items[n];if(null==o.target?o.targetId?o.target=this._owner.getChildById(o.targetId):o.target=this._owner:o.target!=this._owner&&o.target.parent!=this._owner&&(o.target=null),o.target&&o.type==c.Transition){var l=o.target.getTransition(o.value.transName);if(l=l==this?null:l)if(0==o.value.playTimes){for(var _=n-1;0<=_;_--){var d=this._items[_];if(d.type==c.Transition&&d.value.trans==l){d.value.stopTime=o.time-d.time;break}}_<0?o.value.stopTime=0:l=null}else o.value.stopTime=-1;o.value.trans=l}}0==i?this.onDelayedPlay():g.GTween.delayedCall(i).setTarget(this).onComplete(this.onDelayedPlay,this)}stop(t,e){if(this._playing){null==t&&(t=!0),this._playing=!1,this._totalTasks=0,this._totalTimes=0;var i=this._onComplete,s=(this._onComplete=null,g.GTween.kill(this),this._items.length);if(this._reversed)for(var a=s-1;0<=a;a--){var h=this._items[a];null!=h.target&&this.stopItem(h,t)}else for(a=0;a<s;a++)null!=(h=this._items[a]).target&&this.stopItem(h,t);e&&i&&i.run()}}stopItem(t,e){0!=t.displayLockToken&&(t.target.releaseDisplayLock(t.displayLockToken),t.displayLockToken=0),t.tweener&&(t.tweener.kill(e),t.tweener=null,t.type!=c.Shake||e||(t.target._gearLocked=!0,t.target.setXY(t.target.x-t.value.lastOffsetX,t.target.y-t.value.lastOffsetY),t.target._gearLocked=!1)),t.type==c.Transition&&(t=t.value.trans)&&t.stop(e,!1)}setPaused(t){if(this._playing&&this._paused!=t){this._paused=t;for(var e=g.GTween.getTween(this),i=(e&&e.setPaused(t),this._items.length),s=0;s<i;s++){var a=this._items[s];null!=a.target&&(a.type==c.Transition?a.value.trans&&a.value.trans.setPaused(t):a.type==c.Animation&&(t?(a.value.flag=a.target.getProp(g.ObjectPropID.Playing),a.target.setProp(g.ObjectPropID.Playing,!1)):a.target.setProp(g.ObjectPropID.Playing,a.value.flag)),a.tweener)&&a.tweener.setPaused(t)}}}dispose(){this._playing&&g.GTween.kill(this);for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.tweener&&(i.tweener.kill(),i.tweener=null),i.target=null,i.hook=null,i.tweenConfig&&(i.tweenConfig.endHook=null)}this._items.length=0,this._playing=!1,this._onComplete=null}get playing(){return this._playing}setValue(t,...e){for(var i,s=this._items.length,a=!1,h=0;h<s;h++){var r=this._items[h];if(r.label==t)i=r.tweenConfig?r.tweenConfig.startValue:r.value;else{if(!r.tweenConfig||r.tweenConfig.endLabel!=t)continue;i=r.tweenConfig.endValue}switch(a=!0,r.type){case c.XY:case c.Size:case c.Pivot:case c.Scale:case c.Skew:i.b1=!0,i.b2=!0,i.f1=parseFloat(e[0]),i.f2=parseFloat(e[1]);break;case c.Alpha:case c.Rotation:case c.Color:i.f1=parseFloat(e[0]);break;case c.Animation:i.frame=parseInt(e[0]),1<e.length&&(i.playing=e[1]);break;case c.Visible:i.visible=e[0];break;case c.Sound:i.sound=e[0],1<e.length&&(i.volume=parseFloat(e[1]));break;case c.Transition:i.transName=e[0],1<e.length&&(i.playTimes=parseInt(e[1]));break;case c.Shake:i.amplitude=parseFloat(e[0]),1<e.length&&(i.duration=parseFloat(e[1]));break;case c.ColorFilter:i.f1=parseFloat(e[0]),i.f2=parseFloat(e[1]),i.f3=parseFloat(e[2]),i.f4=parseFloat(e[3]);break;case c.Text:case c.Icon:i.text=e[0]}}if(!a)throw new Error("this.label not exists")}setHook(t,e){for(var i=this._items.length,s=!1,a=0;a<i;a++){var h=this._items[a];if(h.label==t){h.hook=e,s=!0;break}if(h.tweenConfig&&h.tweenConfig.endLabel==t){h.tweenConfig.endHook=e,s=!0;break}}if(!s)throw new Error("this.label not exists")}clearHooks(){for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.hook=null,i.tweenConfig&&(i.tweenConfig.endHook=null)}}setTarget(t,e){for(var i=this._items.length,s=!1,a=0;a<i;a++){var h=this._items[a];h.label==t&&(h.targetId=e==this._owner||null==e?"":e.id,this._playing?0<h.targetId.length?h.target=this._owner.getChildById(h.targetId):h.target=this._owner:h.target=null,s=!0)}if(!s)throw new Error("this.label not exists")}setDuration(t,e){for(var i=this._items.length,s=!1,a=0;a<i;a++){var h=this._items[a];h.tweenConfig&&h.label==t&&(h.tweenConfig.duration=e,s=!0)}if(!s)throw new Error("this.label not exists")}getLabelTime(t){for(var e=this._items.length,i=0;i<e;i++){var s=this._items[i];if(s.label==t)return s.time;if(s.tweenConfig&&s.tweenConfig.endLabel==t)return s.time+s.tweenConfig.duration}return NaN}get timeScale(){return this._timeScale}set timeScale(t){if(this._timeScale!=t&&(this._timeScale=t,this._playing))for(var e=this._items.length,i=0;i<e;i++){var s=this._items[i];s.tweener?s.tweener.setTimeScale(t):s.type==c.Transition?s.value.trans&&(s.value.trans.timeScale=t):s.type==c.Animation&&s.target&&s.target.setProp(g.ObjectPropID.TimeScale,t)}}updateFromRelations(t,e,i){var s=this._items.length;if(0!=s)for(var a=0;a<s;a++){var h=this._items[a];h.type==c.XY&&h.targetId==t&&(h.tweenConfig?(h.tweenConfig.startValue.b3||(h.tweenConfig.startValue.f1+=e,h.tweenConfig.startValue.f2+=i),h.tweenConfig.endValue.b3||(h.tweenConfig.endValue.f1+=e,h.tweenConfig.endValue.f2+=i)):h.value.b3||(h.value.f1+=e,h.value.f2+=i))}}onOwnerAddedToStage(){this._autoPlay&&!this._playing&&this.play(null,this._autoPlayTimes,this._autoPlayDelay)}onOwnerRemovedFromStage(){0==(this._options&t)&&this.stop(0!=(this._options&e),!1)}onDelayedPlay(){var t;if(this.internalPlay(),this._playing=0<this._totalTasks,this._playing){if(0!=(this._options&a))for(var e=this._items.length,i=0;i<e;i++){var s=this._items[i];s.target&&s.target!=this._owner&&(s.displayLockToken=s.target.addDisplayLock())}}else this._onComplete&&(t=this._onComplete,this._onComplete=null,t.run())}internalPlay(){this._ownerBaseX=this._owner.x,this._ownerBaseY=this._owner.y,this._totalTasks=1;var t,e=this._items.length,i=!1;if(this._reversed)for(s=e-1;0<=s;s--)null!=(t=this._items[s]).target&&this.playItem(t);else for(var s=0;s<e;s++)null!=(t=this._items[s]).target&&(t.type==c.Animation&&0!=this._startTime&&t.time<=this._startTime?t.value.flag=!(i=!0):this.playItem(t));i&&this.skipAnimations(),this._totalTasks--}playItem(t){var e;if(t.tweenConfig){if(e=this._reversed?this._totalDuration-t.time-t.tweenConfig.duration:t.time,-1==this._endTime||e<=this._endTime){var i,s=this._reversed?(i=t.tweenConfig.endValue,t.tweenConfig.startValue):(i=t.tweenConfig.startValue,t.tweenConfig.endValue);switch(t.value.b1=i.b1||s.b1,t.value.b2=i.b2||s.b2,t.type){case c.XY:case c.Size:case c.Scale:case c.Skew:t.tweener=g.GTween.to2(i.f1,i.f2,s.f1,s.f2,t.tweenConfig.duration);break;case c.Alpha:case c.Rotation:t.tweener=g.GTween.to(i.f1,s.f1,t.tweenConfig.duration);break;case c.Color:t.tweener=g.GTween.toColor(i.f1,s.f1,t.tweenConfig.duration);break;case c.ColorFilter:t.tweener=g.GTween.to4(i.f1,i.f2,i.f3,i.f4,s.f1,s.f2,s.f3,s.f4,t.tweenConfig.duration)}t.tweener.setDelay(e).setEase(t.tweenConfig.easeType,t.tweenConfig.customEase).setRepeat(t.tweenConfig.repeat,t.tweenConfig.yoyo).setTimeScale(this._timeScale).setTarget(t).onStart(this.onTweenStart,this).onUpdate(this.onTweenUpdate,this).onComplete(this.onTweenComplete,this),0<=this._endTime&&t.tweener.setBreakpoint(this._endTime-e),this._totalTasks++}}else t.type==c.Shake?(e=this._reversed?this._totalDuration-t.time-t.value.duration:t.time,t.value.offsetX=t.value.offsetY=0,t.value.lastOffsetX=t.value.lastOffsetY=0,t.tweener=g.GTween.shake(0,0,t.value.amplitude,t.value.duration).setDelay(e).setTimeScale(this._timeScale).setTarget(t).onUpdate(this.onTweenUpdate,this).onComplete(this.onTweenComplete,this),0<=this._endTime&&t.tweener.setBreakpoint(this._endTime-t.time),this._totalTasks++):(e=this._reversed?this._totalDuration-t.time:t.time)<=this._startTime?(this.applyValue(t),this.callHook(t,!1)):(-1==this._endTime||e<=this._endTime)&&(this._totalTasks++,t.tweener=g.GTween.delayedCall(e).setTimeScale(this._timeScale).setTarget(t).onComplete(this.onDelayedPlayItem,this));t.tweener&&t.tweener.seek(this._startTime)}skipAnimations(){for(var t,e,i=this._items.length,s=0;s<i;s++)if(!((e=this._items[s]).type!=c.Animation||e.time>this._startTime||(t=e.value).flag)){for(var a,h=(a=e.target).getProp(g.ObjectPropID.Frame),r=a.getProp(g.ObjectPropID.Playing)?0:-1,n=0,o=s;o<i;o++)(e=this._items[o]).type!=c.Animation||e.target!=a||e.time>this._startTime||((t=e.value).flag=!0,-1!=t.frame?(h=t.frame,r=t.playing?e.time:-1,n=0):t.playing?r<0&&(r=e.time):(0<=r&&(n+=e.time-r),r=-1),this.callHook(e,!1));0<=r&&(n+=this._startTime-r),a.setProp(g.ObjectPropID.Playing,0<=r),a.setProp(g.ObjectPropID.Frame,h),0<n&&a.setProp(g.ObjectPropID.DeltaTime,1e3*n)}}onDelayedPlayItem(t){t=t.target;t.tweener=null,this._totalTasks--,this.applyValue(t),this.callHook(t,!1),this.checkAllComplete()}onTweenStart(t){var e,i,s=t.target;s.type!=c.XY&&s.type!=c.Size||(i=this._reversed?(e=s.tweenConfig.endValue,s.tweenConfig.startValue):(e=s.tweenConfig.startValue,s.tweenConfig.endValue),s.type==c.XY?s.target!=this._owner?(e.b1?e.b3&&(t.startValue.x=e.f1*this._owner.width):t.startValue.x=s.target.x,e.b2?e.b3&&(t.startValue.y=e.f2*this._owner.height):t.startValue.y=s.target.y,i.b1?i.b3&&(t.endValue.x=i.f1*this._owner.width):t.endValue.x=t.startValue.x,i.b2?i.b3&&(t.endValue.y=i.f2*this._owner.height):t.endValue.y=t.startValue.y):(e.b1||(t.startValue.x=s.target.x-this._ownerBaseX),e.b2||(t.startValue.y=s.target.y-this._ownerBaseY),i.b1||(t.endValue.x=t.startValue.x),i.b2||(t.endValue.y=t.startValue.y)):(e.b1||(t.startValue.x=s.target.width),e.b2||(t.startValue.y=s.target.height),i.b1||(t.endValue.x=t.startValue.x),i.b2||(t.endValue.y=t.startValue.y)),s.tweenConfig.path&&(s.value.b1=s.value.b2=!0,t.setPath(s.tweenConfig.path))),this.callHook(s,!1)}onTweenUpdate(t){var e=t.target;switch(e.type){case c.XY:case c.Size:case c.Scale:case c.Skew:e.value.f1=t.value.x,e.value.f2=t.value.y,e.tweenConfig.path&&(e.value.f1+=t.startValue.x,e.value.f2+=t.startValue.y);break;case c.Alpha:case c.Rotation:e.value.f1=t.value.x;break;case c.Color:e.value.f1=t.value.color;break;case c.ColorFilter:e.value.f1=t.value.x,e.value.f2=t.value.y,e.value.f3=t.value.z,e.value.f4=t.value.w;break;case c.Shake:e.value.offsetX=t.deltaValue.x,e.value.offsetY=t.deltaValue.y}this.applyValue(e)}onTweenComplete(t){var e=t.target;e.tweener=null,this._totalTasks--,t.allCompleted&&this.callHook(e,!0),this.checkAllComplete()}onPlayTransCompleted(t){this._totalTasks--,this.checkAllComplete()}callHook(t,e){e?t.tweenConfig&&t.tweenConfig.endHook&&t.tweenConfig.endHook.run():t.time>=this._startTime&&t.hook&&t.hook.run()}checkAllComplete(){if(this._playing&&0==this._totalTasks)if(this._totalTimes<0)this.internalPlay(),0==this._totalTasks&&g.GTween.delayedCall(0).setTarget(this).onComplete(this.checkAllComplete,this);else if(this._totalTimes--,0<this._totalTimes)this.internalPlay(),0==this._totalTasks&&g.GTween.delayedCall(0).setTarget(this).onComplete(this.checkAllComplete,this);else{this._playing=!1;for(var t,e=this._items.length,i=0;i<e;i++){var s=this._items[i];s.target&&0!=s.displayLockToken&&(s.target.releaseDisplayLock(s.displayLockToken),s.displayLockToken=0)}this._onComplete&&(t=this._onComplete,this._onComplete=null,t.run())}}applyValue(t){t.target._gearLocked=!0;var e,i,s,a=t.value;switch(t.type){case c.XY:t.target==this._owner?a.b1&&a.b2?t.target.setXY(a.f1+this._ownerBaseX,a.f2+this._ownerBaseY):a.b1?t.target.x=a.f1+this._ownerBaseX:t.target.y=a.f2+this._ownerBaseY:a.b3?a.b1&&a.b2?t.target.setXY(a.f1*this._owner.width,a.f2*this._owner.height):a.b1?t.target.x=a.f1*this._owner.width:a.b2&&(t.target.y=a.f2*this._owner.height):a.b1&&a.b2?t.target.setXY(a.f1,a.f2):a.b1?t.target.x=a.f1:a.b2&&(t.target.y=a.f2);break;case c.Size:a.b1||(a.f1=t.target.width),a.b2||(a.f2=t.target.height),t.target.setSize(a.f1,a.f2);break;case c.Pivot:t.target.setPivot(a.f1,a.f2,t.target.pivotAsAnchor);break;case c.Alpha:t.target.alpha=a.f1;break;case c.Rotation:t.target.rotation=a.f1;break;case c.Scale:t.target.setScale(a.f1,a.f2);break;case c.Skew:t.target.setSkew(a.f1,a.f2);break;case c.Color:t.target.setProp(g.ObjectPropID.Color,g.ToolSet.convertToHtmlColor(a.f1,!1));break;case c.Animation:0<=a.frame&&t.target.setProp(g.ObjectPropID.Frame,a.frame),t.target.setProp(g.ObjectPropID.Playing,a.playing),t.target.setProp(g.ObjectPropID.TimeScale,this._timeScale);break;case c.Visible:t.target.visible=a.visible;break;case c.Transition:this._playing&&(s=a.trans)&&(this._totalTasks++,e=this._startTime>t.time?this._startTime-t.time:0,i=0<=this._endTime?this._endTime-t.time:-1,0<=a.stopTime&&(i<0||i>a.stopTime)&&(i=a.stopTime),s.timeScale=this._timeScale,s._play(Laya.Handler.create(this,this.onPlayTransCompleted,[t]),a.playTimes,0,e,i,this._reversed));break;case c.Sound:this._playing&&t.time>=this._startTime&&(null==a.audioClip&&(s=g.UIPackage.getItemByURL(a.sound),a.audioClip=s?s.file:a.sound),a.audioClip)&&g.GRoot.inst.playOneShotSound(a.audioClip,a.volume);break;case c.Shake:t.target.setXY(t.target.x-a.lastOffsetX+a.offsetX,t.target.y-a.lastOffsetY+a.offsetY),a.lastOffsetX=a.offsetX,a.lastOffsetY=a.offsetY;break;case c.ColorFilter:g.ToolSet.setColorFilter(t.target.displayObject,[a.f1,a.f2,a.f3,a.f4]);break;case c.Text:t.target.text=a.text;break;case c.Icon:t.target.icon=a.text}t.target._gearLocked=!1}setup(t){this.name=t.readS(),this._options=t.getInt32(),this._autoPlay=t.readBool(),this._autoPlayTimes=t.getInt32(),this._autoPlayDelay=t.getFloat32();for(var e=t.getInt16(),i=0;i<e;i++){var s=t.getInt16(),a=t.pos,h=(t.seek(a,0),new p(t.readByte())),r=((this._items[i]=h).time=t.getFloat32(),t.getInt16());if(h.targetId=r<0?"":this._owner.getChildAt(r).id,h.label=t.readS(),t.readBool()){if(t.seek(a,1),h.tweenConfig=new y,h.tweenConfig.duration=t.getFloat32(),h.time+h.tweenConfig.duration>this._totalDuration&&(this._totalDuration=h.time+h.tweenConfig.duration),h.tweenConfig.easeType=t.readByte(),h.tweenConfig.repeat=t.getInt32(),h.tweenConfig.yoyo=t.readBool(),h.tweenConfig.endLabel=t.readS(),t.seek(a,2),this.decodeValue(h,t,h.tweenConfig.startValue),t.seek(a,3),this.decodeValue(h,t,h.tweenConfig.endValue),2<=t.version){var n=t.getInt32();if(0<n){h.tweenConfig.path=new g.GPath;for(var o=new Array,l=0;l<n;l++){var _=t.getUint8();switch(_){case g.CurveType.Bezier:o.push(g.GPathPoint.newBezierPoint(t.getFloat32(),t.getFloat32(),t.getFloat32(),t.getFloat32()));break;case g.CurveType.CubicBezier:o.push(g.GPathPoint.newCubicBezierPoint(t.getFloat32(),t.getFloat32(),t.getFloat32(),t.getFloat32(),t.getFloat32(),t.getFloat32()));break;default:o.push(g.GPathPoint.newPoint(t.getFloat32(),t.getFloat32(),_))}}h.tweenConfig.path.create(o)}}if(4<=t.version&&h.tweenConfig.easeType==g.EaseType.Custom){var d=t.getInt32();if(0<d){h.tweenConfig.customEase=new g.CustomEase;for(var c=new Array,l=0;l<d;l++){var u=t.getUint8();switch(u){case g.CurveType.Bezier:c.push(g.GPathPoint.newBezierPoint(t.getFloat32(),t.getFloat32(),t.getFloat32(),t.getFloat32()));break;case g.CurveType.CubicBezier:c.push(g.GPathPoint.newCubicBezierPoint(t.getFloat32(),t.getFloat32(),t.getFloat32(),t.getFloat32(),t.getFloat32(),t.getFloat32()));break;default:c.push(g.GPathPoint.newPoint(t.getFloat32(),t.getFloat32(),u))}}h.tweenConfig.customEase.create(c)}}}else h.time>this._totalDuration&&(this._totalDuration=h.time),t.seek(a,2),this.decodeValue(h,t,h.value);t.pos=a+s}}decodeValue(t,e,i){switch(t.type){case c.XY:case c.Size:case c.Pivot:case c.Skew:i.b1=e.readBool(),i.b2=e.readBool(),i.f1=e.getFloat32(),i.f2=e.getFloat32(),2<=e.version&&t.type==c.XY&&(i.b3=e.readBool());break;case c.Alpha:case c.Rotation:i.f1=e.getFloat32();break;case c.Scale:i.f1=e.getFloat32(),i.f2=e.getFloat32();break;case c.Color:i.f1=e.readColor();break;case c.Animation:i.playing=e.readBool(),i.frame=e.getInt32();break;case c.Visible:i.visible=e.readBool();break;case c.Sound:i.sound=e.readS(),i.volume=e.getFloat32();break;case c.Transition:i.transName=e.readS(),i.playTimes=e.getInt32();break;case c.Shake:i.amplitude=e.getFloat32(),i.duration=e.getFloat32();break;case c.ColorFilter:i.f1=e.getFloat32(),i.f2=e.getFloat32(),i.f3=e.getFloat32(),i.f4=e.getFloat32();break;case c.Text:case c.Icon:i.text=e.readS()}}};class c{}c.XY=0,c.Size=1,c.Scale=2,c.Pivot=3,c.Alpha=4,c.Rotation=5,c.Color=6,c.Animation=7,c.Visible=8,c.Sound=9,c.Transition=10,c.Shake=11,c.ColorFilter=12,c.Skew=13,c.Text=14,c.Icon=15,c.Unknown=16;class p{constructor(t){this.type=t,this.value={},this.displayLockToken=0}}class y{constructor(){this.easeType=g.EaseType.QuadOut,this.startValue={b1:!0,b2:!0},this.endValue={b1:!0,b2:!0}}}const a=1,t=2,e=4}(fgui),function(w){class v{constructor(){}static loadFromXML(t){var e={};v.strings=e;for(var i=l(Laya.Utils.parseXMLFromString(t),"resources").childNodes,s=i.length,a=0;a<s;a++){var h,r,n,o=i[a];"string"==o.nodeName&&(r=o.getAttribute("name"),o=o.textContent,-1!=(n=r.indexOf("-")))&&(h=r.substr(0,n),r=r.substr(n+1),(n=e[h])||(e[h]=n={}),n[r]=o)}}static translateComponent(t){if(null!=v.strings){var e=v.strings[t.owner.id+t.id];if(null!=e)for(var i,s,a,h,r,n,o,l=t.rawData,_=(l.seek(0,2),l.getInt16()),d=0;d<_;d++){r=l.getInt16(),n=l.pos,l.seek(n,0);for(var c=l.readByte(),u=c,g=(l.skip(4),i=l.readS(),u==w.ObjectType.Component&&l.seek(n,6)&&(u=l.readByte()),l.seek(n,1),null!=(s=e[i+"-tips"])&&l.writeS(s),l.seek(n,2),l.getInt16()),p=0;p<g;p++){if(a=l.getInt16(),a+=l.pos,6==l.readByte()){for(l.skip(2),o=l.getInt16(),f=0;f<o;f++)null!=l.readS()&&(null!=(s=e[i+"-texts_"+f])?l.writeS(s):l.skip(2));l.readBool()&&null!=(s=e[i+"-texts_def"])&&l.writeS(s)}l.pos=a}if(c==w.ObjectType.Component&&2<=l.version){l.seek(n,4),l.skip(2),l.skip(4*l.getUint16());for(var y=l.getUint16(),f=0;f<y;f++){var m=l.readS();0==l.getUint16()&&null!=(s=e[i+"-cp-"+m])?l.writeS(s):l.skip(2)}}switch(u){case w.ObjectType.Text:case w.ObjectType.RichText:case w.ObjectType.InputText:null!=(s=e[i])&&(l.seek(n,6),l.writeS(s)),null!=(s=e[i+"-prompt"])&&(l.seek(n,4),l.writeS(s));break;case w.ObjectType.List:case w.ObjectType.Tree:for(l.seek(n,8),l.skip(2),h=l.getUint16(),p=0;p<h;p++){if(a=l.getUint16(),a+=l.pos,l.skip(2),u==w.ObjectType.Tree&&l.skip(2),null!=(s=e[i+"-"+p])?l.writeS(s):l.skip(2),null!=(s=e[i+"-"+p+"-0"])?l.writeS(s):l.skip(2),2<=l.version){l.skip(6),l.skip(4*l.getUint16());for(y=l.getUint16(),f=0;f<y;f++){m=l.readS();0==l.getUint16()&&null!=(s=e[i+"-"+p+"-"+m])?l.writeS(s):l.skip(2)}}l.pos=a}break;case w.ObjectType.Label:l.seek(n,6)&&l.readByte()==u&&(null!=(s=e[i])?l.writeS(s):l.skip(2),l.skip(2),l.readBool()&&l.skip(4),l.skip(4),l.readBool())&&null!=(s=e[i+"-prompt"])&&l.writeS(s);break;case w.ObjectType.Button:l.seek(n,6)&&l.readByte()==u&&(null!=(s=e[i])?l.writeS(s):l.skip(2),null!=(s=e[i+"-0"]))&&l.writeS(s);break;case w.ObjectType.ComboBox:if(l.seek(n,6)&&l.readByte()==u){for(h=l.getInt16(),p=0;p<h;p++)a=l.getInt16(),a+=l.pos,null!=(s=e[i+"-"+p])&&l.writeS(s),l.pos=a;null!=(s=e[i])&&l.writeS(s)}}l.pos=n+r}}}}function l(t,e){var i=t.childNodes,s=i.length;if(0<s)for(var a=0;a<s;a++){var h=i[a];if(h.nodeName==e)return h}return null}w.TranslationHelper=v}(fgui),function(t){class e{constructor(){}}e.defaultFont="SimSun",e.modalLayerColor="rgba(33,33,33,0.2)",e.buttonSoundVolumeScale=1,e.defaultScrollStep=25,e.defaultScrollDecelerationRate=.967,e.defaultScrollBarDisplay=t.ScrollBarDisplayType.Visible,e.defaultScrollTouchEffect=!0,e.defaultScrollBounceEffect=!0,e.defaultScrollSnappingThreshold=.1,e.defaultScrollPagingThreshold=.3,e.defaultComboBoxVisibleItemCount=10,e.touchScrollSensitivity=20,e.touchDragSensitivity=10,e.clickDragSensitivity=2,e.bringWindowToFrontOnClick=!0,e.frameTimeForAsyncUIConstruction=2,e.textureLinearSampling=!0,e.packageFileExtension="fui",e.useTextShadow=!1,t.UIConfig=e}(fgui),function(s){class a{constructor(){}static setExtension(t,e){if(null==t)throw"Invaild url: "+t;var i=s.UIPackage.getItemByURL(t);i&&(i.extensionType=e),a.extensions[t]=e}static setPackageItemExtension(t,e){a.setExtension(t,e)}static setLoaderExtension(t){a.loaderType=t}static resolvePackageItemExtension(t){var e=a.extensions["ui://"+t.owner.id+t.id];(e=e||a.extensions["ui://"+t.owner.name+"/"+t.name])&&(t.extensionType=e)}static newObject(t,e){var i;if("number"==typeof t)switch(t){case s.ObjectType.Image:return new s.GImage;case s.ObjectType.MovieClip:return new s.GMovieClip;case s.ObjectType.Component:return new s.GComponent;case s.ObjectType.Text:return new s.GBasicTextField;case s.ObjectType.RichText:return new s.GRichTextField;case s.ObjectType.InputText:return new s.GTextInput;case s.ObjectType.Group:return new s.GGroup;case s.ObjectType.List:return new s.GList;case s.ObjectType.Graph:return new s.GGraph;case s.ObjectType.Loader:return new(a.loaderType||s.GLoader);case s.ObjectType.Button:return new s.GButton;case s.ObjectType.Label:return new s.GLabel;case s.ObjectType.ProgressBar:return new s.GProgressBar;case s.ObjectType.Slider:return new s.GSlider;case s.ObjectType.ScrollBar:return new s.GScrollBar;case s.ObjectType.ComboBox:return new s.GComboBox;case s.ObjectType.Tree:return new s.GTree;case s.ObjectType.Loader3D:return new s.GLoader3D;default:return null}else(i=t.type==s.PackageItemType.Component?e?new e:t.extensionType?new t.extensionType:a.newObject(t.objectType):a.newObject(t.objectType))&&(i.packageItem=t);return i}}a.extensions={},s.UIObjectFactory=a}(fgui),function(y){class f{constructor(){this._items=[],this._itemsById={},this._itemsByName={},this._sprites={},this._dependencies=[],this._branches=[],this._branchIndex=-1}static get branch(){return f._branch}static set branch(t){for(var e in f._branch=t,f._instById){e=f._instById[e];e._branches&&(e._branchIndex=e._branches.indexOf(t))}}static getVar(t){return f._vars[t]}static setVar(t,e){f._vars[t]=e}static getById(t){return f._instById[t]}static getByName(t){return f._instByName[t]}static addPackage(t,e){var i;if(e||(e=y.AssetProxy.inst.getRes(t+"."+y.UIConfig.packageFileExtension))&&0!=e.byteLength)return e=new y.ByteBuffer(e),(i=new f)._resKey=t,i.loadPackage(e),f._instById[i.id]=i,f._instByName[i.name]=i,f._instById[t]=i;throw new Error("resource '"+t+"' not found")}static loadPackage(t,h,r){let n=[],o=[],l;if(Array.isArray(t))for(l=0;l<t.length;l++)n.push({url:t[l]+"."+y.UIConfig.packageFileExtension,type:Laya.Loader.BUFFER}),o.push(t[l]);else n=[{url:t+"."+y.UIConfig.packageFileExtension,type:Laya.Loader.BUFFER}],o=[t];let _=[];var e,i;for(l=0;l<n.length;l++)(e=f._instById[o[l]])&&(_.push(e),n.splice(l,1),o.splice(l,1),l--);0==n.length?h.runWith([_]):(i=Laya.Handler.create(this,function(){let e;var i=[];for(l=0;l<n.length;l++){var t=y.AssetProxy.inst.getRes(n[l].url);if(t){e=new f,_.push(e),e._resKey=o[l],e.loadPackage(new y.ByteBuffer(t));var s=e._items.length;for(let t=0;t<s;t++){var a=e._items[t];a.type==y.PackageItemType.Atlas?i.push({url:a.file,type:Laya.Loader.IMAGE}):a.type==y.PackageItemType.Sound&&i.push({url:a.file,type:Laya.Loader.SOUND})}}}if(0<i.length)y.AssetProxy.inst.load(i,Laya.Handler.create(this,function(){for(l=0;l<_.length;l++)e=_[l],f._instById[e.id]||(f._instById[e.id]=e,f._instByName[e.name]=e,f._instById[e._resKey]=e);h.runWith([_])},null,!0),r);else{for(l=0;l<_.length;l++)e=_[l],f._instById[e.id]||(f._instById[e.id]=e,f._instByName[e.name]=e,f._instById[e._resKey]=e);h.runWith([_])}},null,!0),y.AssetProxy.inst.load(n,i,null,Laya.Loader.BUFFER))}static removePackage(t){var e=f._instById[t];if(!(e=e||f._instByName[t]))throw new Error("unknown package: "+t);e.dispose(),delete f._instById[e.id],delete f._instByName[e.name],delete f._instById[e._resKey],e._customId&&delete f._instById[e._customId]}static createObject(t,e,i){t=f.getByName(t);return t?t.createObject(e,i):null}static createObjectFromURL(t,e){t=f.getItemByURL(t);return t?t.owner.internalCreateObject(t,e):null}static getItemURL(t,e){t=f.getByName(t);return t&&(e=t._itemsByName[e])?"ui://"+t.id+e.id:null}static getItemByURL(t){var e=t.indexOf("//");if(-1!=e){var i=t.indexOf("/",e+2);if(-1==i){if(13<t.length){var s=t.substr(5,8),s=f.getById(s);if(s)return a=t.substr(13),s.getItemById(a)}}else{var a=t.substr(e+2,i-e-2);if(s=f.getByName(a))return e=t.substr(i+1),s.getItemByName(e)}}return null}static getItemAssetByURL(t){t=f.getItemByURL(t);return null==t?null:t.owner.getItemAsset(t)}static normalizeURL(t){var e,i;return null==t||-1==(i=t.indexOf("//"))?null:-1==(e=t.indexOf("/",i+2))?t:(i=t.substr(i+2,e-i-2),t=t.substr(e+1),f.getItemURL(i,t))}static setStringsSource(t){y.TranslationHelper.loadFromXML(t)}loadPackage(t){if(1179080009!=t.getUint32())throw new Error("FairyGUI: old package format found in '"+this._resKey+"'");t.version=t.getInt32();for(var e,i,s,a=t.readBool(),h=(this._id=t.readUTFString(),this._name=t.readUTFString(),t.skip(20),a&&(a=new Uint8Array(t.buffer,t.pos,t.length-t.pos),a=new Zlib.RawInflate(a).decompress(),(a=new y.ByteBuffer(a)).version=t.version,t=a),2<=t.version),a=t.pos,r=(t.seek(a,4),e=t.getInt32(),[]),n=0;n<e;n++)r[n]=t.readUTFString();for(t.stringTable=r,t.seek(a,0),e=t.getInt16(),n=0;n<e;n++)this._dependencies.push({id:t.readS(),name:t.readS()});h&&(0<(e=t.getInt16())&&(this._branches=t.readSArray(e),f._branch)&&(this._branchIndex=this._branches.indexOf(f._branch)),s=0<e),t.seek(a,1);var o,l=this._resKey,_=l.lastIndexOf("/"),d=-1==_?"":l.substr(0,_+1);for(l+="_",e=t.getUint16(),n=0;n<e;n++){switch(i=t.getInt32(),i+=t.pos,(u=new y.PackageItem).owner=this,u.type=t.readByte(),u.id=t.readS(),u.name=t.readS(),t.readS(),(o=t.readS())&&(u.file=o),t.readBool(),u.width=t.getInt32(),u.height=t.getInt32(),u.type){case y.PackageItemType.Image:u.objectType=y.ObjectType.Image;var c=t.readByte();1==c?(u.scale9Grid=new Laya.Rectangle,u.scale9Grid.x=t.getInt32(),u.scale9Grid.y=t.getInt32(),u.scale9Grid.width=t.getInt32(),u.scale9Grid.height=t.getInt32(),u.tileGridIndice=t.getInt32()):2==c&&(u.scaleByTile=!0),u.smoothing=t.readBool();break;case y.PackageItemType.MovieClip:u.smoothing=t.readBool(),u.objectType=y.ObjectType.MovieClip,u.rawData=t.readBuffer();break;case y.PackageItemType.Font:u.rawData=t.readBuffer();break;case y.PackageItemType.Component:c=t.readByte();u.objectType=0<c?c:y.ObjectType.Component,u.rawData=t.readBuffer(),y.UIObjectFactory.resolvePackageItemExtension(u);break;case y.PackageItemType.Atlas:case y.PackageItemType.Sound:case y.PackageItemType.Misc:u.file=l+u.file;break;case y.PackageItemType.Spine:case y.PackageItemType.DragonBones:u.file=d+u.file,u.skeletonAnchor=new Laya.Point,u.skeletonAnchor.x=t.getFloat32(),u.skeletonAnchor.y=t.getFloat32()}h&&((o=t.readS())&&(u.name=o+"/"+u.name),0<(o=t.getUint8())&&(s?u.branches=t.readSArray(o):this._itemsById[t.readS()]=u),0<(o=t.getUint8()))&&(u.highResolution=t.readSArray(o)),this._items.push(u),null!=(this._itemsById[u.id]=u).name&&(this._itemsByName[u.name]=u),t.pos=i}for(t.seek(a,2),e=t.getUint16(),n=0;n<e;n++){i=t.getUint16(),i+=t.pos;var u,g=t.readS(),p={atlas:u=this._itemsById[t.readS()],rect:new Laya.Rectangle,offset:new Laya.Point,originalSize:new Laya.Point};p.atlas=u,p.rect.x=t.getInt32(),p.rect.y=t.getInt32(),p.rect.width=t.getInt32(),p.rect.height=t.getInt32(),p.rotated=t.readBool(),h&&t.readBool()?(p.offset.x=t.getInt32(),p.offset.y=t.getInt32(),p.originalSize.x=t.getInt32(),p.originalSize.y=t.getInt32()):(p.originalSize.x=p.rect.width,p.originalSize.y=p.rect.height),this._sprites[g]=p,t.pos=i}if(t.seek(a,3))for(e=t.getUint16(),n=0;n<e;n++)i=t.getInt32(),i+=t.pos,(u=this._itemsById[t.readS()])&&u.type==y.PackageItemType.Image&&(u.pixelHitTestData=new y.PixelHitTestData,u.pixelHitTestData.load(t)),t.pos=i}loadAllAssets(){for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];this.getItemAsset(i)}}unloadAssets(){for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.type==y.PackageItemType.Atlas&&i.texture&&Laya.loader.clearTextureRes(i.texture.url)}}dispose(){for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.type==y.PackageItemType.Atlas?i.texture&&(i.texture.destroy(),i.texture=null):i.type==y.PackageItemType.Sound?Laya.SoundManager.destroySound(i.file):i.templet&&i.templet.destroy()}}get id(){return this._id}get name(){return this._name}get customId(){return this._customId}set customId(t){this._customId&&delete f._instById[this._customId],this._customId=t,this._customId&&(f._instById[this._customId]=this)}createObject(t,e){t=this._itemsByName[t];return t?this.internalCreateObject(t,e):null}internalCreateObject(t,e){t=y.UIObjectFactory.newObject(t,e);return null==t?null:(f._constructing++,t.constructFromResource(),f._constructing--,t)}getItems(){return this._items}getItemById(t){return this._itemsById[t]}getItemByName(t){return this._itemsByName[t]}getItemAssetByName(t){var e=this._itemsByName[t];if(null==e)throw"Resource not found -"+t;return this.getItemAsset(e)}getItemAsset(t){switch(t.type){case y.PackageItemType.Image:var e,i;return t.decoded||(t.decoded=!0,(e=this._sprites[t.id])?(i=this.getItemAsset(e.atlas),t.texture=i?Laya.Texture.create(i,e.rect.x,e.rect.y,e.rect.width,e.rect.height,e.offset.x,e.offset.y,e.originalSize.x,e.originalSize.y):null):t.texture=null),t.texture;case y.PackageItemType.Atlas:return t.decoded||(t.decoded=!0,t.texture=y.AssetProxy.inst.getItemRes(t)),t.texture;case y.PackageItemType.Font:return t.decoded||(t.decoded=!0,this.loadFont(t)),t.bitmapFont;case y.PackageItemType.MovieClip:return t.decoded||(t.decoded=!0,this.loadMovieClip(t)),t.frames;case y.PackageItemType.Component:return t.rawData;case y.PackageItemType.Misc:return t.file?y.AssetProxy.inst.getItemRes(t):null;default:return null}}getItemAssetAsync(e,t){if(e.decoded)t(null,e);else if(e.loading)e.loading.push(t);else switch(e.type){case y.PackageItemType.Spine:case y.PackageItemType.DragonBones:e.loading=[t],e.templet=new Laya.Templet,e.templet.on(Laya.Event.COMPLETE,this,()=>{var t=e.loading;delete e.loading,t.forEach(t=>t(null,e))}),e.templet.on(Laya.Event.ERROR,this,()=>{var t=e.loading;delete e.loading,delete e.templet,t.forEach(t=>t("parse error",e))});var i=e.file.lastIndexOf("."),i=e.file.substring(0,i+1).replace("_ske","")+"sk";e.templet.loadAni(i);break;default:this.getItemAsset(e),t(null,e)}}loadMovieClip(t){var e,i,s=t.rawData,a=(s.seek(0,0),t.interval=s.getInt32(),t.swing=s.readBool(),t.repeatDelay=s.getInt32(),s.seek(0,1),s.getInt16());t.frames=[];for(var h=0;h<a;h++){var r,n,o=s.getInt16(),l=(o+=s.pos,e=s.getInt32(),i=s.getInt32(),s.getInt32(),s.getInt32(),{addDelay:s.getInt32()});null!=(n=s.readS())&&null!=(n=this._sprites[n])&&(r=this.getItemAsset(n.atlas),l.texture=Laya.Texture.create(r,n.rect.x,n.rect.y,n.rect.width,n.rect.height,e,i,t.width,t.height)),t.frames[h]=l,s.pos=o}}loadFont(t){t=t.getBranch();for(var e=new y.BitmapFont,i=(t.bitmapFont=e,t.rawData),s=(i.seek(0,0),e.ttf=i.readBool(),e.tint=i.readBool(),e.resizable=i.readBool(),i.readBool(),e.size=i.getInt32(),i.getInt32()),a=i.getInt32(),h=null,r=this._sprites[t.id],n=(r&&(h=this.getItemAsset(r.atlas)),i.seek(0,1),null),o=i.getInt32(),l=0;l<o;l++){var _=i.getInt16(),d=(_+=i.pos,n={},i.readChar()),d=(e.glyphs[d]=n,i.readS()),c=i.getInt32(),u=i.getInt32();n.x=i.getInt32(),n.y=i.getInt32(),n.width=i.getInt32(),n.height=i.getInt32(),n.advance=i.getInt32(),n.channel=i.readByte(),1==n.channel?n.channel=3:2==n.channel?n.channel=2:3==n.channel&&(n.channel=1),e.ttf?(n.texture=Laya.Texture.create(h,c+r.rect.x,u+r.rect.y,n.width,n.height),n.lineHeight=a):((c=this._itemsById[d])&&(c=c.getBranch(),n.width=c.width,n.height=c.height,c=c.getHighResolution(),this.getItemAsset(c),n.texture=c.texture),0==n.advance&&(n.advance=0==s?n.x+n.width:s),n.lineHeight=n.y<0?n.height:n.y+n.height,n.lineHeight<e.size&&(n.lineHeight=e.size)),i.pos=_}}}f._constructing=0,f._instById={},f._instByName={},f._branch="",f._vars={},y.UIPackage=f}(fgui),function(i){class t extends i.GComponent{constructor(){super(),this._requestingCmd=0,this._uiSources=[],this.bringToFontOnClick=i.UIConfig.bringWindowToFrontOnClick,this.displayObject.on(Laya.Event.DISPLAY,this,this.__onShown),this.displayObject.on(Laya.Event.UNDISPLAY,this,this.__onHidden),this.displayObject.on(Laya.Event.MOUSE_DOWN,this,this.__mouseDown)}addUISource(t){this._uiSources.push(t)}set contentPane(t){this._contentPane!=t&&(this._contentPane&&this.removeChild(this._contentPane),this._contentPane=t,this._contentPane)&&(this.addChild(this._contentPane),this.setSize(this._contentPane.width,this._contentPane.height),this._contentPane.addRelation(this,i.RelationType.Size),this._frame=this._contentPane.getChild("frame"),this._frame)&&(this.closeButton=this._frame.getChild("closeButton"),this.dragArea=this._frame.getChild("dragArea"),this.contentArea=this._frame.getChild("contentArea"))}get contentPane(){return this._contentPane}get frame(){return this._frame}get closeButton(){return this._closeButton}set closeButton(t){this._closeButton&&this._closeButton.offClick(this,this.closeEventHandler),this._closeButton=t,this._closeButton&&this._closeButton.onClick(this,this.closeEventHandler)}get dragArea(){return this._dragArea}set dragArea(t){this._dragArea!=t&&(this._dragArea&&(this._dragArea.draggable=!1,this._dragArea.off(i.Events.DRAG_START,this,this.__dragStart)),this._dragArea=t,this._dragArea)&&(this._dragArea instanceof i.GGraph&&this._dragArea.asGraph.drawRect(0,null,null),this._dragArea.draggable=!0,this._dragArea.on(i.Events.DRAG_START,this,this.__dragStart))}get contentArea(){return this._contentArea}set contentArea(t){this._contentArea=t}show(){i.GRoot.inst.showWindow(this)}showOn(t){t.showWindow(this)}hide(){this.isShowing&&this.doHideAnimation()}hideImmediately(){((this.parent instanceof i.GRoot?this.parent:null)||i.GRoot.inst).hideWindowImmediately(this)}centerOn(t,e){this.setXY(Math.round((t.width-this.width)/2),Math.round((t.height-this.height)/2)),e&&(this.addRelation(t,i.RelationType.Center_Center),this.addRelation(t,i.RelationType.Middle_Middle))}toggleStatus(){this.isTop?this.hide():this.show()}get isShowing(){return null!=this.parent}get isTop(){return null!=this.parent&&this.parent.getChildIndex(this)==this.parent.numChildren-1}get modal(){return this._modal}set modal(t){this._modal=t}bringToFront(){this.root.bringToFront(this)}showModalWait(t){null!=t&&(this._requestingCmd=t),i.UIConfig.windowModalWaiting&&(this._modalWaitPane||(this._modalWaitPane=i.UIPackage.createObjectFromURL(i.UIConfig.windowModalWaiting)),this.layoutModalWaitPane(),this.addChild(this._modalWaitPane))}layoutModalWaitPane(){var t;this._contentArea?(t=this._frame.localToGlobal(),t=this.globalToLocal(t.x,t.y,t),this._modalWaitPane.setXY(t.x+this._contentArea.x,t.y+this._contentArea.y),this._modalWaitPane.setSize(this._contentArea.width,this._contentArea.height)):this._modalWaitPane.setSize(this.width,this.height)}closeModalWait(t){return(null==t||this._requestingCmd==t)&&(this._requestingCmd=0,this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane),!0)}get modalWaiting(){return this._modalWaitPane&&null!=this._modalWaitPane.parent}init(){if(!this._inited&&!this._loading)if(0<this._uiSources.length){this._loading=!1;for(var t=this._uiSources.length,e=0;e<t;e++){var i=this._uiSources[e];i.loaded||(i.load(this.__uiLoadComplete,this),this._loading=!0)}this._loading||this._init()}else this._init()}onInit(){}onShown(){}onHide(){}doShowAnimation(){this.onShown()}doHideAnimation(){this.hideImmediately()}__uiLoadComplete(){for(var t=this._uiSources.length,e=0;e<t;e++)if(!this._uiSources[e].loaded)return;this._loading=!1,this._init()}_init(){this._inited=!0,this.onInit(),this.isShowing&&this.doShowAnimation()}dispose(){this.parent&&this.hideImmediately(),super.dispose()}closeEventHandler(){this.hide()}__onShown(){this._inited?this.doShowAnimation():this.init()}__onHidden(){this.closeModalWait(),this.onHide()}__mouseDown(){this.isShowing&&this.bringToFontOnClick&&this.bringToFront()}__dragStart(t){i.GObject.cast(t.currentTarget).stopDrag(),this.startDrag()}}i.Window=t}(fgui),function(d){var t;function n(_){return __awaiter(this,void 0,void 0,function*(){return new Promise((t,e)=>{let i=null,s=null;if(_ instanceof Array){i=[],s=[];for(let t=0;t<_.length;t++){var[a,h,r]=d.split(_[t]);i.push(r),s.push([a,h])}}else{var[n,o,l]=d.split(_);i=l,s=[n,o]}fgui.UIPackage.loadPackage(i,Laya.Handler.create(this,()=>{t(s)}))})})}(t=d.Async||(d.Async={})).load=n,t.open=function(i,s,a){return __awaiter(this,void 0,void 0,function*(){if(a||!d.exists(i)){var[t,e]=yield n(i),t=fgui.UIPackage.createObject(t,e);if(!t)throw new Error(`创建组件"${i}"失败，请检查路径，和是否在编辑器中设置为导出`);d.DEBUG&&d.isNative(t)&&console.warn("打开原生组件:",i),t.makeFullScreen(),fgui.GRoot.inst.addChild(t),t._pivotAsAnchor&&t.setXY(t.width*t.pivotX,t.height*t.pivotY);e=t;return e.onOpened&&e.onOpened(s),t}d.DEBUG&&console.warn("请勿重复打开界面:"+i)})},t.show=function(i,s,a=0,h=0,r){return __awaiter(this,void 0,void 0,function*(){if(r||!d.exists(i)){var[t,e]=yield n(i),t=fgui.UIPackage.createObject(t,e);if(!t)throw new Error(`创建组件"${i}"失败，请检查路径，和是否在编辑器中设置为导出`);d.DEBUG&&d.isNative(t)&&console.warn("打开原生组件:",i),fgui.GRoot.inst.addChild(t),t._pivotAsAnchor?t.setXY((fgui.GRoot.inst.width-t.width)/2+a+t.width*t.pivotX,(fgui.GRoot.inst.height-t.height)/2+h+t.height*t.pivotY):t.setXY((fgui.GRoot.inst.width-t.width)/2+a,(fgui.GRoot.inst.height-t.height)/2+h);e=t;return e.onOpened&&e.onOpened(s),t}})}}(FGUI),function(o){function d(e){if(W.LM.onMiniGame()&&o.oppoSubs&&0<o.oppoSubs.length)for(let t=0;t<o.oppoSubs.length;t++)-1!=e.indexOf(o.oppoSubs[t].path)&&(e=e.replace(o.oppoSubs[t].pathC,""));var t=e.split("/");if(t.length<=1)throw new Error(`输入路径"${e}"有误`);return[t[t.length-2],t[t.length-1],t.slice(0,t.length-1).join("/")]}function i(t){var[t,e]=d(t);return`ui://${t}/`+e}function e(e,t,i){let s=null,a=null;if(e instanceof Array){s=[],a=[];for(let t=0;t<e.length;t++){var[h,r,n]=d(e[t]);s.push(n),a.push([h,r])}}else{var[o,l,_]=d(e);s=_,a=[o,l]}fgui.UIPackage.loadPackage(s,Laya.Handler.create(t,()=>{i.call(t,a)}))}function l(t,e=fgui.GRoot.inst){var[t,i,,]=d(t),t=fgui.UIPackage.getByName(t);if(t){var s=t.getItemByName(i);if(s)for(let t=0;t<e.numChildren;t++){var a=e.getChildAt(t);if(a.packageItem&&a.packageItem.id==s.id&&a.packageItem.owner==s.owner)return!0}}return!1}o.Version="1.0.7",o.DEBUG=!1,o.SoundClick=5e4,o.oppoSubs=null,o.CH={[0]:"wx",1:"qq",2:"zj",3:"baidu",4:"vivo",5:"oppo",6:"huawei",7:"xiaomi",8:"kuaishou",9:"uc",10:"meizu",11:"4399"},o.pool=new fgui.GObjectPool,o.onClick=function(t,e,i,s,a=o.SoundClick){t.onClick(e,()=>{a&&Laya.SoundManager.playSound(W.LM.Res(a),1),Array.isArray(s)?i.apply(e,s):i.call(e,s)})},o.split=d,o.url=i,o.bind=function(e){if("string"==typeof e[0])fgui.UIObjectFactory.setExtension(i(e[0]),e[1]);else for(let t=0;t<e.length;t++)fgui.UIObjectFactory.setExtension(i(e[t][0]),e[t][1])},o.load=e,o.exists=l,o.open=function(i,s,a,h,t){!t&&l(i)?o.DEBUG&&console.warn("请勿重复打开界面:"+i):e(i,s,t=>{if(l(i))o.DEBUG&&console.warn("请勿重复打开界面:"+i);else{t=fgui.UIPackage.createObject(t[0],t[1]);if(!t)throw new Error(`创建组件"${i}"失败，请检查路径，和是否在编辑器中设置为导出`);o.DEBUG&&_(t)&&console.warn("打开原生组件:",i),t.makeFullScreen(),fgui.GRoot.inst.addChild(t),t._pivotAsAnchor&&t.setXY(t.width*t.pivotX,t.height*t.pivotY);var e=t;e.onOpened&&e.onOpened(h),a&&a.call(s,t)}})},o.close=function(t,e,i){var[t,s,,]=d(t);if(t=fgui.UIPackage.getByName(t)){var a=t.getItemByName(s);if(a)for(let t=fgui.GRoot.inst.numChildren-1;0<=t;t--){var h=fgui.GRoot.inst.getChildAt(t);h.packageItem&&h.packageItem.id==a.id&&h.packageItem.owner==a.owner&&(i&&i.call(e,h),h.onClosed&&h.onClosed(),h.dispose())}}},o.closeAll=function(e){for(let t=fgui.GRoot.inst.numChildren-1;0<=t;t--){var i=fgui.GRoot.inst.getChildAt(t);e&&!e(i)||(i.onClosed&&i.onClosed(),i.dispose())}},o.show=function(i,s,a,h,r=0,n=0,t){!t&&l(i)||e(i,s,t=>{t=fgui.UIPackage.createObject(t[0],t[1]);if(!t)throw new Error(`创建组件"${i}"失败，请检查路径，和是否在编辑器中设置为导出`);o.DEBUG&&_(t)&&console.warn("打开原生组件:",i),fgui.GRoot.inst.addChild(t),t._pivotAsAnchor?t.setXY((fgui.GRoot.inst.width-t.width)/2+r+t.width*t.pivotX,(fgui.GRoot.inst.height-t.height)/2+n+t.height*t.pivotY):t.setXY((fgui.GRoot.inst.width-t.width)/2+r,(fgui.GRoot.inst.height-t.height)/2+n);var e=t;e.onOpened&&e.onOpened(h),a&&a.call(s,t)})},o.create=function(t){var[e,i]=d(t);if(e=fgui.UIPackage.createObject(e,i))return o.DEBUG&&_(e)&&console.warn("打开原生组件:",t),e.asCom;throw new Error(`创建组件"${t}"失败，请检查路径，和是否在编辑器中设置为导出`)};const s=Object.keys(fgui);function _(t){var e=Object.getPrototypeOf(t);for(let t=0;t<s.length;t++){var i=fgui[s[t]];if(i&&i.prototype===e)return!0}return!1}o.isNative=_}(FGUI),function(l){{var _=l.Queue||(l.Queue={});const d=[],e=()=>{var t,e;d.length<=0?Laya.timer.clearAll(_):d[0][0]&&null==d[0][0]._parent&&(d.shift(),d.length)&&([t,e]=d[0],e(),null==d[0][0])&&d.shift()};_.open=function(s,a,h,r){l.load(s,a,i=>{var t=()=>{var t=fgui.UIPackage.createObject(i[0],i[1]);if(!t)throw new Error(`创建组件"${s}"失败，请检查路径，和是否在编辑器中设置为导出`);l.DEBUG&&l.isNative(t)&&console.warn("打开原生组件:",s),t.makeFullScreen(),fgui.GRoot.inst.addChild(t),t._pivotAsAnchor&&t.setXY(t.width*t.pivotX,t.height*t.pivotY);var e=t;e.onOpened&&e.onOpened(r),h&&h.call(a,t),d[0][0]=t};d.length<=0?(d.push([null,t]),t()):(d.push([null,t]),Laya.timer.frameLoop(1,_,e))})},_.show=function(s,a,h,r,n=0,o=0){l.load(s,a,i=>{var t=()=>{var t=fgui.UIPackage.createObject(i[0],i[1]);if(!t)throw new Error(`创建组件"${s}"失败，请检查路径，和是否在编辑器中设置为导出`);l.DEBUG&&l.isNative(t)&&console.warn("打开原生组件:",s),fgui.GRoot.inst.addChild(t),t._pivotAsAnchor?t.setXY((fgui.GRoot.inst.width-t.width)/2+n+t.width*t.pivotX,(fgui.GRoot.inst.height-t.height)/2+o+t.height*t.pivotY):t.setXY((fgui.GRoot.inst.width-t.width)/2+n,(fgui.GRoot.inst.height-t.height)/2+o);var e=t;e.onOpened&&e.onOpened(r),h&&h.call(a,t),d[0][0]=t};d.length<=0?(d.push([null,t]),t()):(d.push([null,t]),Laya.timer.frameLoop(1,_,e))})}}}(FGUI),function(e){class t extends fgui.GButton{constructor(){super(...arguments),this.ch=null}onConstruct(){if(null!=this.ch)if(this.ch instanceof fgui.Controller)this.ch.setSelectedPage(e.CH[W.LM.h]);else if(this.ch instanceof Array)for(let t=0;t<this.ch.length;t++)this.ch[t].setSelectedPage(e.CH[W.LM.h]);this.onUpdate&&Laya.timer.frameLoop(1,this,this.onUpdate)}dispose(){Laya.timer.clearAll(this),Laya.Tween.clearAll(this),super.dispose()}}e.Button=t}(FGUI),function(e){class t extends fgui.GComponent{constructor(){super(...arguments),this.ch=null}onConstruct(){if(null!=this.ch)if(this.ch instanceof fgui.Controller)this.ch.setSelectedPage(e.CH[W.LM.h]);else if(this.ch instanceof Array)for(let t=0;t<this.ch.length;t++)this.ch[t].setSelectedPage(e.CH[W.LM.h]);this.onUpdate&&Laya.timer.frameLoop(1,this,this.onUpdate)}dispose(){Laya.timer.clearAll(this),Laya.Tween.clearAll(this),super.dispose()}}e.Comp=t}(FGUI),function(t){class e extends t.Comp{constructor(){super(...arguments),this.main=null,this.bg=null,this.play_ani_show=!0,this.play_ani_hide=!0}onConstruct(){var t;super.onConstruct(),null!=this.ani_show&&this.ani_show instanceof fgui.Transition?this.ani_show.playing||this.ani_show._autoPlay||this.ani_show.play():this.play_ani_show&&null!=this.main&&this.main instanceof fgui.GComponent&&(this._ani_show||(this.bg||(t=this.getChildAt(0))&&t instanceof fgui.GImage&&t.width==this.width&&t.height==this.height&&(this.bg=t),this.bg&&this.bg instanceof fgui.GImage&&(this.bg.alpha=0,fgui.GTween.to(0,1,.133).setTarget(this.bg,"alpha").setEase(fgui.EaseType.Linear)),this.main.alpha=0,fgui.GTween.to(0,1,.2).setTarget(this.main,"alpha").setEase(fgui.EaseType.Linear),this.main.setScale(0,0),this._ani_show=fgui.GTween.to(0,1.08,.167).setTarget(this,this.refreshMain).setEase(fgui.EaseType.ExpoOut).onComplete(()=>{this._ani_show=fgui.GTween.to(1.08,1,.3-.167).setTarget(this,this.refreshMain).setEase(fgui.EaseType.QuadOut)},this)))}dispose(t=!0){Laya.timer.clearAll(this),Laya.Tween.clearAll(this),t&&this.play_ani_hide?null!=this.ani_hide&&this.ani_hide instanceof fgui.Transition?this.ani_hide.playing||this.ani_hide.play(Laya.Handler.create(this,this.onHideComplete)):null!=this.main&&this.main instanceof fgui.GComponent?this._ani_hide||(this.bg&&this.bg instanceof fgui.GImage&&fgui.GTween.to(1,0,.2).setTarget(this.bg,"alpha").setEase(fgui.EaseType.Linear).setDelay(.067),fgui.GTween.to(1,0,.267-.15).setTarget(this.main,"alpha").setEase(fgui.EaseType.Linear).setDelay(.15),this._ani_hide=fgui.GTween.to(1,1.08,.133).setTarget(this,this.refreshMain).setEase(fgui.EaseType.ExpoIn).onComplete(()=>{this._ani_hide=fgui.GTween.to(1.08,0,.134).setTarget(this,this.refreshMain).setEase(fgui.EaseType.QuadIn).onComplete(this.onHideComplete,this)},this)):super.dispose():super.dispose()}refreshMain(t){this.main.setScale(t,t)}onHideComplete(){super.dispose()}}t.Dialog=e}(FGUI),function(e){class t extends fgui.GProgressBar{constructor(){super(...arguments),this.ch=null}onConstruct(){if(null!=this.ch)if(this.ch instanceof fgui.Controller)this.ch.setSelectedPage(e.CH[W.LM.h]);else if(this.ch instanceof Array)for(let t=0;t<this.ch.length;t++)this.ch[t].setSelectedPage(e.CH[W.LM.h]);this.onUpdate&&Laya.timer.frameLoop(1,this,this.onUpdate)}dispose(){Laya.timer.clearAll(this),Laya.Tween.clearAll(this),super.dispose()}}e.Progress=t}(FGUI),function(t){class e extends t.Comp{constructor(){super(...arguments),this.play_ani_show=!0,this.play_ani_hide=!0}onConstruct(){super.onConstruct(),null!=this.ani_show&&this.ani_show instanceof fgui.Transition?this.ani_show.playing||this.ani_show._autoPlay||this.ani_show.play():this.play_ani_show&&!this._ani_show&&(this.setScale(0,0),this._ani_show=fgui.GTween.to(0,1,.25),this._ani_show.setTarget(this,this.refreshMain).setEase(fgui.EaseType.BackOut))}dispose(t=!0){Laya.timer.clearAll(this),Laya.Tween.clearAll(this),t&&this.play_ani_hide?null!=this.ani_hide&&this.ani_hide instanceof fgui.Transition?this.ani_hide.playing||this.ani_hide.play(Laya.Handler.create(this,this.onHideComplete)):this._ani_hide||(this._ani_hide=fgui.GTween.to(1,0,.25),this._ani_hide.setTarget(this,this.refreshMain).setEase(fgui.EaseType.BackIn),this._ani_hide.onComplete(this.onHideComplete,this)):super.dispose()}refreshMain(t){this.setScale(t,t)}onHideComplete(){super.dispose()}}t.Window=e}(FGUI),function(p){{var t=p.Anim||(p.Anim={});let d={x:0,y:0,z:0};t.boom=function(e,i,s,a,h,r,n=fgui.GRoot.inst){for(let t=0;t<h;t++){const u=p.pool.getObject(e[W.Ran.int(e.length-1,0)]);n.addChild(u),u.touchable=!1,u.setScale(1,1),u.setPivot(.5,.5);var o=W.Ran.int(360,0),l=W.Ran.int(s,0),_=i.x+l*-Math.sin(o)-u.width/2,l=i.y+l*Math.cos(o)-u.height/2,d=W.Ran.int(a,a-s),c=i.x+d*-Math.sin(o)-u.width/2,d=i.y+d*Math.cos(o)-u.height/2,o=(u.setXY(_,l),W.Ran.int(r[0],r[1]));Laya.Tween.to(u,{x:c,y:d},o),Laya.Tween.to(u,{scaleX:0,scaleY:0},o,void 0,Laya.Handler.create(u,()=>{u.removeFromParent(),p.pool.returnObject(u)}))}},t.boomFly=function(e,i,s,a,h=10,r=80,n=800,o=800,l=fgui.GRoot.inst){for(let t=0;t<h;t++){const u=p.pool.getObject(e);l.addChild(u),u.touchable=!1,u.setXY(i.x,i.y),a&&a(u);var _=W.Ran.int(360,0),d=W.Ran.int(r,r/2),c=i.x+d*-Math.sin(_),d=i.y+d*Math.cos(_),_=W.Ran.int(n,n/2);const g=W.Ran.int(o,o/2);Laya.Tween.to(u,{x:c,y:d},_,null,Laya.Handler.create(u,()=>{Laya.Tween.to(u,{x:s.x,y:s.y},g,null,Laya.Handler.create(u,()=>{u.removeFromParent(),p.pool.returnObject(u)}))}))}},t.upAlpha=function(t,e,i,s=1e3,a=200,h=0,r=Laya.Ease.linearNone,n=fgui.GRoot.inst){const o=p.pool.getObject(t);n.addChild(o),o.touchable=!1,o.setXY(e.x,e.y),o.alpha=1,i&&i(o),Laya.Tween.to(o,{y:o.y-a,alpha:h},s,r,Laya.Handler.create(o,()=>{o.removeFromParent(),p.pool.returnObject(o)}))},t.upAlphaWithSp3=function(t,e,i=0,s=0,a,h=1e3,r=200,n=0,o=Laya.Ease.linearNone,l=fgui.GRoot.inst){if(e(d)){const _=p.pool.getObject(t);l.addChild(_),_.touchable=!1,_.setXY(d.x+i,d.y+s),_.alpha=1,a&&a(_),_.animX=0,_.animY=0,Laya.Tween.to(_,{animY:-r,alpha:n},h,o,Laya.Handler.create(_,()=>{Laya.Tween.clearAll(_),Laya.timer.clearAll(_),_.removeFromParent(),p.pool.returnObject(_)})),Laya.timer.frameLoop(1,_,()=>{e(d)?_.setXY(d.x+i+_.animX,d.y+s+_.animY):(Laya.Tween.clearAll(_),Laya.timer.clearAll(_),_.removeFromParent(),p.pool.returnObject(_))})}},t.scaleDown=function(e,i,s,a=8,h=20,r=60,n=360,o=800,l=800,_=fgui.GRoot.inst){for(let t=0;t<a;t++){const u=p.pool.getObject(e);_.addChild(u);var d=W.Ran.int(360,0),c=W.Ran.int(h,h/2),c=(u.touchable=!1,u.setPivot(.5,.5),u.setScale(0,0),u.setXY(i.x+c*-Math.sin(d),i.y+c*Math.cos(d)),u.rotation=0,s&&s(u),W.Ran.int(o,o/2));const g=W.Ran.int(l,l/2);Laya.Tween.to(u,{rotation:n},c+g),Laya.Tween.to(u,{scaleX:1,scaleY:1},c,null,Laya.Handler.create(u,()=>{Laya.Tween.to(u,{y:u.y+r,scaleX:0,scaleY:0},g,null,Laya.Handler.create(u,()=>{u.removeFromParent(),p.pool.returnObject(u)}))}))}},t.showToast=function(t,e,i,s=300,a=2e3,h=300,r=fgui.GRoot.inst){const n=p.pool.getObject(t);r.addChild(n),n.touchable=!1,n.setPivot(.5,.5),n.setScale(0,0),n.setXY(e.x-n.width/2,e.y-n.height/2),i&&i(n),Laya.Tween.to(n,{scaleX:1,scaleY:1},s,Laya.Ease.backOut,Laya.Handler.create(n,()=>{Laya.timer.once(a,n,()=>{Laya.Tween.to(n,{scaleX:0,scaleY:0},h,Laya.Ease.backIn,Laya.Handler.create(n,()=>{n.removeFromParent(),p.pool.returnObject(n)}))})}))},t.star=function(e,i,s,a,h=200,r=200,n=200,o=fgui.GRoot.inst){return function(){const t=p.pool.getObject(e);o.addChild(t),t.touchable=!1,t.setPivot(.5,.5),t.setScale(0,0),t.alpha=0,t.setXY(W.Ran.int(s.x,i.x),W.Ran.int(s.y,i.y)),a&&a(t),Laya.Tween.to(t,{scaleX:1,scaleY:1,alpha:1},h,Laya.Ease.backOut,Laya.Handler.create(t,()=>{Laya.timer.once(r,t,()=>{Laya.Tween.to(t,{scaleX:0,scaleY:0,alpha:0},n,Laya.Ease.backIn,Laya.Handler.create(t,()=>{t.removeFromParent(),p.pool.returnObject(t)}))})}))}}}}(FGUI),function(i){{var t=i.Barrage||(i.Barrage={});function s(e,t,i,s,a=0){e.x=t;let h=!1;return function(){var t;return!!h||(0<a?void(a-=Laya.timer.delta):(t=lerp(t=e.x,i,s*Laya.timer.delta),e.x=t,h=e.x==i))}}function a(e,t,i,s,a=0){e.y=t;let h=!1;return function(){var t;return!!h||(0<a?void(a-=Laya.timer.delta):(t=lerp(t=e.y,i,s*Laya.timer.delta),e.y=t,h=e.y==i))}}function h(e,t,i,s,a=0){e.rotation=t;let h=!1;return function(){var t;return!!h||(0<a?void(a-=Laya.timer.delta):(t=lerp(t=e.rotation,i,s*Laya.timer.delta),e.rotation=t,i==1/0||(h=e.rotation==i)))}}function r(e,t,i,s,a=0){e.setScale(t,t);let h=!1;return function(){var t;return!!h||(0<a?void(a-=Laya.timer.delta):(t=lerp(t=e.scaleX,i,s*Laya.timer.delta),e.setScale(t,t),i==1/0||(h=e.scaleX==i)))}}t.posX=s,t.posY=a,t.rotation=h,t.rotationRange=function(e,i,s,a,t=0){let h=!0;return function(){if(!(0<t)){let t=e.rotation;return h?(t=lerp(t,s,a*Laya.timer.delta))==s&&(h=!1):(t=lerp(t,i,a*Laya.timer.delta))==i&&(h=!0),e.rotation=t,!0}t-=Laya.timer.delta}},t.scale=r,t.scaleRange=function(e,i,s,a,t=0){let h=!0;return function(){if(!(0<t)){let t=e.scaleX;return h?(t=lerp(t,i,a*Laya.timer.delta))==i&&(h=!1):(t=lerp(t,s,a*Laya.timer.delta))==s&&(h=!0),e.setScale(t,t),!0}t-=Laya.timer.delta}},t.alpha=function(e,t,i,s,a=0){e.alpha=t;let h=!1;return function(){var t;return!!h||(0<a?void(a-=Laya.timer.delta):(t=lerp(t=e.alpha,i,s*Laya.timer.delta),e.alpha=t,i==1/0||(h=e.alpha==i)))}},t.delay=function(t,e=0){return function(){return!(0<e&&(e-=Laya.timer.delta,1))}},t.bezier=function(h,r,n,o,l,_,d=0){h.setXY(n.x,n.y);let c=0;return function(){if(0<d)d-=Laya.timer.delta;else{if(c>=r)return!0;var t,e,i,s,a=(c+=Laya.timer.delta)/r;null!=_?(e=n,i=l,s=_,t=o,h.setXY(Math.pow(1-a,3)*e.x+3*i.x*a*(1-a)*(1-a)+3*s.x*a*a*(1-a)+t.x*Math.pow(a,3),Math.pow(1-a,3)*e.y+3*i.y*a*(1-a)*(1-a)+3*s.y*a*a*(1-a)+t.y*Math.pow(a,3))):(e=n,i=l,s=o,h.setXY(Math.pow(1-a,2)*e.x+2*a*(1-a)*i.x+Math.pow(a,2)*s.x,Math.pow(1-a,2)*e.y+2*a*(1-a)*i.y+Math.pow(a,2)*s.y))}return!1}};class n{constructor(t){this.funcs=[],(this.obj=t).touchable=!1,t.setPivot(.5,.5)}comp(t,...e){return this.funcs.push([t(this.obj,...e)]),this}comps(e){var i=[];for(let t=0;t<e.length;t++){var s=e[t][0],a=e[t].slice(1);i.push(s(this.obj,...a))}return this.funcs.push(i),this}complete(t){return this.cb=t,this}clear(){return this.funcs.length=0,this}default(){this.funcs.length=0;var t=fgui.GRoot.inst,e=W.Ran.int(t.width,0);return this.comp(s,e,e,0).comp(a,-this.obj.height,t.height,.2).comp(h,0,1/0,.2*(W.Ran.bool(.5)?1:-1)).comp(r,W.Ran.real(.8,.4),0,.001,W.Ran.int(5e3,1e3))}update(){let e=!0;for(let t=0;t<this.funcs.length;t++){var i=(0,this.funcs[t][0])();i&&1<this.funcs[t].length&&this.funcs[t].shift(),e=i&&this.funcs[t].length<=1&&e}return e}}const o=[];t.clear=function(){for(let t=o.length-1;0<=t;t--)o[t].obj.removeFromParent(),i.pool.returnObject(o[t].obj);o.length=0},t.add=function(t,e=fgui.GRoot.inst){return t=new n(i.pool.getObject(t)),e.addChild(t.obj),o.push(t),t},t.update=function(){for(let t=o.length-1;0<=t;t--){var e=o[t];e.update()&&(o.splice(t,1),e.clear(),e.obj.removeFromParent(),i.pool.returnObject(e.obj),e.cb)&&e.cb()}}}}(FGUI),function(h){(h.Clip||(h.Clip={})).playEffect=function(t,e,i=1,s={x:.5,y:.5},a=fgui.GRoot.inst){t=h.pool.getObject(t),a.addChild(t),t.setXY(e.x-t.width*s.x,e.y-t.height*s.y),a=0==i?void 0:Laya.Handler.create(t,function(){this.removeFromParent(),h.pool.returnObject(this)}),t.setPlaySettings(0,-1,i,void 0,a)}}(FGUI),function(a){{var t=a.Tool||(a.Tool={});function s(e,i){if(e.cell&&i(e.cell),e._children)for(let t=0;t<e.numChildren;t++)s(e.getChildAt(t),i)}function e(t,e){var i=e.localToGlobal(),s=t.x,t=t.y,a=e.width*e.scaleX,h=e.height*e.scaleY;return e._pivotAsAnchor?s>=i.x-a*e.pivotX&&s<=i.x+a*(1-e.pivotX)&&t>=i.y-h*e.pivotY&&t<=i.y+h*(1-e.pivotY):s>=i.x&&s<=i.x+a&&t>=i.y&&t<=i.y+h}t.recursiveTree=function(e,i){for(let t=0;t<e.numChildren;t++)s(e.getChildAt(t).treeNode,i)},t.recursiveTreeNode=s,t.posIn=e;const i={x:0,y:0};function h(t,e){var i=t.bitmap;if(!i)return null;let s;try{s=i.getPixels()}catch(t){return console.log("未导出的图片",i),null}var a=i.width,i=i.height,t=t.uvrect,h=t[0]*a,i=t[1]*i,t=(t[2],t[3],h+e.x),h=i+e.y,i=Math.round(h),e=Math.round(t),h=Math.round(i*a*4+4*e);return[s[h],s[h+1],s[h+2],s[h+3]]}t.mouseIn=function(t){return i.x=Laya.stage.mouseX,i.y=Laya.stage.mouseY,e(i,t)},t.getImagePixel=h,t.RadioGroup=class{constructor(e){if(this.buttons=[],this.ctr="select",e.controller&&(this.ctr=e.controller),e.list)this.buttons=e.list;else if(e.parent)for(let t=0;t<e.parent.numChildren;t++){var i=e.parent.getChildAt(t);(!e.reg||e.reg.test(i.name))&&this.buttons.push(i)}for(let t=0;t<this.buttons.length;t++){var s=this.buttons[t];s instanceof fgui.GButton?a.onClick(s,this,this.onBtnClick,[t,s]):s.on(Laya.Event.MOUSE_UP,this,this.onBtnClick,[t,s])}this.setSelect(0)}selectIndex(t){this.setSelect(t,null)}selectObj(t){this.setSelect(null,t)}onBtnClick(t,e){this.setSelect(t,e)}setSelect(e,i){if(null!=e)for(let t=0;this.buttons.length;t++){var s=this.buttons[t],a=s.getController(this.ctr);e==t?(a&&(a.selectedIndex=1),this.onSelect&&this.onSelect(t,s),this.selected=s,this.index=t):(a&&(a.selectedIndex=0),this.onUnSelect&&this.onUnSelect(t,s))}else if(null!=i)for(let t=0;this.buttons.length;t++){var h=this.buttons[t],r=h.getController(this.ctr);i==h?(r&&(r.selectedIndex=1),this.onSelect&&this.onSelect(t,h),this.selected=h,this.index=t):(r&&(r.selectedIndex=0),this.onUnSelect&&this.onUnSelect(t,h))}else for(let t=0;this.buttons.length;t++){var n=this.buttons[t],o=n.getController(this.ctr);o&&(o.selectedIndex=0),this.onUnSelect&&this.onUnSelect(t,n)}}},t.ImageRadioGroup=class{constructor(e,i){if(this.images=[],this.obj=e,i.list)this.images=i.list;else for(let t=0;t<e.numChildren;t++){var s=e.getChildAt(t);(!i.reg||i.reg.test(s.name))&&this.images.push(s)}e.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),e.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),e.on(Laya.Event.MOUSE_OVER,this,this.onMouseOver),e.on(Laya.Event.MOUSE_OUT,this,this.onMouseOver)}onMouseDown(){var t=this.obj.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY),e=t.x,i=t.y;for(let t=0;t<this.images.length;t++){var s=this.images[t];if(s._pivotAsAnchor?e>=s.x-s.width*s.pivotX&&e<=s.x+s.width*(1-s.pivotX)&&i>=s.y-s.height*s.pivotY&&i<=s.y+s.height*(1-s.pivotY):e>=s.x&&e<=s.x+s.width&&i>=s.y&&i<=s.y+s.height){var a=h(s.image.texture,s.globalToLocal(Laya.stage.mouseX,Laya.stage.mouseY));if(a&&(0!=a[0]||0!=a[1]||0!=a[2])){this.onImageDown&&this.onImageDown(t,s),this.selected=s,this.index=t;break}}}}onMouseUp(){this.selected&&this.onImageUp&&this.onImageUp(this.index,this.selected)}onMouseOver(){this.selected&&this.onImageOver&&this.onImageOver(this.index,this.selected)}}}}(FGUI),function(t){(t.Loader||(t.Loader={})).Init=function(v="atlas"){Laya.Loader.prototype.onLoaded=function(i=null){if((l=this._type)==Laya.Loader.PLFB)this.parsePLFBData(i),this.complete(i);else if(l==Laya.Loader.PLF)this.parsePLFData(i),this.complete(i);else if(l===Laya.Loader.IMAGE){let e;if(i instanceof ArrayBuffer){let t;switch(o=Laya.Utils.getFileExtension(this._url)){case"ktx":t=Laya.TextureFormat.ETC1RGB;break;case"pvr":t=Laya.TextureFormat.PVRTCRGBA_4BPPV;break;default:return void console.error("unknown format",o)}(e=new Laya.Texture2D(0,0,t,!1,!1)).wrapModeU=Laya.WarpMode.Clamp,e.wrapModeV=Laya.WarpMode.Clamp,e.setCompressData(i),e._setCreateURL(this.url)}else i instanceof Laya.Texture2D?e=i:((e=new Laya.Texture2D(i.width,i.height,1,!1,i.src.includes(v))).wrapModeU=Laya.WarpMode.Clamp,e.wrapModeV=Laya.WarpMode.Clamp,e.loadImageSource(i,!0),e._setCreateURL(i.src));var s=new Laya.Texture(e);s.url=this._url,this.complete(s)}else if(l===Laya.Loader.SOUND||"nativeimage"===l)this.complete(i);else if("htmlimage"===l){s=new Laya.Texture2D(i.width,i.height,1,!1,i.src.includes(v));s.wrapModeU=Laya.WarpMode.Clamp,s.wrapModeV=Laya.WarpMode.Clamp,s.loadImageSource(i,!0),s._setCreateURL(i.src),this.complete(s)}else if(l===Laya.Loader.ATLAS){if(i.frames){var t=[];if(!this._data){if((this._data=i).meta&&i.meta.image){var t=i.meta.image.split(","),s=0<=this._url.indexOf("/")?"/":"\\",s=this._url.lastIndexOf(s),e=0<=s?this._url.substr(0,s+1):"",a=null;Laya.Browser.onAndroid&&i.meta.compressTextureAndroid&&(a=".ktx"),Laya.Browser.onIOS&&i.meta.compressTextureIOS&&(a=i.meta.astc?".ktx":".pvr");for(var h=0,r=t.length;h<r;h++)t[h]=a?e+t[h].replace(".png",a):e+t[h]}else t=[this._url.replace(".json",".png")];t.reverse(),i.toLoads=t,i.pics=[]}this.event(Laya.Event.PROGRESS,.3+1/t.length*.6);var n=Laya.URL.formatURL(t.pop()),o=Laya.Utils.getFileExtension(n),l=Laya.Loader.IMAGE;return"pvr"!=o&&"ktx"!=o||(l=Laya.Loader.BUFFER),this._loadResourceFilter(l,n)}if(!(i instanceof Laya.Texture2D))if(i instanceof ArrayBuffer){n=this._http?this._http.url:this._url;let t;switch(o=Laya.Utils.getFileExtension(n)){case"ktx":t=Laya.TextureFormat.ETC1RGB;break;case"pvr":t=Laya.TextureFormat.PVRTCRGBA_4BPPV;break;default:return void console.error("unknown format",o)}s=new Laya.Texture2D(0,0,t,!1,!1);s.wrapModeU=Laya.WarpMode.Clamp,s.wrapModeV=Laya.WarpMode.Clamp,s.setCompressData(i),s._setCreateURL(n),i=s}else{s=new Laya.Texture2D(i.width,i.height,1,!1,!1);s.wrapModeU=Laya.WarpMode.Clamp,s.wrapModeV=Laya.WarpMode.Clamp,s.loadImageSource(i,!0),s._setCreateURL(i.src),i=s}if(this._data.pics.push(i),0<this._data.toLoads.length)return this.event(Laya.Event.PROGRESS,.3+1/this._data.toLoads.length*.6),n=Laya.URL.formatURL(this._data.toLoads.pop()),o=Laya.Utils.getFileExtension(n),l=Laya.Loader.IMAGE,"pvr"!=o&&"ktx"!=o||(l=Laya.Loader.BUFFER),this._loadResourceFilter(l,n);var _,d=this._data.frames,s=this._url.split("?")[0],c=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:s.substring(0,s.lastIndexOf("."))+"/",u=this._data.pics,s=Laya.URL.formatURL(this._url),g=Laya.Loader.atlasMap[s]||(Laya.Loader.atlasMap[s]=[]);g.dir=c;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var p in _=parseFloat(this._data.meta.scale),d){var y,f=d[p],m=u[f.frame.idx||0];n=c+p,m.scaleRate=_,y=Laya.Texture._create(m,f.frame.x,f.frame.y,f.frame.w,f.frame.h,f.spriteSourceSize.x,f.spriteSourceSize.y,f.sourceSize.w,f.sourceSize.h,Laya.Loader.getRes(n)),Laya.Loader.cacheTexture(n,y),y.url=n,g.push(n)}else for(p in d)m=u[(f=d[p]).frame.idx||0],n=c+p,y=Laya.Texture._create(m,f.frame.x,f.frame.y,f.frame.w,f.frame.h,f.spriteSourceSize.x,f.spriteSourceSize.y,f.sourceSize.w,f.sourceSize.h,Laya.Loader.getRes(n)),Laya.Loader.cacheTexture(n,y),y.url=n,g.push(n);delete this._data.pics,this.complete(this._data)}else if(l===Laya.Loader.FONT){if(!i._source)return this._data=i,this.event(Laya.Event.PROGRESS,.5),this._loadResourceFilter(Laya.Loader.IMAGE,this._url.replace(".fnt",".png"));var s=new Laya.BitmapFont,w=(s.parseFont(this._data,new Laya.Texture(i)),this._url.split(".fnt")[0].split("/")),w=w[w.length-1];Laya.Text.registerBitmapFont(w,s),this._data=s,this.complete(this._data)}else l===Laya.Loader.PREFAB?((w=new Laya.Prefab).json=i,this.complete(w)):this.complete(i)}}}(FGUI),function(t){t.RenderSprite||(t.RenderSprite={});Laya.RenderSprite.prototype._canvas_repaint=function(t,e,i,s){var a,h=t._cacheStyle,r=this._next,n=h.canvas,o=h.cacheAs,l=h._calculateCacheRect(t,o,i,s),_=l.x,l=l.y,d=h.cacheRect,c=d.width*_,u=d.height*l,g=d.x,d=d.y;"bitmap"===o&&(2048<c||2048<u)?(console.warn("cache bitmap size larger than 2048,cache ignored"),h.releaseContext(),r._fun.call(r,t,e,i,s)):(n||(h.createContext(),n=h.canvas),(e=n.context).sprite=t,n.width==c&&n.height==u||n.size(c,u),"bitmap"===o?(e._width&&e._height||(e._width=1,e._height=1),e.asBitmap=!0):"normal"===o&&(e.asBitmap=!1),e.clear(),1!=_||1!=l?((a=e).save(),a.scale(_,l),r._fun.call(r,t,e,-g,-d),a.restore()):(a=e,r._fun.call(r,t,e,-g,-d)),t._applyFilters(),h.staticCache&&(h.reCache=!1),Laya.Stat.canvasReCache++)}}(FGUI),function(e){e.ControllerAction=class{constructor(){}static createAction(t){switch(t){case 0:return new e.PlayTransitionAction;case 1:return new e.ChangePageAction}return null}run(t,e,i){null!=this.fromPage&&0!=this.fromPage.length&&-1==this.fromPage.indexOf(e)||null!=this.toPage&&0!=this.toPage.length&&-1==this.toPage.indexOf(i)?this.leave(t):this.enter(t)}enter(t){}leave(t){}setup(t){var e,i=t.getInt16();for(this.fromPage=[],e=0;e<i;e++)this.fromPage[e]=t.readS();for(i=t.getInt16(),this.toPage=[],e=0;e<i;e++)this.toPage[e]=t.readS()}}}(fgui),function(t){class e extends t.ControllerAction{constructor(){super()}enter(t){var e;this.controllerName&&(e=this.objectId?t.parent.getChildById(this.objectId):t.parent)&&(e=e.getController(this.controllerName))&&e!=t&&!e.changing&&("~1"==this.targetPage?t.selectedIndex<e.pageCount&&(e.selectedIndex=t.selectedIndex):"~2"==this.targetPage?e.selectedPage=t.selectedPage:e.selectedPageId=this.targetPage)}setup(t){super.setup(t),this.objectId=t.readS(),this.controllerName=t.readS(),this.targetPage=t.readS()}}t.ChangePageAction=e}(fgui),function(t){class e extends t.ControllerAction{constructor(){super()}enter(t){t=t.parent.getTransition(this.transitionName);t&&(this._currentTransition&&this._currentTransition.playing?t.changePlayTimes(this.playTimes):t.play(null,this.playTimes,this.delay),this._currentTransition=t)}leave(t){this.stopOnExit&&this._currentTransition&&(this._currentTransition.stop(),this._currentTransition=null)}setup(t){super.setup(t),this.transitionName=t.readS(),this.playTimes=t.getInt32(),this.delay=t.getFloat32(),this.stopOnExit=t.readBool()}}t.PlayTransitionAction=e}(fgui),function(t){t.BitmapFont=class{constructor(){this.size=0,this.glyphs={}}}}(fgui),function(o){function n(t,e,i,s,a){var h,r,n;switch((!s||i!=o.FillOrigin.TopRight&&i!=o.FillOrigin.BottomLeft)&&(s||i!=o.FillOrigin.TopLeft&&i!=o.FillOrigin.BottomRight)||(a=1-a),h=((r=t*Math.tan(Math.PI/2*a))-e)/r,i){case o.FillOrigin.TopLeft:n=s?r<=e?[0,0,t,r,t,0]:[0,0,t*(1-h),e,t,e,t,0]:r<=e?[0,0,t,r,t,e,0,e]:[0,0,t*(1-h),e,0,e];break;case o.FillOrigin.TopRight:n=s?r<=e?[t,0,0,r,0,e,t,e]:[t,0,t*h,e,t,e]:r<=e?[t,0,0,r,0,0]:[t,0,t*h,e,0,e,0,0];break;case o.FillOrigin.BottomLeft:n=s?r<=e?[0,e,t,e-r,t,0,0,0]:[0,e,t*(1-h),0,0,0]:r<=e?[0,e,t,e-r,t,e]:[0,e,t*(1-h),0,t,0,t,e];break;case o.FillOrigin.BottomRight:n=s?r<=e?[t,e,0,e-r,0,e]:[t,e,t*h,0,0,0,0,e]:r<=e?[t,e,0,e-r,0,0,t,0]:[t,e,t*h,0,t,0]}return n}function l(t,e,i){for(var s=t.length,a=0;a<s;a+=2)t[a]+=e,t[a+1]+=i}function _(t,e,i,s,a){var h;switch(i){case o.FillOrigin.Top:a<=.5?(h=n(t/2,e,s?o.FillOrigin.TopLeft:o.FillOrigin.TopRight,s,a/=.5),s&&l(h,t/2,0)):(h=n(t/2,e,s?o.FillOrigin.TopRight:o.FillOrigin.TopLeft,s,a=(a-.5)/.5),s?h.push(t,e,t,0):(l(h,t/2,0),h.push(0,e,0,0)));break;case o.FillOrigin.Bottom:a<=.5?(h=n(t/2,e,s?o.FillOrigin.BottomRight:o.FillOrigin.BottomLeft,s,a/=.5),s||l(h,t/2,0)):(h=n(t/2,e,s?o.FillOrigin.BottomLeft:o.FillOrigin.BottomRight,s,a=(a-.5)/.5),s?(l(h,t/2,0),h.push(0,0,0,e)):h.push(t,0,t,e));break;case o.FillOrigin.Left:a<=.5?(h=n(t,e/2,s?o.FillOrigin.BottomLeft:o.FillOrigin.TopLeft,s,a/=.5),s||l(h,0,e/2)):(h=n(t,e/2,s?o.FillOrigin.TopLeft:o.FillOrigin.BottomLeft,s,a=(a-.5)/.5),s?(l(h,0,e/2),h.push(t,0,0,0)):h.push(t,e,0,e));break;case o.FillOrigin.Right:a<=.5?(h=n(t,e/2,s?o.FillOrigin.TopRight:o.FillOrigin.BottomRight,s,a/=.5),s&&l(h,0,e/2)):(h=n(t,e/2,s?o.FillOrigin.BottomRight:o.FillOrigin.TopRight,s,a=(a-.5)/.5),s?h.push(0,e,t,e):(l(h,0,e/2),h.push(0,0,t,0)))}return h}o.fillImage=function(t,e,i,s,a,h){if(h<=0)return null;if(.9999<=h)return[0,0,t,0,t,e,0,e];var r;switch(i){case o.FillMethod.Horizontal:r=function(t,e,i,s){s*=t;return i==o.FillOrigin.Left||i==o.FillOrigin.Top?[0,0,s,0,s,e,0,e]:[t,0,t,e,t-s,e,t-s,0]}(t,e,s,h);break;case o.FillMethod.Vertical:r=function(t,e,i,s){s*=e;return i==o.FillOrigin.Left||i==o.FillOrigin.Top?[0,0,0,s,t,s,t,0]:[0,e,t,e,t,e-s,0,e-s]}(t,e,s,h);break;case o.FillMethod.Radial90:r=n(t,e,s,a,h);break;case o.FillMethod.Radial180:r=_(t,e,s,a,h);break;case o.FillMethod.Radial360:r=function(t,e,i,s,a){var h;switch(i){case o.FillOrigin.Top:a<=.5?(a/=.5,h=_(t/2,e,s?o.FillOrigin.Left:o.FillOrigin.Right,s,a),s&&l(h,t/2,0)):(a=(a-.5)/.5,h=_(t/2,e,s?o.FillOrigin.Right:o.FillOrigin.Left,s,a),s?h.push(t,e,t,0,t/2,0):(l(h,t/2,0),h.push(0,e,0,0,t/2,0)));break;case o.FillOrigin.Bottom:a<=.5?(a/=.5,h=_(t/2,e,s?o.FillOrigin.Right:o.FillOrigin.Left,s,a),s||l(h,t/2,0)):(a=(a-.5)/.5,h=_(t/2,e,s?o.FillOrigin.Left:o.FillOrigin.Right,s,a),s?(l(h,t/2,0),h.push(0,0,0,e,t/2,e)):h.push(t,0,t,e,t/2,e));break;case o.FillOrigin.Left:a<=.5?(a/=.5,h=_(t,e/2,s?o.FillOrigin.Bottom:o.FillOrigin.Top,s,a),s||l(h,0,e/2)):(a=(a-.5)/.5,h=_(t,e/2,s?o.FillOrigin.Top:o.FillOrigin.Bottom,s,a),s?(l(h,0,e/2),h.push(t,0,0,0,0,e/2)):h.push(t,e,0,e,0,e/2));break;case o.FillOrigin.Right:a<=.5?(a/=.5,h=_(t,e/2,s?o.FillOrigin.Top:o.FillOrigin.Bottom,s,a),s&&l(h,0,e/2)):(a=(a-.5)/.5,h=_(t,e/2,s?o.FillOrigin.Bottom:o.FillOrigin.Top,s,a),s?h.push(0,e,t,e,t,e/2):(l(h,0,e/2),h.push(0,0,t,0,t,e/2)))}return h}(t,e,s,a,h)}return r}}(fgui),function(s){class t extends Laya.Sprite{constructor(){super(),this._tileGridIndice=0,this._needRebuild=0,this._fillMethod=0,this._fillOrigin=0,this._fillAmount=0,this.mouseEnabled=!1,this._color="#FFFFFF"}set width(t){this._width!==t&&(super.set_width(t),this.markChanged(1))}set height(t){this._height!==t&&(super.set_height(t),this.markChanged(1))}get texture(){return this._source}set texture(t){this._source!=t&&(this._source=t,0==this._width&&(this._source?this.size(this._source.width,this._source.height):this.size(0,0)),this.repaint(),this.markChanged(1))}get scale9Grid(){return this._scale9Grid}set scale9Grid(t){this._scale9Grid=t,this._sizeGrid=null,this.markChanged(1)}get scaleByTile(){return this._scaleByTile}set scaleByTile(t){this._scaleByTile!=t&&(this._scaleByTile=t,this.markChanged(1))}get tileGridIndice(){return this._tileGridIndice}set tileGridIndice(t){this._tileGridIndice!=t&&(this._tileGridIndice=t,this.markChanged(1))}get fillMethod(){return this._fillMethod}set fillMethod(t){this._fillMethod!=t&&(this._fillMethod=t,0!=this._fillMethod?(this._mask||(this._mask=new Laya.Sprite,this._mask.mouseEnabled=!1),this.mask=this._mask,this.markChanged(2)):this.mask&&(this._mask.graphics.clear(),this.mask=null))}get fillOrigin(){return this._fillOrigin}set fillOrigin(t){this._fillOrigin!=t&&(this._fillOrigin=t,0!=this._fillMethod)&&this.markChanged(2)}get fillClockwise(){return this._fillClockwise}set fillClockwise(t){this._fillClockwise!=t&&(this._fillClockwise=t,0!=this._fillMethod)&&this.markChanged(2)}get fillAmount(){return this._fillAmount}set fillAmount(t){this._fillAmount!=t&&(this._fillAmount=t,0!=this._fillMethod)&&this.markChanged(2)}get color(){return this._color}set color(t){this._color!=t&&(this._color=t,s.ToolSet.setColorFilter(this,t))}markChanged(t){this._needRebuild?this._needRebuild|=t:(this._needRebuild=t,Laya.timer.callLater(this,this.rebuild))}rebuild(){0!=(1&this._needRebuild)&&this.doDraw(),0!=(2&this._needRebuild)&&0!=this._fillMethod&&this.doFill(),this._needRebuild=0}doDraw(){var t,e,i,s,a=this._width,h=this._height,r=this.graphics,n=this._source;r.clear(),null!=n&&0!=a&&0!=h&&(this._scaleByTile?r.fillTexture(n,0,0,a,h):this._scale9Grid?(this._sizeGrid||(e=n.width,s=n.height,t=this._scale9Grid.x,e=Math.max(e-this._scale9Grid.right,0),i=this._scale9Grid.y,s=Math.max(s-this._scale9Grid.bottom,0),this._sizeGrid=[i,e,s,t,this._tileGridIndice]),r.draw9Grid(n,0,0,a,h,this._sizeGrid)):r.drawImage(n,0,0,a,h))}doFill(){var t=this._width,e=this._height,i=this._mask.graphics;i.clear(),0!=t&&0!=e&&(null==(t=s.fillImage(t,e,this._fillMethod,this._fillOrigin,this._fillClockwise,this._fillAmount))?(this.mask=null,this.mask=this._mask):i.drawPoly(0,0,t,"#FFFFFF"))}}s.Image=t}(fgui),function(t){class e extends t.Image{constructor(){super(),this.interval=0,this.repeatDelay=0,this.timeScale=1,this._playing=!0,this._frameCount=0,this._frame=0,this._start=0,this._end=0,this._times=0,this._endAt=0,this._status=0,this._frameElapsed=0,this._repeatedCount=0,this.mouseEnabled=!1,this.setPlaySettings(),this.on(Laya.Event.DISPLAY,this,this.__addToStage),this.on(Laya.Event.UNDISPLAY,this,this.__removeFromStage)}get frames(){return this._frames}set frames(t){this._frames=t,this._scaleByTile=!1,this._scale9Grid=null,this._frames?(this._frameCount=this._frames.length,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),(-1==this._endAt||this._endAt>this._frameCount-1)&&(this._endAt=this._frameCount-1),(this._frame<0||this._frame>this._frameCount-1)&&(this._frame=this._frameCount-1),this._frameElapsed=0,this._repeatedCount=0,this._reversed=!1):this._frameCount=0,this.drawFrame(),this.checkTimer()}get frameCount(){return this._frameCount}get frame(){return this._frame}set frame(t){this._frame!=t&&(this._frames&&t>=this._frameCount&&(t=this._frameCount-1),this._frame=t,this._frameElapsed=0,this.drawFrame())}get playing(){return this._playing}set playing(t){this._playing!=t&&(this._playing=t,this.checkTimer())}rewind(){this._frame=0,this._frameElapsed=0,this._reversed=!1,this._repeatedCount=0,this.drawFrame()}syncStatus(t){this._frame=t._frame,this._frameElapsed=t._frameElapsed,this._reversed=t._reversed,this._repeatedCount=t._repeatedCount,this.drawFrame()}advance(t){for(var e=this._frame,i=this._reversed,s=t;;){var a=this.interval+this._frames[this._frame].addDelay;if(0==this._frame&&0<this._repeatedCount&&(a+=this.repeatDelay),t<a){this._frameElapsed=0;break}t-=a,this.swing?this._reversed?(this._frame--,this._frame<=0&&(this._frame=0,this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=Math.max(0,this._frameCount-2),this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=0,this._repeatedCount++)),this._frame==e&&this._reversed==i&&(a=s-t,t-=Math.floor(t/a)*a)}this.drawFrame()}setPlaySettings(t,e,i,s,a){null==e&&(e=-1),null==i&&(i=0),null==s&&(s=-1),this._start=t=null==t?0:t,this._end=e,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),this._times=i,this._endAt=s,-1==this._endAt&&(this._endAt=this._end),this._status=0,this._endHandler=a,this.frame=t}update(){var t;this._playing&&0!=this._frameCount&&3!=this._status&&(100<(t=Laya.timer.delta)&&(t=100),1!=this.timeScale&&(t*=this.timeScale),this._frameElapsed+=t,t=this.interval+this._frames[this._frame].addDelay,0==this._frame&&0<this._repeatedCount&&(t+=this.repeatDelay),this._frameElapsed<t||(this._frameElapsed-=t,this._frameElapsed>this.interval&&(this._frameElapsed=this.interval),this.swing?this._reversed?(this._frame--,this._frame<=0&&(this._frame=0,this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=Math.max(0,this._frameCount-2),this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=0,this._repeatedCount++)),1==this._status?(this._frame=this._start,this._frameElapsed=0,this._status=0):2==this._status?(this._frame=this._endAt,this._frameElapsed=0,this._status=3,this._endHandler&&(t=this._endHandler,this._endHandler=null,t.run())):this._frame==this._end&&(0<this._times&&(this._times--,0==this._times)?this._status=2:this._status=1),this.drawFrame()))}drawFrame(){var t;0<this._frameCount&&this._frame<this._frames.length?(t=this._frames[this._frame],this.texture=t.texture):this.texture=null,this.rebuild()}checkTimer(){this._playing&&0<this._frameCount&&null!=this.stage?Laya.timer.frameLoop(1,this,this.update):Laya.timer.clear(this,this.update)}__addToStage(){this._playing&&0<this._frameCount&&Laya.timer.frameLoop(1,this,this.update)}__removeFromStage(){Laya.timer.clear(this,this.update)}}t.MovieClip=e}(fgui),function(a){var i;a.GearBase=class{constructor(t){this._owner=t}static create(t,e){return new(i=i||[a.GearDisplay,a.GearXY,a.GearSize,a.GearLook,a.GearColor,a.GearAnimation,a.GearText,a.GearIcon,a.GearDisplay2,a.GearFontSize])[e](t)}dispose(){this._tweenConfig&&this._tweenConfig._tweener&&(this._tweenConfig._tweener.kill(),this._tweenConfig._tweener=null)}get controller(){return this._controller}set controller(t){t!=this._controller&&(this._controller=t,this._controller)&&this.init()}get tweenConfig(){return this._tweenConfig||(this._tweenConfig=new h),this._tweenConfig}setup(t){this._controller=this._owner.parent.getControllerAt(t.getInt16()),this.init();var e,i,s=t.getInt16();if(this instanceof a.GearDisplay)this.pages=t.readSArray(s);else if(this instanceof a.GearDisplay2)this.pages=t.readSArray(s);else{for(e=0;e<s;e++)null!=(i=t.readS())&&this.addStatus(i,t);t.readBool()&&this.addStatus(null,t)}if(t.readBool()&&(this._tweenConfig=new h,this._tweenConfig.easeType=t.readByte(),this._tweenConfig.duration=t.getFloat32(),this._tweenConfig.delay=t.getFloat32()),2<=t.version)if(this instanceof a.GearXY){if(t.readBool()){for(this.positionsInPercent=!0,e=0;e<s;e++)null!=(i=t.readS())&&this.addExtStatus(i,t);t.readBool()&&this.addExtStatus(null,t)}}else this instanceof a.GearDisplay2&&(this.condition=t.readByte())}updateFromRelations(t,e){}addStatus(t,e){}init(){}apply(){}updateState(){}};class h{constructor(){this.tween=!0,this.easeType=a.EaseType.QuadOut,this.duration=.3,this.delay=0}}a.GearTweenConfig=h}(fgui),function(e){class t extends e.GearBase{constructor(t){super(t)}init(){this._default={playing:this._owner.getProp(e.ObjectPropID.Playing),frame:this._owner.getProp(e.ObjectPropID.Frame)},this._storage={}}addStatus(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.playing=e.readBool(),i.frame=e.getInt32()}apply(){this._owner._gearLocked=!0;var t=(t=this._storage[this._controller.selectedPageId])||this._default;this._owner.setProp(e.ObjectPropID.Playing,t.playing),this._owner.setProp(e.ObjectPropID.Frame,t.frame),this._owner._gearLocked=!1}updateState(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.playing=this._owner.getProp(e.ObjectPropID.Playing),t.frame=this._owner.getProp(e.ObjectPropID.Frame)}}e.GearAnimation=t}(fgui),function(e){class t extends e.GearBase{constructor(t){super(t)}init(){this._default={color:this._owner.getProp(e.ObjectPropID.Color),strokeColor:this._owner.getProp(e.ObjectPropID.OutlineColor)},this._storage={}}addStatus(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.color=e.readColorS(),i.strokeColor=e.readColorS()}apply(){this._owner._gearLocked=!0;var t=(t=this._storage[this._controller.selectedPageId])||this._default;this._owner.setProp(e.ObjectPropID.Color,t.color),this._owner.setProp(e.ObjectPropID.OutlineColor,t.strokeColor),this._owner._gearLocked=!1}updateState(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.color=this._owner.getProp(e.ObjectPropID.Color),t.strokeColor=this._owner.getProp(e.ObjectPropID.OutlineColor),t.shadowColor=this._owner.getProp(e.ObjectPropID.ShadowColor)}}e.GearColor=t}(fgui),function(t){class e extends t.GearBase{constructor(t){super(t),this._displayLockToken=1,this._visible=0}init(){this.pages=null}apply(){this._displayLockToken++,0==this._displayLockToken&&(this._displayLockToken=1),null==this.pages||0==this.pages.length||-1!=this.pages.indexOf(this._controller.selectedPageId)?this._visible=1:this._visible=0}addLock(){return this._visible++,this._displayLockToken}releaseLock(t){t==this._displayLockToken&&this._visible--}get connected(){return null==this._controller||0<this._visible}}t.GearDisplay=e}(fgui),function(t){class e extends t.GearBase{constructor(t){super(t),this._visible=0}init(){this.pages=null}apply(){null==this.pages||0==this.pages.length||-1!=this.pages.indexOf(this._controller.selectedPageId)?this._visible=1:this._visible=0}evaluate(t){var e=null==this._controller||0<this._visible;return e=0==this.condition?e&&t:e||t}}t.GearDisplay2=e}(fgui),function(e){class t extends e.GearBase{constructor(t){super(t),this._default=0}init(){this._default=this._owner.getProp(e.ObjectPropID.FontSize),this._storage={}}addStatus(t,e){null==t?this._default=e.getInt32():this._storage[t]=e.getInt32()}apply(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];null!=t?this._owner.setProp(e.ObjectPropID.FontSize,t):this._owner.setProp(e.ObjectPropID.FontSize,this._default),this._owner._gearLocked=!1}updateState(){this._storage[this._controller.selectedPageId]=this._owner.getProp(e.ObjectPropID.FontSize)}}e.GearFontSize=t}(fgui),function(t){class e extends t.GearBase{constructor(t){super(t)}init(){this._default=this._owner.icon,this._storage={}}addStatus(t,e){null==t?this._default=e.readS():this._storage[t]=e.readS()}apply(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];this._owner.icon=void 0!==t?t:this._default,this._owner._gearLocked=!1}updateState(){this._storage[this._controller.selectedPageId]=this._owner.icon}}t.GearIcon=e}(fgui),function(s){class t extends s.GearBase{constructor(t){super(t)}init(){this._default={alpha:this._owner.alpha,rotation:this._owner.rotation,grayed:this._owner.grayed,touchable:this._owner.touchable},this._storage={}}addStatus(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.alpha=e.getFloat32(),i.rotation=e.getFloat32(),i.grayed=e.readBool(),i.touchable=e.readBool()}apply(){var t=(t=this._storage[this._controller.selectedPageId])||this._default;if(this._tweenConfig&&this._tweenConfig.tween&&!s.UIPackage._constructing&&!s.GearBase.disableAllTweenEffect){if(this._owner._gearLocked=!0,this._owner.grayed=t.grayed,this._owner.touchable=t.touchable,this._owner._gearLocked=!1,this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==t.alpha&&this._tweenConfig._tweener.endValue.y==t.rotation)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var e=t.alpha!=this._owner.alpha,i=t.rotation!=this._owner.rotation;(e||i)&&(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=s.GTween.to2(this._owner.alpha,this._owner.rotation,t.alpha,t.rotation,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setUserData((e?1:0)+(i?2:0)).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}else this._owner._gearLocked=!0,this._owner.grayed=t.grayed,this._owner.touchable=t.touchable,this._owner.alpha=t.alpha,this._owner.rotation=t.rotation,this._owner._gearLocked=!1}__tweenUpdate(t){var e=t.userData;this._owner._gearLocked=!0,0!=(1&e)&&(this._owner.alpha=t.value.x),0!=(2&e)&&(this._owner.rotation=t.value.y),this._owner._gearLocked=!1}__tweenComplete(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null}updateState(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.alpha=this._owner.alpha,t.rotation=this._owner.rotation,t.grayed=this._owner.grayed,t.touchable=this._owner.touchable}}s.GearLook=t}(fgui),function(s){class t extends s.GearBase{constructor(t){super(t)}init(){this._default={width:this._owner.width,height:this._owner.height,scaleX:this._owner.scaleX,scaleY:this._owner.scaleY},this._storage={}}addStatus(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.width=e.getInt32(),i.height=e.getInt32(),i.scaleX=e.getFloat32(),i.scaleY=e.getFloat32()}apply(){var t=(t=this._storage[this._controller.selectedPageId])||this._default;if(this._tweenConfig&&this._tweenConfig.tween&&!s.UIPackage._constructing&&!s.GearBase.disableAllTweenEffect){if(this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==t.width&&this._tweenConfig._tweener.endValue.y==t.height&&this._tweenConfig._tweener.endValue.z==t.scaleX&&this._tweenConfig._tweener.endValue.w==t.scaleY)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var e=t.width!=this._owner.width||t.height!=this._owner.height,i=t.scaleX!=this._owner.scaleX||t.scaleY!=this._owner.scaleY;(e||i)&&(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=s.GTween.to4(this._owner.width,this._owner.height,this._owner.scaleX,this._owner.scaleY,t.width,t.height,t.scaleX,t.scaleY,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setUserData((e?1:0)+(i?2:0)).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}else this._owner._gearLocked=!0,this._owner.setSize(t.width,t.height,this._owner.getGear(1).controller==this._controller),this._owner.setScale(t.scaleX,t.scaleY),this._owner._gearLocked=!1}__tweenUpdate(t){var e=t.userData;this._owner._gearLocked=!0,0!=(1&e)&&this._owner.setSize(t.value.x,t.value.y,this._owner.checkGearController(1,this._controller)),0!=(2&e)&&this._owner.setScale(t.value.z,t.value.w),this._owner._gearLocked=!1}__tweenComplete(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null}updateState(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.width=this._owner.width,t.height=this._owner.height,t.scaleX=this._owner.scaleX,t.scaleY=this._owner.scaleY}updateFromRelations(t,e){if(null!=this._controller&&null!=this._storage){for(var i in this._storage){i=this._storage[i];i.width+=t,i.height+=e}this._default.width+=t,this._default.height+=e,this.updateState()}}}s.GearSize=t}(fgui),function(t){class e extends t.GearBase{constructor(t){super(t)}init(){this._default=this._owner.text,this._storage={}}addStatus(t,e){null==t?this._default=e.readS():this._storage[t]=e.readS()}apply(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];this._owner.text=void 0!==t?t:this._default,this._owner._gearLocked=!1}updateState(){this._storage[this._controller.selectedPageId]=this._owner.text}}t.GearText=e}(fgui),function(a){class t extends a.GearBase{constructor(t){super(t)}init(){this._default={x:this._owner.x,y:this._owner.y,px:this._owner.x/this._owner.parent.width,py:this._owner.y/this._owner.parent.height},this._storage={}}addStatus(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.x=e.getInt32(),i.y=e.getInt32()}addExtStatus(t,e){t=null==t?this._default:this._storage[t];t.px=e.getFloat32(),t.py=e.getFloat32()}apply(){var t,e=(e=this._storage[this._controller.selectedPageId])||this._default,e=this.positionsInPercent&&this._owner.parent?(t=e.px*this._owner.parent.width,e.py*this._owner.parent.height):(t=e.x,e.y);if(this._tweenConfig&&this._tweenConfig.tween&&!a.UIPackage._constructing&&!a.GearBase.disableAllTweenEffect){if(this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==t&&this._tweenConfig._tweener.endValue.y==e)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var i=this._owner.x,s=this._owner.y;i==t&&s==e||(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=a.GTween.to2(i,s,t,e,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}else this._owner._gearLocked=!0,this._owner.setXY(t,e),this._owner._gearLocked=!1}__tweenUpdate(t){this._owner._gearLocked=!0,this._owner.setXY(t.value.x,t.value.y),this._owner._gearLocked=!1}__tweenComplete(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null}updateState(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.x=this._owner.x,t.y=this._owner.y,t.px=this._owner.x/this._owner.parent.width,t.py=this._owner.y/this._owner.parent.height}updateFromRelations(t,e){if(null!=this._controller&&null!=this._storage&&!this.positionsInPercent){for(var i in this._storage){i=this._storage[i];i.x+=t,i.y+=e}this._default.x+=t,this._default.y+=e,this.updateState()}}}a.GearXY=t}(fgui),function(u){u.GPath=class{constructor(){this._segments=new Array,this._points=new Array}get length(){return this._fullLength}create(t,e,i,s){Array.isArray(t)?a=t:((a=new Array).push(t),a.push(e),i&&a.push(i),s&&a.push(s)),this._segments.length=0,this._points.length=0,this._fullLength=0;var a,h=a.length;if(0!=h){var r=d,n=a[r.length=0];n.curveType==u.CurveType.CRSpline&&r.push(new Laya.Point(n.x,n.y));for(var o=1;o<h;o++){var l,_=a[o];n.curveType!=u.CurveType.CRSpline&&((l={}).type=n.curveType,l.ptStart=this._points.length,n.curveType==u.CurveType.Straight?(l.ptCount=2,this._points.push(new Laya.Point(n.x,n.y)),this._points.push(new Laya.Point(_.x,_.y))):n.curveType==u.CurveType.Bezier?(l.ptCount=3,this._points.push(new Laya.Point(n.x,n.y)),this._points.push(new Laya.Point(_.x,_.y)),this._points.push(new Laya.Point(n.control1_x,n.control1_y))):n.curveType==u.CurveType.CubicBezier&&(l.ptCount=4,this._points.push(new Laya.Point(n.x,n.y)),this._points.push(new Laya.Point(_.x,_.y)),this._points.push(new Laya.Point(n.control1_x,n.control1_y)),this._points.push(new Laya.Point(n.control2_x,n.control2_y))),l.length=u.ToolSet.distance(n.x,n.y,_.x,_.y),this._fullLength+=l.length,this._segments.push(l)),_.curveType!=u.CurveType.CRSpline?0<r.length&&(r.push(new Laya.Point(_.x,_.y)),this.createSplineSegment()):r.push(new Laya.Point(_.x,_.y)),n=_}1<r.length&&this.createSplineSegment()}}createSplineSegment(){var t=d,e=t.length,i=(t.splice(0,0,t[0]),t.push(t[e]),t.push(t[e]),e+=3,{});i.type=u.CurveType.CRSpline,i.ptStart=this._points.length,i.ptCount=e,this._points=this._points.concat(t),i.length=0;for(var s=1;s<e;s++)i.length+=u.ToolSet.distance(t[s-1].x,t[s-1].y,t[s].x,t[s].y);this._fullLength+=i.length,this._segments.push(i),t.length=0}clear(){this._segments.length=0,this._points.length=0}getPointAt(t,e){e?e.x=e.y=0:e=new Laya.Point,t=u.ToolSet.clamp01(t);var i,s=this._segments.length;if(0!=s){if(1==t)return(i=this._segments[s-1]).type==u.CurveType.Straight?(e.x=u.ToolSet.lerp(this._points[i.ptStart].x,this._points[i.ptStart+1].x,t),e.y=u.ToolSet.lerp(this._points[i.ptStart].y,this._points[i.ptStart+1].y,t),e):i.type==u.CurveType.Bezier||i.type==u.CurveType.CubicBezier?this.onBezierCurve(i.ptStart,i.ptCount,t,e):this.onCRSplineCurve(i.ptStart,i.ptCount,t,e);for(var a=t*this._fullLength,h=0;h<s;h++)if((a-=(i=this._segments[h]).length)<0){t=1+a/i.length,i.type==u.CurveType.Straight?(e.x=u.ToolSet.lerp(this._points[i.ptStart].x,this._points[i.ptStart+1].x,t),e.y=u.ToolSet.lerp(this._points[i.ptStart].y,this._points[i.ptStart+1].y,t)):e=i.type==u.CurveType.Bezier||i.type==u.CurveType.CubicBezier?this.onBezierCurve(i.ptStart,i.ptCount,t,e):this.onCRSplineCurve(i.ptStart,i.ptCount,t,e);break}}return e}get segmentCount(){return this._segments.length}getAnchorsInSegment(t,e){null==e&&(e=new Array);for(var i=this._segments[t],s=0;s<i.ptCount;s++)e.push(new Laya.Point(this._points[i.ptStart+s].x,this._points[i.ptStart+s].y));return e}getPointsInSegment(t,e,i,s,a,h){null==s&&(s=new Array),h&&!isNaN(h)||(h=.1),a&&a.push(e);var r=this._segments[t];if(r.type==u.CurveType.Straight)s.push(new Laya.Point(u.ToolSet.lerp(this._points[r.ptStart].x,this._points[r.ptStart+1].x,e),u.ToolSet.lerp(this._points[r.ptStart].y,this._points[r.ptStart+1].y,e))),s.push(new Laya.Point(u.ToolSet.lerp(this._points[r.ptStart].x,this._points[r.ptStart+1].x,i),u.ToolSet.lerp(this._points[r.ptStart].y,this._points[r.ptStart+1].y,i)));else{var n=r.type==u.CurveType.Bezier||r.type==u.CurveType.CubicBezier?this.onBezierCurve:this.onCRSplineCurve;s.push(n.call(this,r.ptStart,r.ptCount,e,new Laya.Point));for(var o=Math.min(r.length*h,50),l=0;l<=o;l++){var _=l/o;e<_&&_<i&&(s.push(n.call(this,r.ptStart,r.ptCount,_,new Laya.Point)),a)&&a.push(_)}s.push(n.call(this,r.ptStart,r.ptCount,i,new Laya.Point))}return a&&a.push(i),s}getAllPoints(t,e,i){null==t&&(t=new Array),i&&!isNaN(i)||(i=.1);for(var s=this._segments.length,a=0;a<s;a++)this.getPointsInSegment(a,0,1,t,e,i);return t}onCRSplineCurve(t,e,i,s){var t=Math.floor(i*(e-4))+t,a=this._points[t].x,h=this._points[t].y,r=this._points[t+1].x,n=this._points[t+1].y,o=this._points[t+2].x,l=this._points[t+2].y,_=this._points[t+3].x,t=this._points[t+3].y,i=1==i?1:u.ToolSet.repeat(i*(e-4),1),e=((2-i)*i-1)*i*.5,d=.5*((3*i-5)*i*i+2),c=((-3*i+4)*i+1)*i*.5,i=(i-1)*i*i*.5;return s.x=a*e+r*d+o*c+_*i,s.y=h*e+n*d+l*c+t*i,s}onBezierCurve(t,e,i,s){var a=1-i,h=this._points[t].x,r=this._points[t].y,n=this._points[t+1].x,o=this._points[t+1].y,l=this._points[t+2].x,_=this._points[t+2].y;return 4==e?(e=this._points[t+3].x,t=this._points[t+3].y,s.x=a*a*a*h+3*a*a*i*l+3*a*i*i*e+i*i*i*n,s.y=a*a*a*r+3*a*a*i*_+3*a*i*i*t+i*i*i*o):(s.x=a*a*h+2*a*i*l+i*i*n,s.y=a*a*r+2*a*i*_+i*i*o),s}};var d=new Array}(fgui),function(t){const o=new Laya.Point(0,0);class r{constructor(t=50){this._points=new Array,this._pointDensity=t}create(t){for(var e=this._points,i=r.helperPath,s=(i.create(t),this._pointDensity),a=0;a<=s;a++){var h=new Laya.Point;i.getPointAt(+a/s,h),e[a]=h}e[0].setTo(0,0),e[s].setTo(1,1),e.sort((t,e)=>t.x-e.x)}Evaluate(t){if(t<=0)return 0;if(1<=t)return 1;for(var e=this._points,i=this._pointDensity,s=0,a=i,h=0;s!=a;){var r=e[h=s+Math.round((a-s)/2)].x;if(t==r)break;if(r<t){if(s==h){h=a;break}s=h}else{if(a==h){h=s;break}a=h}}var n=e[h],i=h==i?o:e[h+1],i=(i.y-n.y)/(i.x-n.x);return isNaN(i)&&(i=0),n.y+(t-n.x)*i}}r.helperPath=new t.GPath,t.CustomEase=r}(fgui),function(o){const l=.5*Math.PI,_=2*Math.PI;function d(t,e){return 1-c(e-t,e)}function c(t,e){return(t/=e)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}o.evaluateEase=function(t,e,i,s,a,h){switch(t){case o.EaseType.Linear:return e/i;case o.EaseType.SineIn:return 1-Math.cos(e/i*l);case o.EaseType.SineOut:return Math.sin(e/i*l);case o.EaseType.SineInOut:return-.5*(Math.cos(Math.PI*e/i)-1);case o.EaseType.QuadIn:return(e/=i)*e;case o.EaseType.QuadOut:return-(e/=i)*(e-2);case o.EaseType.QuadInOut:return(e/=.5*i)<1?.5*e*e:-.5*(--e*(e-2)-1);case o.EaseType.CubicIn:return(e/=i)*e*e;case o.EaseType.CubicOut:return(e=e/i-1)*e*e+1;case o.EaseType.CubicInOut:return(e/=.5*i)<1?.5*e*e*e:.5*((e-=2)*e*e+2);case o.EaseType.QuartIn:return(e/=i)*e*e*e;case o.EaseType.QuartOut:return-((e=e/i-1)*e*e*e-1);case o.EaseType.QuartInOut:return(e/=.5*i)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2);case o.EaseType.QuintIn:return(e/=i)*e*e*e*e;case o.EaseType.QuintOut:return(e=e/i-1)*e*e*e*e+1;case o.EaseType.QuintInOut:return(e/=.5*i)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2);case o.EaseType.ExpoIn:return 0==e?0:Math.pow(2,10*(e/i-1));case o.EaseType.ExpoOut:return e==i?1:1-Math.pow(2,-10*e/i);case o.EaseType.ExpoInOut:return 0==e?0:e==i?1:(e/=.5*i)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e));case o.EaseType.CircIn:return-(Math.sqrt(1-(e/=i)*e)-1);case o.EaseType.CircOut:return Math.sqrt(1-(e=e/i-1)*e);case o.EaseType.CircInOut:return(e/=.5*i)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1);case o.EaseType.ElasticIn:return 0==e?0:1==(e/=i)?1:(0==a&&(a=.3*i),r=s<1?(s=1,a/4):a/_*Math.asin(1/s),-(s*Math.pow(2,10*--e)*Math.sin((e*i-r)*_/a)));case o.EaseType.ElasticOut:return 0==e?0:1==(e/=i)?1:(0==a&&(a=.3*i),r=s<1?(s=1,a/4):a/_*Math.asin(1/s),s*Math.pow(2,-10*e)*Math.sin((e*i-r)*_/a)+1);case o.EaseType.ElasticInOut:return 0==e?0:2==(e/=.5*i)?1:(0==a&&(a=i*(.3*1.5)),r=s<1?(s=1,a/4):a/_*Math.asin(1/s),e<1?s*Math.pow(2,10*--e)*Math.sin((e*i-r)*_/a)*-.5:s*Math.pow(2,-10*--e)*Math.sin((e*i-r)*_/a)*.5+1);case o.EaseType.BackIn:return(e/=i)*e*((s+1)*e-s);case o.EaseType.BackOut:return(e=e/i-1)*e*((s+1)*e+s)+1;case o.EaseType.BackInOut:return(e/=.5*i)<1?e*e*((1+(s*=1.525))*e-s)*.5:.5*((e-=2)*e*((1+(s*=1.525))*e+s)+2);case o.EaseType.BounceIn:return d(e,i);case o.EaseType.BounceOut:return c(e,i);case o.EaseType.BounceInOut:var r=e,n=i;return r<.5*n?.5*d(2*r,n):.5*c(2*r-n,n)+.5;case o.EaseType.Custom:return null!=h?h.Evaluate(e/i):e/i;default:return-(e/=i)*(e-2)}}}(fgui),function(t){class e{}e.Linear=0,e.SineIn=1,e.SineOut=2,e.SineInOut=3,e.QuadIn=4,e.QuadOut=5,e.QuadInOut=6,e.CubicIn=7,e.CubicOut=8,e.CubicInOut=9,e.QuartIn=10,e.QuartOut=11,e.QuartInOut=12,e.QuintIn=13,e.QuintOut=14,e.QuintInOut=15,e.ExpoIn=16,e.ExpoOut=17,e.ExpoInOut=18,e.CircIn=19,e.CircOut=20,e.CircInOut=21,e.ElasticIn=22,e.ElasticOut=23,e.ElasticInOut=24,e.BackIn=25,e.BackOut=26,e.BackInOut=27,e.BounceIn=28,e.BounceOut=29,e.BounceInOut=30,e.Custom=31,t.EaseType=e}(fgui),function(t){let n;var e;(e=n=t.CurveType||(t.CurveType={}))[e.CRSpline=0]="CRSpline",e[e.Bezier=1]="Bezier",e[e.CubicBezier=2]="CubicBezier",e[e.Straight=3]="Straight";t.GPathPoint=class o{constructor(){this.x=0,this.y=0,this.control1_x=0,this.control1_y=0,this.control2_x=0,this.control2_y=0,this.curveType=0}static newPoint(t=0,e=0,i=0){var s=new o;return s.x=t,s.y=e,s.control1_x=0,s.control1_y=0,s.control2_x=0,s.control2_y=0,s.curveType=i,s}static newBezierPoint(t=0,e=0,i=0,s=0){var a=new o;return a.x=t,a.y=e,a.control1_x=i,a.control1_y=s,a.control2_x=0,a.control2_y=0,a.curveType=n.Bezier,a}static newCubicBezierPoint(t=0,e=0,i=0,s=0,a=0,h=0){var r=new o;return r.x=t,r.y=e,r.control1_x=i,r.control1_y=s,r.control2_x=a,r.control2_y=h,r.curveType=n.CubicBezier,r}clone(){var t=new o;return t.x=this.x,t.y=this.y,t.control1_x=this.control1_x,t.control1_y=this.control1_y,t.control2_x=this.control2_x,t.control2_y=this.control2_y,t.curveType=this.curveType,t}}}(fgui),function(l){class t{static to(t,e,i){return l.TweenManager.createTween()._to(t,e,i)}static to2(t,e,i,s,a){return l.TweenManager.createTween()._to2(t,e,i,s,a)}static to3(t,e,i,s,a,h,r){return l.TweenManager.createTween()._to3(t,e,i,s,a,h,r)}static to4(t,e,i,s,a,h,r,n,o){return l.TweenManager.createTween()._to4(t,e,i,s,a,h,r,n,o)}static toColor(t,e,i){return l.TweenManager.createTween()._toColor(t,e,i)}static delayedCall(t){return l.TweenManager.createTween().setDelay(t)}static shake(t,e,i,s){return l.TweenManager.createTween()._shake(t,e,i,s)}static isTweening(t,e){return l.TweenManager.isTweening(t,e)}static kill(t,e,i){l.TweenManager.killTweens(t,e,i)}static getTween(t,e){return l.TweenManager.getTween(t,e)}}t.catchCallbackExceptions=!0,l.GTween=t}(fgui),function(r){r.GTweener=class{constructor(){this._startValue=new r.TweenValue,this._endValue=new r.TweenValue,this._value=new r.TweenValue,this._deltaValue=new r.TweenValue,this._reset()}setDelay(t){return this._delay=t,this}get delay(){return this._delay}setDuration(t){return this._duration=t,this}get duration(){return this._duration}setBreakpoint(t){return this._breakpoint=t,this}setEase(t,e){return this._easeType=t,this._customEase=e,this}setEasePeriod(t){return this._easePeriod=t,this}setEaseOvershootOrAmplitude(t){return this._easeOvershootOrAmplitude=t,this}setRepeat(t,e=!1){return this._repeat=t,this._yoyo=e,this}get repeat(){return this._repeat}setTimeScale(t){return this._timeScale=t,this}setSnapping(t){return this._snapping=t,this}setTarget(t,e){return this._target=t,this._propType=e,this}get target(){return this._target}setPath(t){return this._path=t,this}setUserData(t){return this._userData=t,this}get userData(){return this._userData}onUpdate(t,e){return this._onUpdate=t,this._onUpdateCaller=e,this}onStart(t,e){return this._onStart=t,this._onStartCaller=e,this}onComplete(t,e){return this._onComplete=t,this._onCompleteCaller=e,this}get startValue(){return this._startValue}get endValue(){return this._endValue}get value(){return this._value}get deltaValue(){return this._deltaValue}get normalizedTime(){return this._normalizedTime}get completed(){return 0!=this._ended}get allCompleted(){return 1==this._ended}setPaused(t){return this._paused=t,this}seek(t){if(!this._killed){if(this._elapsedTime=t,this._elapsedTime<this._delay){if(!this._started)return;this._elapsedTime=this._delay}this.update()}}kill(t){this._killed||(t&&(0==this._ended&&(0<=this._breakpoint?this._elapsedTime=this._delay+this._breakpoint:0<=this._repeat?this._elapsedTime=this._delay+this._duration*(this._repeat+1):this._elapsedTime=this._delay+2*this._duration,this.update()),this.callCompleteCallback()),this._killed=!0)}_to(t,e,i){return this._valueSize=1,this._startValue.x=t,this._endValue.x=e,this._value.x=t,this._duration=i,this}_to2(t,e,i,s,a){return this._valueSize=2,this._startValue.x=t,this._endValue.x=i,this._startValue.y=e,this._endValue.y=s,this._value.x=t,this._value.y=e,this._duration=a,this}_to3(t,e,i,s,a,h,r){return this._valueSize=3,this._startValue.x=t,this._endValue.x=s,this._startValue.y=e,this._endValue.y=a,this._startValue.z=i,this._endValue.z=h,this._value.x=t,this._value.y=e,this._value.z=i,this._duration=r,this}_to4(t,e,i,s,a,h,r,n,o){return this._valueSize=4,this._startValue.x=t,this._endValue.x=a,this._startValue.y=e,this._endValue.y=h,this._startValue.z=i,this._endValue.z=r,this._startValue.w=s,this._endValue.w=n,this._value.x=t,this._value.y=e,this._value.z=i,this._value.w=s,this._duration=o,this}_toColor(t,e,i){return this._valueSize=5,this._startValue.color=t,this._endValue.color=e,this._value.color=t,this._duration=i,this}_shake(t,e,i,s){return this._valueSize=6,this._startValue.x=t,this._startValue.y=e,this._startValue.w=i,this._duration=s,this}_init(){this._delay=0,this._duration=0,this._breakpoint=-1,this._easeType=r.EaseType.QuadOut,this._timeScale=1,this._easePeriod=0,this._easeOvershootOrAmplitude=1.70158,this._snapping=!1,this._repeat=0,this._yoyo=!1,this._valueSize=0,this._started=!1,this._paused=!1,this._killed=!1,this._elapsedTime=0,this._normalizedTime=0,this._ended=0,this._customEase=null}_reset(){this._target=null,this._propType=null,this._userData=null,this._path=null,this._onStart=this._onUpdate=this._onComplete=null,this._onStartCaller=this._onUpdateCaller=this._onCompleteCaller=null}_update(t){1!=this._timeScale&&(t*=this._timeScale),0==t||0==this._ended&&(this._elapsedTime+=t,this.update(),0==this._ended||this._killed)||(this.callCompleteCallback(),this._killed=!0)}update(){if((this._ended=0)==this._valueSize)this._elapsedTime>=this._delay+this._duration&&(this._ended=1);else{if(!this._started){if(this._elapsedTime<this._delay)return;if(this._started=!0,this.callStartCallback(),this._killed)return}var t=!1,e=this._elapsedTime-this._delay;if(0<=this._breakpoint&&e>=this._breakpoint&&(e=this._breakpoint,this._ended=2),0!=this._repeat?(i=Math.floor(e/this._duration),e-=this._duration*i,this._yoyo&&(t=i%2==1),0<this._repeat&&this._repeat-i<0&&(this._yoyo&&(t=this._repeat%2==1),e=this._duration,this._ended=1)):e>=this._duration&&(e=this._duration,this._ended=1),this._normalizedTime=r.evaluateEase(this._easeType,t?this._duration-e:e,this._duration,this._easeOvershootOrAmplitude,this._easePeriod,this._customEase),this._value.setZero(),this._deltaValue.setZero(),6==this._valueSize)0==this._ended?(t=(i=this._startValue.w*(1-this._normalizedTime))*(.5<Math.random()?1:-1),e=i*(.5<Math.random()?1:-1),this._deltaValue.x=t,this._deltaValue.y=e,this._value.x=this._startValue.x+t,this._value.y=this._startValue.y+e):(this._value.x=this._startValue.x,this._value.y=this._startValue.y);else if(this._path){var i=n;this._path.getPointAt(this._normalizedTime,i),this._snapping&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),this._deltaValue.x=i.x-this._value.x,this._deltaValue.y=i.y-this._value.y,this._value.x=i.x,this._value.y=i.y}else for(var s=Math.min(this._valueSize,4),a=0;a<s;a++){var h=this._startValue.getField(a),h=h+(this._endValue.getField(a)-h)*this._normalizedTime;this._snapping&&(h=Math.round(h)),this._deltaValue.setField(a,h-this._value.getField(a)),this._value.setField(a,h)}if(this._target&&this._propType)if(this._propType instanceof Function)switch(this._valueSize){case 1:this._propType.call(this._target,this._value.x);break;case 2:this._propType.call(this._target,this._value.x,this._value.y);break;case 3:this._propType.call(this._target,this._value.x,this._value.y,this._value.z);break;case 4:this._propType.call(this._target,this._value.x,this._value.y,this._value.z,this._value.w);break;case 5:this._propType.call(this._target,this._value.color);break;case 6:this._propType.call(this._target,this._value.x,this._value.y)}else 5==this._valueSize?this._target[this._propType]=this._value.color:this._target[this._propType]=this._value.x;this.callUpdateCallback()}}callStartCallback(){if(null!=this._onStart)try{this._onStart.call(this._onStartCaller,this)}catch(t){console.log("FairyGUI: error in start callback > "+t)}}callUpdateCallback(){if(null!=this._onUpdate)try{this._onUpdate.call(this._onUpdateCaller,this)}catch(t){console.log("FairyGUI: error in update callback > "+t)}}callCompleteCallback(){if(null!=this._onComplete)try{this._onComplete.call(this._onCompleteCaller,this)}catch(t){console.log("FairyGUI: error in complete callback > "+t)}}};var n=new Laya.Point}(fgui),function(r){r.TweenManager=class i{static createTween(){var t;return e||(Laya.timer.frameLoop(1,null,i.update),e=!0),(t=0<n.length?n.pop():new r.GTweener)._init(),o[l++]=t}static isTweening(t,e){if(null!=t)for(var i=!e,s=0;s<l;s++){var a=o[s];if(a&&a.target==t&&!a._killed&&(i||a._propType==e))return!0}return!1}static killTweens(t,e,i){if(null==t)return!1;for(var s=!1,a=l,h=!i,r=0;r<a;r++){var n=o[r];!n||n.target!=t||n._killed||!h&&n._propType!=i||(n.kill(e),s=!0)}return s}static getTween(t,e){if(null!=t)for(var i=l,s=!e,a=0;a<i;a++){var h=o[a];if(h&&h.target==t&&!h._killed&&(s||h._propType==e))return h}return null}static update(){for(var t=Laya.timer.delta/1e3,e=l,i=-1,s=0;s<e;s++){var a=o[s];null==a?-1==i&&(i=s):a._killed?(a._reset(),n.push(a),o[s]=null,-1==i&&(i=s)):(a._target instanceof r.GObject&&a._target.isDisposed?a._killed=!0:a._paused||a._update(t),-1!=i&&(o[i]=a,o[s]=null,i++))}if(0<=i){if(l!=e)for(var h=e,e=l-e,s=0;s<e;s++)o[i++]=o[h++];l=i}}};var o=[],n=[],l=0,e=!1}(fgui),function(t){t.TweenValue=class{constructor(){this.x=this.y=this.z=this.w=0}get color(){return(this.w<<24)+(this.x<<16)+(this.y<<8)+this.z}set color(t){this.x=(16711680&t)>>16,this.y=(65280&t)>>8,this.z=255&t,this.w=(4278190080&t)>>24}getField(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("Index out of bounds: "+t)}}setField(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("Index out of bounds: "+t)}}setZero(){this.x=this.y=this.z=this.w=0}}}(fgui),function(t){class i extends Laya.Byte{constructor(t,e,i){e=e||0,null!=i&&-1!=i||(i=t.byteLength-e),0==e&&i==t.byteLength?super(t):(super(),this._u8d_=new Uint8Array(t,e,i),this._d_=new DataView(this._u8d_.buffer,e,i),this._length=i),this.endian=Laya.Byte.BIG_ENDIAN}skip(t){this.pos+=t}readBool(){return 1==this.getUint8()}readS(){var t=this.getUint16();return 65534==t?null:65533==t?"":this.stringTable[t]}readSArray(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this.readS();return e}writeS(t){var e=this.getUint16();65534!=e&&65533!=e&&(this.stringTable[e]=t)}readColor(t){var e=this.getUint8(),i=this.getUint8(),s=this.getUint8(),a=this.getUint8();return(t?a<<24:0)+(e<<16)+(i<<8)+s}readColorS(t){var e=this.getUint8(),i=this.getUint8(),s=this.getUint8(),a=this.getUint8();return t&&255!=a?"rgba("+e+","+i+","+s+","+a/255+")":(t=e.toString(16),a=i.toString(16),e=s.toString(16),"#"+(t=1==t.length?"0"+t:t)+(a=1==a.length?"0"+a:a)+(e=1==e.length?"0"+e:e))}readChar(){var t=this.getUint16();return String.fromCharCode(t)}readBuffer(){var t=this.getUint32(),e=new i(this.buffer,this._pos_,t);return this.pos+=t,e.stringTable=this.stringTable,e.version=this.version,e}seek(t,e){var i=this._pos_;return this.pos=t,e<this.getUint8()&&0<(e=1==this.getUint8()?(this.pos+=2*e,this.getUint16()):(this.pos+=4*e,this.getUint32()))?(this.pos=t+e,!0):(this.pos=i,!1)}}t.ByteBuffer=i}(fgui),function(t){let s=Laya.HitArea._isHitGraphic;class e extends Laya.HitArea{constructor(t,e){super(),this._child=t,this._reversed=e,this._reversed?this.unHit=t.hitArea.hit:this.hit=t.hitArea.hit}contains(t,e){var i=Laya.Point.TEMP;return i.setTo(0,0),i=this._child.toParentPoint(i),this._reversed?!s(t-i.x,e-i.y,this.unHit):s(t-i.x,e-i.y,this.hit)}}t.ChildHitArea=e}(fgui),function(t){t.ColorMatrix=class i{constructor(t,e,i,s){this.matrix=new Array(a),this.reset(),void 0===t&&void 0===e&&void 0===i&&void 0===s||this.adjustColor(t,e,i,s)}reset(){for(var t=0;t<a;t++)this.matrix[t]=e[t]}invert(){this.multiplyMatrix([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0])}adjustColor(t,e,i,s){this.adjustHue(s||0),this.adjustContrast(e||0),this.adjustBrightness(t||0),this.adjustSaturation(i||0)}adjustBrightness(t){t=255*this.cleanValue(t,1),this.multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0])}adjustContrast(t){var e=128*(1-(t=this.cleanValue(t,1)+1));this.multiplyMatrix([t,0,0,0,e,0,t,0,0,e,0,0,t,0,e,0,0,0,1,0])}adjustSaturation(t){t=this.cleanValue(t,1);var e=(s=1-(t+=1))*h,i=s*r,s=s*n;this.multiplyMatrix([e+t,i,s,0,0,e,i+t,s,0,0,e,i,s+t,0,0,0,0,0,1,0])}adjustHue(t){t=this.cleanValue(t,1),t*=Math.PI;var e=Math.cos(t),t=Math.sin(t);this.multiplyMatrix([h+e*(1-h)+t*-h,r+e*-r+t*-r,n+e*-n+t*(1-n),0,0,h+e*-h+.143*t,r+e*(1-r)+.14*t,n+e*-n+-.283*t,0,0,h+e*-h+t*-(1-h),r+e*-r+t*r,n+e*(1-n)+t*n,0,0,0,0,0,1,0])}concat(t){t.length==a&&this.multiplyMatrix(t)}clone(){var t=new i;return t.copyMatrix(this.matrix),t}copyMatrix(t){for(var e=a,i=0;i<e;i++)this.matrix[i]=t[i]}multiplyMatrix(t){for(var e=[],i=0,s=0;s<4;++s){for(var a=0;a<5;++a)e[i+a]=t[i]*this.matrix[a]+t[i+1]*this.matrix[a+5]+t[i+2]*this.matrix[a+10]+t[i+3]*this.matrix[a+15]+(4==a?t[i+4]:0);i+=5}this.copyMatrix(e)}cleanValue(t,e){return Math.min(e,Math.max(-e,t))}};const e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],a=e.length,h=.299,r=.587,n=.114}(fgui),function(t){class e extends Laya.HitArea{constructor(t,e,i){super(),this._data=t,this.offsetX=e,this.offsetY=i,this.scaleX=1,this.scaleY=1}contains(t,e){return t=Math.floor((t/this.scaleX-this.offsetX)*this._data.scale),e=Math.floor((e/this.scaleY-this.offsetY)*this._data.scale),!(t<0||e<0||t>=this._data.pixelWidth)&&(e=e*this._data.pixelWidth+t,0<=(t=Math.floor(e/8)))&&t<this._data.pixels.length&&1==(this._data.pixels[t]>>e%8&1)}}t.PixelHitTest=e;t.PixelHitTestData=class{constructor(){}load(t){t.getInt32(),this.pixelWidth=t.getInt32(),this.scale=1/t.readByte();var e=t.getInt32();this.pixels=[];for(var i=0;i<e;i++){var s=t.readByte();s<0&&(s+=256),this.pixels[i]=s}}}}(fgui),function(t){class e{constructor(){this._readPos=0,this.defaultImgWidth=0,this.defaultImgHeight=0,this._handlers={},this._handlers.url=this.onTag_URL,this._handlers.img=this.onTag_IMG,this._handlers.b=this.onTag_B,this._handlers.i=this.onTag_I,this._handlers.u=this.onTag_U,this._handlers.sup=this.onTag_Simple,this._handlers.sub=this.onTag_Simple,this._handlers.color=this.onTag_COLOR,this._handlers.font=this.onTag_FONT,this._handlers.size=this.onTag_SIZE}onTag_URL(t,e,i){return e?"</a>":null!=i?'<a href="'+i+'" target="_blank">':'<a href="'+this.getTagText()+'" target="_blank">'}onTag_IMG(t,e,i){return!e&&(e=this.getTagText(!0))?this.defaultImgWidth?'<img src="'+e+'" width="'+this.defaultImgWidth+'" height="'+this.defaultImgHeight+'"/>':'<img src="'+e+'"/>':null}onTag_B(t,e,i){return e?"</span>":"<span style='font-weight:bold'>"}onTag_I(t,e,i){return e?"</span>":"<span style='font-style:italic'>"}onTag_U(t,e,i){return e?"</span>":"<span style='text-decoration:underline'>"}onTag_Simple(t,e,i){return e?"</"+t+">":"<"+t+">"}onTag_COLOR(t,e,i){return e?"</span>":'<span style="color:'+(this.lastColor=i)+'">'}onTag_FONT(t,e,i){return e?"</span>":'<span style="font-family:'+i+'">'}onTag_SIZE(t,e,i){return e?"</span>":'<span style="font-size:'+(this.lastSize=i)+'">'}getTagText(t){for(var e,i=this._readPos,s="";-1!=(e=this._text.indexOf("[",i));){if(92!=this._text.charCodeAt(e-1)){s+=this._text.substring(i,e);break}s=s+this._text.substring(i,e-1)+"[",i=e+1}return-1==e?null:(t&&(this._readPos=e),s)}parse(t,e){this._text=t,this.lastColor=null,this.lastSize=null;for(var i,s,a,h,r=0,n="";-1!=(a=this._text.indexOf("[",r));)if(0<a&&92==this._text.charCodeAt(a-1))n=n+this._text.substring(r,a-1)+"[",r=a+1;else{if(n+=this._text.substring(r,a),-1==(a=this._text.indexOf("]",r=a)))break;i="/"==this._text.charAt(r+1),s=this._text.substring(i?r+2:r+1,a),this._readPos=a+1,a=null,-1!=(h=s.indexOf("="))&&(a=s.substring(h+1),s=s.substring(0,h)),s=s.toLowerCase(),null!=(h=this._handlers[s])?e||null!=(h=h.call(this,s,i,a))&&(n+=h):n+=this._text.substring(r,this._readPos),r=this._readPos}return r<this._text.length&&(n+=this._text.substr(r)),this._text=null,n}}e.inst=new e,t.UBBParser=e}(fgui),function(h){h.ToolSet=class{static startsWith(t,e,i){return!(!t||t.length<e.length||(t=t.substring(0,e.length),i?t.toLowerCase()!=e.toLowerCase():t!=e))}static endsWith(t,e,i){return!(!t||t.length<e.length||(t=t.substring(t.length-e.length),i?t.toLowerCase()!=e.toLowerCase():t!=e))}static trimRight(t){for(var e,i=t.length-1;0<=i&&(" "==(e=t.charAt(i))||"\n"==e||"\r"==e);i--);return t.substring(0,i+1)}static convertToHtmlColor(t,e){var e=e?(t>>24&255).toString(16):"",i=(t>>16&255).toString(16),s=(t>>8&255).toString(16),t=(255&t).toString(16);return"#"+(e=1==e.length?"0"+e:e)+(i=1==i.length?"0"+i:i)+(s=1==s.length?"0"+s:s)+(t=1==t.length?"0"+t:t)}static convertFromHtmlColor(t,e){return t.length<1?0:8==(t="#"==t.charAt(0)?t.substr(1):t).length?(parseInt(t.substr(0,2),16)<<24)+parseInt(t.substr(2),16):e?4278190080+parseInt(t,16):parseInt(t,16)}static displayObjectToGObject(t){for(;t&&!(t instanceof Laya.Stage);){if(t.$owner)return t.$owner;t=t.parent}return null}static encodeHTML(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"):""}static clamp(t,e,i){return t<e?t=e:i<t&&(t=i),t}static clamp01(t){return isNaN(t)?t=0:1<t?t=1:t<0&&(t=0),t}static lerp(t,e,i){return t+i*(e-t)}static repeat(t,e){return t-Math.floor(t/e)*e}static distance(t,e,i,s){return Math.sqrt(Math.pow(t-i,2)+Math.pow(e-s,2))}static setColorFilter(t,e){var i,s=t.$_colorFilter_,a=t.filters,h=typeof e;h="boolean"==h?(i=s?s.$_color_:null,e):(i=e="string"==h?1==(h=Laya.ColorUtils.create(e).arrColor)[0]&&1==h[1]&&1==h[2]?null:[h[0],0,0,0,0,0,h[1],0,0,0,0,0,h[2],0,0,0,0,0,1,0]:e,!!s&&s.$_grayed_),i||0==i||h?(s||(s=new Laya.ColorFilter,t.$_colorFilter_=s),a?-1==a.indexOf(s)&&a.push(s):a=[s],t.filters=a,s.$_color_=i,s.$_grayed_=h,s.reset(),h?s.gray():20==i.length?s.setByMatrix(i):s.setByMatrix(n(i[0],i[1],i[2],i[3]))):a&&s&&-1!=(e=a.indexOf(s))&&(a.splice(e,1),0<a.length?t.filters=a:t.filters=null)}};let r=new h.ColorMatrix;function n(t,e,i,s,a){return a=a||new Array(h.ColorMatrix.length),r.reset(),r.adjustColor(t,e,i,s),r.matrix.forEach((t,e)=>a[e]=t),a}}(fgui); 
 			